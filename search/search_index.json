{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to AWorld\u2019s Documentation!","text":""},{"location":"#guides","title":"Guides","text":"<p>Overview</p> <p>Quick Start</p> <p>Core Capabilities</p> <p>Parallel Tasks</p> <p>Streaming Response</p> <p>Human in the Loop (HITL)</p>"},{"location":"#agents","title":"Agents","text":"<p>Build Agent</p> <p>Multi-Agent System(MAS)</p> <p>Workflow</p> <p>Custom Agent</p> <p>Context</p> <p>Runtime</p> <p>Memory</p> <p>Trace</p>"},{"location":"#environment","title":"Environment","text":"<p>Overview</p> <p>Using API</p> <p>Env Client</p> <p>Advanced Capabilities</p>"},{"location":"#training","title":"Training","text":"<p>Trainer</p> <p>Trajectory</p> <p>Evaluation</p>"},{"location":"#deployment","title":"Deployment","text":"<p>Oceanbase</p>"},{"location":"DESIGN_SYSTEM/","title":"AWorld Documentation Design System","text":""},{"location":"DESIGN_SYSTEM/#overview","title":"Overview","text":"<p>This design system is inspired by modern documentation sites like Letta, providing a clean, professional, and user-friendly experience for AWorld documentation.</p>"},{"location":"DESIGN_SYSTEM/#design-principles","title":"Design Principles","text":""},{"location":"DESIGN_SYSTEM/#1-clarity-first","title":"1. Clarity First","text":"<ul> <li>Clear hierarchy with well-defined heading levels</li> <li>Generous whitespace for better readability</li> <li>Consistent spacing throughout</li> </ul>"},{"location":"DESIGN_SYSTEM/#2-modern-professional","title":"2. Modern &amp; Professional","text":"<ul> <li>Contemporary color palette with blue and purple accents</li> <li>Smooth animations and transitions</li> <li>Glassmorphism effects for depth</li> </ul>"},{"location":"DESIGN_SYSTEM/#3-accessibility","title":"3. Accessibility","text":"<ul> <li>High contrast ratios for text</li> <li>Focus states for keyboard navigation</li> <li>Semantic HTML structure</li> </ul>"},{"location":"DESIGN_SYSTEM/#4-responsive","title":"4. Responsive","text":"<ul> <li>Mobile-first approach</li> <li>Adaptive layouts for all screen sizes</li> <li>Touch-friendly interactive elements</li> </ul>"},{"location":"DESIGN_SYSTEM/#color-palette","title":"Color Palette","text":""},{"location":"DESIGN_SYSTEM/#primary-colors","title":"Primary Colors","text":"<ul> <li>Primary Blue: <code>#3b82f6</code> - Main brand color, used for links and primary actions</li> <li>Accent Purple: <code>#8b5cf6</code> - Secondary accent for highlights</li> <li>Success Green: <code>#10b981</code> - Success states and positive actions</li> <li>Warning Amber: <code>#f59e0b</code> - Warnings and cautions</li> <li>Error Red: <code>#ef4444</code> - Errors and critical alerts</li> </ul>"},{"location":"DESIGN_SYSTEM/#neutral-colors","title":"Neutral Colors","text":"<ul> <li>Text Primary: <code>#0f172a</code> - Main body text</li> <li>Text Secondary: <code>#475569</code> - Secondary text</li> <li>Text Tertiary: <code>#64748b</code> - Less important text</li> <li>Border: <code>#cbd5e1</code> - Default borders</li> <li>Surface: <code>#f1f5f9</code> - Card backgrounds</li> </ul>"},{"location":"DESIGN_SYSTEM/#typography","title":"Typography","text":""},{"location":"DESIGN_SYSTEM/#font-families","title":"Font Families","text":"<ul> <li>Body: Inter - Modern, highly legible sans-serif</li> <li>Code: JetBrains Mono - Professional monospace font</li> </ul>"},{"location":"DESIGN_SYSTEM/#heading-scale","title":"Heading Scale","text":"<ul> <li>H1: 2.5rem (40px) - Page titles with gradient effect</li> <li>H2: 1.875rem (30px) - Major sections with border bottom</li> <li>H3: 1.5rem (24px) - Subsections</li> <li>H4: 1.25rem (20px) - Minor sections</li> </ul>"},{"location":"DESIGN_SYSTEM/#body-text","title":"Body Text","text":"<ul> <li>Size: 1rem (16px)</li> <li>Line Height: 1.7</li> <li>Color: Secondary text color for reduced eye strain</li> </ul>"},{"location":"DESIGN_SYSTEM/#components","title":"Components","text":""},{"location":"DESIGN_SYSTEM/#navigation","title":"Navigation","text":"<ul> <li>Left Sidebar: Primary navigation with hierarchical structure</li> <li>Right Sidebar: Table of contents for current page</li> <li>Top Bar: Site-wide navigation with glassmorphism effect</li> <li>Active States: Clear visual feedback with gradient backgrounds</li> </ul>"},{"location":"DESIGN_SYSTEM/#content-blocks","title":"Content Blocks","text":""},{"location":"DESIGN_SYSTEM/#code-blocks","title":"Code Blocks","text":"<ul> <li>Rounded corners with subtle shadows</li> <li>Syntax-specific inline code colors</li> <li>Copy button on hover</li> <li>Responsive overflow handling</li> </ul>"},{"location":"DESIGN_SYSTEM/#admonitions","title":"Admonitions","text":"<ul> <li>Four types: Note, Warning, Danger, Tip, Info</li> <li>Color-coded left borders</li> <li>Icon support for visual identification</li> <li>Collapsible for detailed information</li> </ul>"},{"location":"DESIGN_SYSTEM/#tables","title":"Tables","text":"<ul> <li>Gradient header with primary colors</li> <li>Alternating row hover effects</li> <li>Rounded corners with border</li> <li>Responsive scrolling on mobile</li> </ul>"},{"location":"DESIGN_SYSTEM/#images","title":"Images","text":"<ul> <li>Rounded corners with borders</li> <li>Drop shadows for depth</li> <li>Hover zoom effect</li> <li>Caption support</li> </ul>"},{"location":"DESIGN_SYSTEM/#interactive-elements","title":"Interactive Elements","text":""},{"location":"DESIGN_SYSTEM/#buttons","title":"Buttons","text":"<ul> <li>Primary: Gradient background with shadow</li> <li>Secondary: Outlined with border</li> <li>States: Hover lifts with increased shadow</li> <li>Size: Comfortable padding for touch</li> </ul>"},{"location":"DESIGN_SYSTEM/#links","title":"Links","text":"<ul> <li>Primary color with underline on hover</li> <li>Smooth color transitions</li> <li>Focus states for accessibility</li> </ul>"},{"location":"DESIGN_SYSTEM/#custom-utilities","title":"Custom Utilities","text":""},{"location":"DESIGN_SYSTEM/#hero-section-aw-hero","title":"Hero Section (<code>.aw-hero</code>)","text":"<p>Perfect for landing pages or major feature introductions.</p> <pre><code>&lt;div class=\"aw-hero\"&gt;\n  &lt;h1&gt;Welcome to AWorld&lt;/h1&gt;\n  &lt;p&gt;Build intelligent agents with ease&lt;/p&gt;\n  &lt;a class=\"md-button md-button--primary\"&gt;Get Started&lt;/a&gt;\n&lt;/div&gt;\n</code></pre>"},{"location":"DESIGN_SYSTEM/#feature-grid-aw-feature-grid","title":"Feature Grid (<code>.aw-feature-grid</code>)","text":"<p>Responsive grid for showcasing features.</p> <pre><code>&lt;div class=\"aw-feature-grid\"&gt;\n  &lt;div class=\"aw-feature-card\"&gt;\n    &lt;h3&gt;\ud83e\udd16 Build Agents&lt;/h3&gt;\n    &lt;p&gt;Create intelligent agents declaratively&lt;/p&gt;\n  &lt;/div&gt;\n  &lt;!-- More cards... --&gt;\n&lt;/div&gt;\n</code></pre>"},{"location":"DESIGN_SYSTEM/#badgechip-aw-chip-aw-badge","title":"Badge/Chip (<code>.aw-chip</code>, <code>.aw-badge</code>)","text":"<p>Inline labels for tags, versions, or status.</p> <pre><code>&lt;span class=\"aw-chip\"&gt;New Feature&lt;/span&gt;\n&lt;span class=\"aw-badge\"&gt;v1.0.0&lt;/span&gt;\n</code></pre>"},{"location":"DESIGN_SYSTEM/#spacing-system","title":"Spacing System","text":"<p>Consistent spacing using CSS variables: - XS: 0.25rem (4px) - SM: 0.5rem (8px) - MD: 1rem (16px) - LG: 1.5rem (24px) - XL: 2rem (32px)</p>"},{"location":"DESIGN_SYSTEM/#border-radius","title":"Border Radius","text":"<p>Soft, modern corners: - SM: 0.375rem - Small elements - Default: 0.5rem - Buttons, badges - MD: 0.75rem - Cards, inputs - LG: 1rem - Large cards - XL: 1.5rem - Hero sections</p>"},{"location":"DESIGN_SYSTEM/#shadows","title":"Shadows","text":"<p>Layered depth system: - SM: Subtle - For hover states - Default: Normal - For cards - MD: Medium - For elevated elements - LG: Large - For modals, popovers - XL: Extra Large - For major overlays</p>"},{"location":"DESIGN_SYSTEM/#dark-mode-support","title":"Dark Mode Support","text":"<p>Full dark mode implementation with: - Adjusted color palette for dark backgrounds - Reduced shadow intensity - Maintained contrast ratios - Smooth theme transitions</p> <p>Toggle between themes using the theme switcher in the header.</p>"},{"location":"DESIGN_SYSTEM/#responsive-breakpoints","title":"Responsive Breakpoints","text":"<ul> <li>Mobile: &lt; 60em (960px)</li> <li>Tablet: 60em - 76.1875em (960px - 1219px)</li> <li>Desktop: &gt; 76.1875em (1219px)</li> </ul>"},{"location":"DESIGN_SYSTEM/#accessibility-features","title":"Accessibility Features","text":"<ol> <li>Keyboard Navigation: Full keyboard support with visible focus states</li> <li>Screen Readers: Semantic HTML and ARIA labels</li> <li>Color Contrast: WCAG AA compliant</li> <li>Skip Links: Quick navigation to main content</li> <li>Print Styles: Optimized for printing documentation</li> </ol>"},{"location":"DESIGN_SYSTEM/#best-practices","title":"Best Practices","text":""},{"location":"DESIGN_SYSTEM/#content-writing","title":"Content Writing","text":"<ul> <li>Use clear, concise headings</li> <li>Break content into scannable sections</li> <li>Include code examples with proper syntax highlighting</li> <li>Add admonitions for important notes</li> </ul>"},{"location":"DESIGN_SYSTEM/#code-examples","title":"Code Examples","text":"<ul> <li>Always specify the language for syntax highlighting</li> <li>Keep examples short and focused</li> <li>Include comments for complex logic</li> <li>Test all code snippets</li> </ul>"},{"location":"DESIGN_SYSTEM/#images_1","title":"Images","text":"<ul> <li>Use descriptive alt text</li> <li>Optimize image sizes for web</li> <li>Include captions when necessary</li> <li>Maintain consistent aspect ratios</li> </ul>"},{"location":"DESIGN_SYSTEM/#migration-guide","title":"Migration Guide","text":"<p>To apply this design system to existing documentation:</p> <ol> <li>Ensure CSS file is linked in your documentation config</li> <li>Review heading hierarchy (only one H1 per page)</li> <li>Convert custom callouts to admonitions</li> <li>Update code blocks with language specifications</li> <li>Add appropriate classes to custom components</li> <li>Test in both light and dark modes</li> </ol>"},{"location":"DESIGN_SYSTEM/#further-customization","title":"Further Customization","text":"<p>All design tokens are defined as CSS variables in <code>:root</code>, making it easy to customize:</p> <pre><code>:root {\n  --aw-primary: #3b82f6;  /* Change primary color */\n  --aw-accent: #8b5cf6;   /* Change accent color */\n  /* ... more variables */\n}\n</code></pre> <p>Last Updated: 2026-01-12 Version: 2.0.0 Design Inspired By: Letta Documentation</p>"},{"location":"Agents/Build%20Agent/","title":"Building and Running Agents","text":"<p>Using the most common llm_agent as an example, this tutorial provides detailed guidance on:</p> <ol> <li>How to quickly build an Agent</li> <li>How to customize an Agent This document is divided into two parts to explain AWorld's design philosophy.</li> </ol>"},{"location":"Agents/Build%20Agent/#quick-agent-setup","title":"Quick Agent Setup","text":""},{"location":"Agents/Build%20Agent/#declaring-an-agent","title":"Declaring an Agent","text":"<pre><code>from aworld.agents.llm_agent import Agent\n\n# Assign a name to your agent\nagent = Agent(name=\"my_agent\")\n</code></pre>"},{"location":"Agents/Build%20Agent/#configuring-llm","title":"Configuring LLM","text":""},{"location":"Agents/Build%20Agent/#method-1-using-environment-variables","title":"Method 1: Using Environment Variables","text":"<pre><code>import os\n\n## Set up LLM service using environment variables\nos.environ[\"LLM_PROVIDER\"] = \"openai\"  # Choose from: openai, anthropic, azure_openai\nos.environ[\"LLM_MODEL_NAME\"] = \"gpt-4\"\nos.environ[\"LLM_API_KEY\"] = \"your-api-key\"\nos.environ[\"LLM_BASE_URL\"] = \"https://api.openai.com/v1\"  # Optional for OpenAI\n</code></pre>"},{"location":"Agents/Build%20Agent/#method-2-using-agentconfig","title":"Method 2: Using AgentConfig","text":"<pre><code>import os\nfrom aworld.agents.llm_agent import Agent\nfrom aworld.config.conf import AgentConfig\n\nagent_config = AgentConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\nagent = Agent(name=\"my_agent\", conf=agent_config)\n</code></pre>"},{"location":"Agents/Build%20Agent/#method-3-using-shared-modelconfig","title":"Method 3: Using Shared ModelConfig","text":"<p>When multiple agents use the same LLM service, you can specify a shared ModelConfig:</p> <pre><code>import os\nfrom aworld.agents.llm_agent import Agent\nfrom aworld.config.conf import AgentConfig, ModelConfig\n\n# Create a shared model configuration\nmodel_config = ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\n# Use the shared model config in agent configuration\nagent_config = AgentConfig(\n    llm_config=model_config,\n)\n\nagent = Agent(name=\"my_agent\", conf=agent_config)\n</code></pre>"},{"location":"Agents/Build%20Agent/#configuring-prompts","title":"Configuring Prompts","text":"<pre><code>from aworld.agents.llm_agent import Agent\nimport os\nfrom aworld.config.conf import AgentConfig, ModelConfig\n\nmodel_config = ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\nagent_config = AgentConfig(\n    llm_config=model_config,\n)\n\n# Define your system prompt\nsystem_prompt = \"\"\"You are a helpful AI assistant that can assist users with various tasks.\nYou should be polite, accurate, and provide clear explanations.\"\"\"\n\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    system_prompt=system_prompt\n)\n</code></pre>"},{"location":"Agents/Build%20Agent/#configuring-tools","title":"Configuring Tools","text":""},{"location":"Agents/Build%20Agent/#local-tools","title":"Local Tools","text":"<pre><code>from aworld.agents.llm_agent import Agent\nimport os\nfrom aworld.config.conf import AgentConfig, ModelConfig\nfrom aworld.core.tool.func_to_tool import be_tool\n\nmodel_config = ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\nagent_config = AgentConfig(\n    llm_config=model_config,\n)\n\nsystem_prompt = \"\"\"You are a helpful agent with access to various tools.\"\"\"\n\n\n# Define a local tool using the @be_tool decorator\n\n@be_tool(tool_name='greeting_tool', tool_desc=\"A simple greeting tool that returns a hello message\")\ndef greeting_tool() -&gt; str:\n    return \"Hello, world!\"\n\n\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    system_prompt=system_prompt,\n    tool_names=['greeting_tool']\n)\n</code></pre>"},{"location":"Agents/Build%20Agent/#mcp-model-context-protocol-tools","title":"MCP (Model Context Protocol) Tools","text":"<pre><code>from aworld.agents.llm_agent import Agent\nimport os\nfrom aworld.config.conf import AgentConfig, ModelConfig\n\nmodel_config = ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\nagent_config = AgentConfig(\n    llm_config=model_config,\n)\n\nsystem_prompt = \"\"\"You are a helpful agent with access to file system operations.\"\"\"\n\n# Configure MCP servers\n\nmcp_config = {\n    \"mcpServers\": {\n        \"GorillaFileSystem\": {\n            \"type\": \"stdio\",\n            \"command\": \"python\",\n            \"args\": [\"examples/BFCL/mcp_tools/gorilla_file_system.py\"],\n        },\n    }\n}\n\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    system_prompt=system_prompt,\n    mcp_servers=list(mcp_config.get(\"mcpServers\", {}).keys()),\n    mcp_config=mcp_config\n)\n</code></pre>"},{"location":"Agents/Build%20Agent/#agent-as-tool","title":"Agent as Tool","text":"<pre><code>from aworld.agents.llm_agent import Agent\nimport os\nfrom aworld.config.conf import AgentConfig, ModelConfig\n\nmodel_config = ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\nagent_config = AgentConfig(\n    llm_config=model_config,\n)\n\nsystem_prompt = \"\"\"You are a helpful agent that can delegate tasks to other specialized agents.\"\"\"\n\n# Create a specialized tool agent\ntool_agent = Agent(name=\"tool_agent\", conf=agent_config)\n\n# Create the main agent that can use the tool agent\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    system_prompt=system_prompt,\n    agent_names=['tool_agent']\n)\n</code></pre>"},{"location":"Agents/Build%20Multi-Agent%20System%28MAS%29/","title":"Multi-Agent System(MAS)","text":"<p>In the AWorld framework, similar to Workflow Construction, the fundamental building block for MAS is the Agent. By introducing the Swarm concept, users can easily, quickly, and efficiently build complex Multi-Agent Systems. In summary:</p> <ol> <li>Workflow in AWorld: Static, pre-defined execution flows</li> <li>MAS in AWorld: Dynamic, real-time decision-making execution flows</li> </ol> <p>This design ensures unified underlying capabilities (i.e., Agent, Graph-based Topology) while maintaining extensibility.</p>"},{"location":"Agents/Build%20Multi-Agent%20System%28MAS%29/#why-use-aworld-to-build-mas","title":"Why use AWorld to build MAS","text":"<ul> <li>Convenient. Build a multi-agent system in one row in the form of a graph.</li> <li>Efficient. Independent agents and tools automatically execute in parallel.</li> <li>Flexible. Not only can the strategy be adjusted at any time, but different types of swarms can also be combined arbitrarily.</li> <li>General. Provide general Workflow and Handoff mechanisms to support various collaboration paradigms.</li> <li>Good scalability. It can be achieved by defining its own Swarm type or setting it through <code>build_cls</code>.</li> </ul>"},{"location":"Agents/Build%20Multi-Agent%20System%28MAS%29/#mas-construction","title":"MAS Construction","text":"<p>Similar to Workflows, we can easily define communication networks between Agents through topology. The key difference is that by using <code>build_type=GraphBuildType.HANDOFF</code>, we allow dynamic decision-making for inter-agent calling relationships:</p> <ol> <li><code>agent1</code> can selectively decide to call <code>agent2</code> and <code>agent3</code>; the number of calls is also dynamic (once or multiple times)</li> <li><code>agent2</code> can selectively decide to call <code>agent3</code>; the number of calls is also dynamic (once or multiple times)</li> </ol> <pre><code>from aworld.config.conf import AgentConfig\nfrom aworld.agents.llm_agent import Agent\nfrom aworld.core.agent.swarm import Swarm\nfrom aworld.core.agent.graph_build_type import GraphBuildType\nfrom aworld.runner import Runners\n\n# Configure agents\nagent_conf = AgentConfig(...)\nagent1 = Agent(name=\"agent1\", conf=agent_conf)\nagent2 = Agent(name=\"agent2\", conf=agent_conf)\nagent3 = Agent(name=\"agent3\", conf=agent_conf)\n\n# Create swarm with dynamic handoff topology\nswarm = Swarm(\n    topology=[(agent1, agent2), (agent2, agent3), (agent1, agent3)], \n    build_type=GraphBuildType.HANDOFF\n)\n\n# Run the swarm\nRunners.run(input=\"your question\", swarm=swarm)\n</code></pre>"},{"location":"Agents/Build%20Multi-Agent%20System%28MAS%29/#specifying-entry-agent","title":"Specifying Entry Agent","text":"<p>Since MAS is essentially a Graph by definition, different Agents can accept external input. We can specify which Agent receives the query using the <code>root_agent</code> parameter.</p> <pre><code>swarm = Swarm(\n    topology=[(agent1, agent2), (agent2, agent3), (agent1, agent3)], \n    build_type=GraphBuildType.HANDOFF, \n    root_agent=[agent1]\n)\n</code></pre>"},{"location":"Agents/Build%20Multi-Agent%20System%28MAS%29/#dynamic-routing","title":"Dynamic Routing","text":"<p>When the <code>policy()</code> function decides which agent to call next, for special cases, Agents may need customized routing based on specific business rules. You can override the handler in the corresponding Agent:</p> <pre><code># Handler name consistency must be maintained\nagent = Agent(..., event_handler_name=\"your_handler_name\")\n</code></pre> <pre><code>from aworld.core.handler import HandlerFactory, DefaultHandler\nfrom aworld.core.message import Message\nfrom typing import AsyncGenerator\n\n@HandlerFactory.register(name=\"your_handler_name\")\nclass YourHandler(DefaultHandler):\n    def is_valid_message(self, message: Message) -&gt; bool:\n        return message.category == \"your_handler_name\"\n\n    async def _do_handle(self, message: Message) -&gt; AsyncGenerator[Message, None]:\n        if not self.is_valid_message(message):\n            return\n\n        # The type of data is generally ActionModel, but can be customized\n        data = message.payload\n        if \"clause1\" in data:\n            # Handle clause1 logic\n            pass\n        elif \"clause2\" in data:\n            # Handle clause2 logic\n            pass\n</code></pre> <p>You can refer to the implementation of <code>DefaultTaskHandler</code> in AWorld.</p>"},{"location":"Agents/Build%20Multi-Agent%20System%28MAS%29/#two-examples-of-overriding-routing-react-and-plan-execute","title":"Two Examples of Overriding Routing: ReAct and Plan-Execute","text":""},{"location":"Agents/Build%20Multi-Agent%20System%28MAS%29/#react","title":"ReAct","text":"<pre><code>@HandlerFactory.register(name='react')\nclass ReactHandler(AgentHandler):\n    def is_valid_message(self, message: Message):\n        if message.category != 'react':\n            return False\n        return True\n\n    async def _do_handle(self, message: Message) -&gt; AsyncGenerator[Message, None]:\n        yield message\n</code></pre>"},{"location":"Agents/Build%20Multi-Agent%20System%28MAS%29/#plan-execute","title":"Plan-Execute","text":"<p>Compared to ReAct, agent2 and agent3 can execute in parallel simultaneously.</p> <pre><code>from aworld.core.common import Observation\nfrom aworld.core.event.base import AgentMessage\nfrom aworld.logs.util import logger\n\n@HandlerFactory.register(name='plan_execute')\nclass PlanExecuteHandler(AgentHandler):\n    def is_valid_message(self, message: Message):\n        if message.category != 'plan_execute':\n            return False\n        return True\n\n    async def _do_handle(self, message: Message) -&gt; AsyncGenerator[Message, None]:\n        logger.info(f\"PlanExecuteHandler|handle|taskid={self.task_id}|is_sub_task={message.context._task.is_sub_task}\")\n        content = message.payload\n\n        # Parse model plan\n        plan = parse_plan(content[0].policy_info)\n        logger.info(f\"PlanExecuteHandler|plan|{plan}\")\n\n        # Execute steps\n        output, context = execution_steps(plan.steps)\n\n        # Send event message, notify the next processing agent\n        new_plan_input = Observation(content=output)\n        yield AgentMessage(\n            session_id=message.session_id,\n            payload=new_plan_input,\n            sender=self.name(),\n            receiver=self.swarm.communicate_agent.id(),\n            headers={'context': context}\n        )\n</code></pre> <p>For more details, refer to the examples.</p>"},{"location":"Agents/Build%20Multi-Agent%20System%28MAS%29/#combination-and-recursion-of-mas-and-workflow","title":"Combination and Recursion of MAS and Workflow","text":"<p>Same or different types of Swarms can be deeply nested, providing multi-level Swarms with different interaction mechanisms to support complex multi-agent interactions. For example, when creating a travel itinerary planner, using a combination of Workflow + MAS, where Workflow provides deterministic processes and MAS handles multi-source information retrieval and integration.</p> <pre><code>from aworld.config.conf import AgentConfig\nfrom aworld.agents.llm_agent import Agent\nfrom aworld.core.agent.swarm import Swarm, GraphBuildType\n\n# Configure agents\nagent_conf = AgentConfig(...)\n\n# Create five agents\nrewrite = Agent(name=\"rewrite\", conf=agent_conf)\nplan = Agent(name=\"plan\", conf=agent_conf)\nsearch = Agent(name=\"search\", conf=agent_conf)\nsummary = Agent(name=\"summary\", conf=agent_conf)\nreport = Agent(name=\"report\", conf=agent_conf)\n\n# Construct a MAS\nmas = Swarm(\n    topology=[(plan, search), (plan, summary)], \n    build_type=GraphBuildType.HANDOFF, \n    root_agent=[plan]\n)\n\n# Construct a combination of a workflow with the MAS team\ncombination = Swarm(\n    topology=[(rewrite, mas), (mas, report)], \n    root_agent=[rewrite]\n)\n</code></pre>"},{"location":"Agents/Build%20WorkFlow/","title":"Workflow","text":"<p>We use the classic graph syntax to describe workflows in AWorld. The following are the basic scenarios for constructing agent workflows.</p>"},{"location":"Agents/Build%20WorkFlow/#agent-native-workflow","title":"Agent Native Workflow","text":""},{"location":"Agents/Build%20WorkFlow/#sequential","title":"Sequential","text":"<pre><code>\"\"\"\nSequential Agent Pipeline: agent1 \u2192 agent2 \u2192 agent3\n\nExecutes agents in sequence where each agent's output becomes \nthe next agent's input, enabling multi-step collaborative processing.\n\"\"\"\n\nswarm = Swarm([(agent1, agent2), (agent2, agent3)], root_agent=[agent1])\nresult: TaskResponse = Runners.run(input=question, swarm=swarm)\n</code></pre>"},{"location":"Agents/Build%20WorkFlow/#parallel","title":"Parallel","text":"<pre><code>\"\"\"\nParallel Agent Execution with Barrier Synchronization\n\n    Input \u2500\u2500\u252c\u2500\u2192 agent1 \u2500\u2500\u2510\n            \u2502            \u251c\u2500\u2500\u2192 agent3 (barrier wait)\n            \u2514\u2500\u2192 agent2 \u2500\u2500\u2518\n\n- agent1 and agent2 execute in parallel\n- agent3 acts as a barrier, waiting for both agents\n- agent3 processes combined outputs from agent1 and agent2\n\"\"\"\n\nswarm = Swarm([(agent1, agent3), (agent2, agent3)], root_agent=[agent1, agent2])\nresult: TaskResponse = Runners.run(input=question, swarm=swarm)\n</code></pre>"},{"location":"Agents/Build%20WorkFlow/#parallel-multi-path","title":"Parallel Multi-Path","text":"<pre><code>\"\"\"\nParallel Multi-Path Agent Execution\n\n    Input \u2500\u2500\u2192 agent1 \u2500\u2500\u252c\u2500\u2500\u2192 agent2 \u2500\u2500\u2510\n                       \u2502             \u2502\n                       \u2514\u2500\u2500\u2192 agent3 \u2190\u2500\u2518 (barrier wait for agent1 &amp; agent2)\n\n- Single input enters only through agent1\n- agent1 distributes to both agent2 and agent3\n- agent2 processes and feeds agent3\n- agent3 waits for both agent1 and agent2 completion\n- agent3 synthesizes outputs from both agent1 and agent2\n\"\"\"\n\nswarm = Swarm([(agent1, agent2), (agent1, agent3), (agent2, agent3)], root_agent=[agent1])\nresult: TaskResponse = Runners.run(input=question, swarm=swarm)\n</code></pre>"},{"location":"Agents/Build%20WorkFlow/#task-native-workflow","title":"Task Native Workflow","text":"<p>Task native workflow is further implemented for Isolating the agent runtimes and environments, in the distributed or other easy-to-overlap scenarios. </p> <p>Task native workflow is further implemented for isolating agent runtimes and environments, particularly useful in distributed or other scenarios where tool-isolation is required. </p> <pre><code>task1 = Task(input=\"my question\", agent=agent1)\ntask2 = Task(agent=agent2)\ntask3 = Task(agent=agent3)\ntasks = [task1, task2, task3]\n\nresult: Dict[str, TaskResponse] = Runners.run_task(tasks, RunConfig(sequence_dependent=True))\n</code></pre>"},{"location":"Agents/Context/","title":"Context","text":"<p>First Principle: The performance bottleneck of large models lies not in parameter count, but in the \"quality of context\" they perceive. Despite expanding context windows, research has found a \"Context Rot\" phenomenon: as the number of tokens increases, the model's ability to accurately recall information decreases. Context engineering is the connector between an Agent's \"digital brain\" and the real world, and it is the natural evolution of Prompt Engineering \u2014 shifting from simple instruction writing to the dynamic curation and maintenance of the optimal token set during the LLM's reasoning process. </p>"},{"location":"Agents/Context/#1-core-challenge-why-context-engineering","title":"1. Core Challenge: Why Context Engineering?","text":"<p>In long sequences and complex Agent tasks, simply increasing the window size does not solve all problems; instead, it brings the following challenges:</p> <ol> <li>Context Rot: LLMs have an \"attention budget.\" Due to the limitations of the Transformer architecture, excessively long contexts lead to a significant decline in the model's ability to extract information from the middle (Lost in the middle).</li> <li>Noise &amp; Entropy: Massive raw tool outputs and redundant logs drown out key instructions.</li> <li>State Hallucination: Stale information in long-term memory conflicts with the latest state in the real-time Workspace, leading to decision bias.</li> <li>RAG Semantic Loss: Traditional document chunking destroys context integrity, resulting in retrieved fragments that lack interpretability.</li> </ol>"},{"location":"Agents/Context/#2-context-anatomy","title":"2. Context Anatomy","text":"<p>AWorld deconstructs the context load into three core components to achieve fine-grained management:</p>"},{"location":"Agents/Context/#21-guidance-context","title":"2.1 Guidance Context","text":"<p>Defines the Agent's basic reasoning mode and behavioral boundaries:</p> <ul> <li>System Instructions: Roles, capabilities, and constraints.</li> <li>Tool Definitions: API schema descriptions (supports dynamic loading via MCP).</li> <li>Few-Shot Examples: Guides the model to follow specific reasoning chains.</li> </ul>"},{"location":"Agents/Context/#22-evidential-data","title":"2.2 Evidential Data","text":"<p>Substantive basis for Agent reasoning:</p> <ul> <li>Long-Term Memory: User preferences, factual knowledge, cross-session experiences.</li> <li>External Knowledge: Document fragments retrieved via RAG.</li> <li>Tool/Sub-Agent Outputs: Intermediate results during task execution.</li> </ul>"},{"location":"Agents/Context/#23-immediate-information","title":"2.3 Immediate Information","text":"<p>Places the Agent within the current interaction flow:</p> <ul> <li>Dialogue History: Round-by-round records to maintain coherence.</li> <li>Scratchpad: Records intermediate reasoning processes.</li> <li>User Prompt: The specific query currently needing resolution.</li> </ul>"},{"location":"Agents/Context/#3-core-architecture-amnicontext","title":"3. Core Architecture: AmniContext","text":"<p>AWorld is based on the AmniContext framework, countering context rot through active control rather than passive stacking.</p>"},{"location":"Agents/Context/#31-design-philosophy-a-m-n-i","title":"3.1 Design Philosophy (A-M-N-I)","text":"<ul> <li>A (Ant): Carries the engineering heritage of Ant Group in distributed architecture and large-scale collaboration.</li> <li>M (Mind): Simulates the interaction between human working memory and long/short-term memory.</li> <li>N (Neuro): Mimics neural network information indexing and association.</li> <li>I (Intelligence): Drives high-quality intelligent decision-making.</li> </ul>"},{"location":"Agents/Context/#32-hierarchical-structure-and-memory-model","title":"3.2 Hierarchical Structure and Memory Model","text":"<p>Context supports tree-based hierarchical referencing, achieving information sharing and isolation through an upward backtracing mechanism:</p> Memory Layer Storage Location Function Working Memory Memory / TaskState Real-time decision making, stores current step KV data Short Memory Checkpoint / Memory Maintains task continuity, includes dialogue history and trajectories Long Memory Vector DB / UserProfile Cross-session personalization, stores user profiles and factual knowledge"},{"location":"Agents/Context/#4-basic-usage","title":"4. Basic Usage","text":"<p>Basic usage covers the core operations required to build standard Agent tasks.</p>"},{"location":"Agents/Context/#41-initialization-and-creation","title":"4.1 Initialization and Creation","text":"<p>Before starting, middlewares need to be initialized to enable memory and retrieval functions.</p> <pre><code>from aworld.core.context.amni import ApplicationContext, TaskInput, init_middlewares\nfrom aworld.core.context.amni.config import AmniConfigFactory, AmniConfigLevel\n\n# 1. Initialize middlewares (Enable SQLite memory backend and retriever)\ninit_middlewares()\n\n# 2. Create task input\ntask_input = TaskInput(\n    user_id=\"user_001\",\n    session_id=\"session_001\",\n    task_id=\"task_001\",\n    task_content=\"Analyze AI trends in 2024\"\n)\n\n# 3. Create configuration (PILOT/COPILOT/NAVIGATOR)\n# PILOT level provides basic context management\nconfig = AmniConfigFactory.create(level=AmniConfigLevel.PILOT)\n\n# 4. Create context from input (Asynchronous)\ncontext = await ApplicationContext.from_input(task_input, context_config=config)\n</code></pre>"},{"location":"Agents/Context/#42-neurons-assembly","title":"4.2 Neurons &amp; Assembly","text":"<p>The core philosophy of AWorld is: Treat every structured piece of information in the Prompt as a \"Neuron\". Context is no longer a disorganized pile of text but a \"digital brain\" dynamically assembled from multiple sensory-capable neurons.</p>"},{"location":"Agents/Context/#1-context-processing-pipeline-op-neuron","title":"1. Context Processing Pipeline: Op -&gt; Neuron","text":"<p>The flow of information follows a pipeline model of \"Processing (Op) -&gt; Expression (Neuron)\":</p> <ul> <li>Context Op: Responsible for extracting, cleaning, and structuring information from raw inputs (e.g., tool execution results, dialogue history).</li> <li>Neuron: Responsible for presenting the processed information to the model in the optimal format (e.g., XML) within the Prompt.</li> </ul>"},{"location":"Agents/Context/#2-variable-access-and-auto-assembly","title":"2. Variable Access and Auto-Assembly","text":"<p>Context provides a simple KV interface and supports dynamic referencing in Prompt templates via <code>{{xxx}}</code> syntax.</p> <pre><code># Store runtime variables (Working Memory)\ncontext.put(\"focus_area\", \"LLM Context Window\")\n\n# Retrieve variables (Supports automatic upward backtracing to parent context)\narea = context.get(\"focus_area\")\n</code></pre>"},{"location":"Agents/Context/#3-customization","title":"3. Customization","text":"<p>Developers can easily extend custom neurons and processing operations based on specific business scenarios.</p> <p>Custom Neuron Example:</p> <pre><code>from aworld.core.context.amni.prompt.neurons import Neuron, neuron_factory\n\n@neuron_factory.register(name=\"user_preference\", desc=\"Custom user preference neuron\")\nclass UserPreferenceNeuron(Neuron):\n    async def format(self, context: ApplicationContext, **kwargs) -&gt; str:\n        pref = context.get(\"user_pref\")\n        return f\"&lt;user_pref&gt;{pref}&lt;/user_pref&gt;\"\n</code></pre> <p>Custom Processing Operation (Op) Example:</p> <pre><code>from aworld.core.context.amni.processor.op import BaseOp, memory_op\n\n@memory_op(\"extract_pref\")\nclass ExtractPreferenceOp(BaseOp):\n    async def run(self, context: ApplicationContext):\n        # Logic: Analyze and extract preferences from dialogue, store in KV\n        context.put(\"user_pref\", \"High Precision\")\n</code></pre>"},{"location":"Agents/Context/#4-advanced-prompt-assembly-example","title":"4. Advanced Prompt Assembly Example","text":"<p><code>PromptService</code> supports referencing various built-in and custom neurons:</p> <pre><code>template = \"\"\"\n# Task and Environment\nGoal: {{task_input}}\nActive Working Directory: {{working_dir}}\n\n# Cognitive Neurons\nKey Facts: {{facts}}\nUser Preference: {{user_preference}}  # Reference custom neuron\n\n# History Backtrace\nRoot Task Goal: {{root.task_input}}\n\"\"\"\n\n# Execute formatting; the system will automatically call the format method of each neuron\nprompt = await context.prompt_service.async_format(template)\n</code></pre>"},{"location":"Agents/Context/#43-knowledge-usage","title":"4.3 Knowledge Usage","text":"<p>Knowledge refers to unstructured or semi-structured data (Artifacts) stored in the Workspace, which can be indexed and referenced through context.</p>"},{"location":"Agents/Context/#adding-knowledge","title":"Adding Knowledge","text":"<pre><code>from aworld.output import Artifact\n\n# 1. Create artifact (e.g., a research report)\nartifact = Artifact(\n    id=\"report_001\",\n    content=\"AWorld uses distributed context management...\",\n    metadata={\"type\": \"text\", \"source\": \"research\"}\n)\n\n# 2. Add knowledge to context (Automatic indexing)\nawait context.add_knowledge(artifact)\n</code></pre>"},{"location":"Agents/Context/#referencing-knowledge-in-prompt","title":"Referencing Knowledge in Prompt","text":"<p>You can inject knowledge content directly into the Prompt using specific path syntax:</p> <pre><code># Reference full content\nprompt_with_content = await context.prompt_service.async_format(\n    \"Refer to report content: {{knowledge/report_001/content}}\"\n)\n\n# Reference auto-generated summary (Requires corresponding configuration)\nprompt_with_summary = await context.prompt_service.async_format(\n    \"Report summary: {{knowledge/report_001/summary}}\"\n)\n</code></pre>"},{"location":"Agents/Context/#5-advanced-usage","title":"5. Advanced Usage","text":"<p>Advanced usage is suitable for multi-agent collaboration, ultra-long tasks, and automated cognitive processing.</p>"},{"location":"Agents/Context/#51-context-offloading","title":"5.1 Context Offloading","text":"<p>For massive tool outputs (e.g., vast web content), the system will automatically or manually offload them from the context to the Workspace.</p> <pre><code># 1. Auto-offload configuration (Enabled by default at COPILOT/NAVIGATOR levels)\nconfig = AmniConfigFactory.create(\n    level=AmniConfigLevel.COPILOT,\n    tool_result_offload=True,\n    tool_result_length_threshold=30000  # Auto-offload if exceeds 30k characters\n)\n\n# 2. Manual offload execution\nawait context.offload_by_workspace(artifacts)\n</code></pre>"},{"location":"Agents/Context/#52-hierarchical-tasks-planning","title":"5.2 Hierarchical Tasks &amp; Planning","text":"<p>A core advantage of AmniContext is its native support for Planning mode. It decomposes complex macro goals into executable micro atomic tasks through a Task Tree and automatically manages the flow of context between them.</p>"},{"location":"Agents/Context/#core-capabilities-multi-task-decomposition-and-parallelism","title":"Core Capabilities: Multi-task Decomposition and Parallelism","text":"<ul> <li>Recursive Decomposition: Agents can dynamically generate N sub-tasks based on the main task goal, each with its own <code>SubContext</code>.</li> <li>Inheritance: Sub-contexts automatically inherit the parent's <code>kv_store</code> and environment configurations, ensuring sub-tasks have global Contextual Awareness during execution.</li> <li>Consolidation: When a sub-task is completed, results, facts, and token consumption are asynchronously merged back into the main context via <code>merge_sub_context</code>.</li> </ul>"},{"location":"Agents/Context/#example-task-lifecycle-in-planning-mode","title":"Example: Task Lifecycle in Planning Mode","text":"<pre><code># 1. Build sub-context (Triggered by Planner Agent)\n# The system automatically establishes parent-child references and clones the necessary runtime environment\nsub_context = await context.build_sub_context(\n    sub_task_content=\"Investigate technical details of long-context models\",\n    sub_task_id=\"sub_task_001\",\n    task_type=\"normal\" # Supports normal or background (asynchronous)\n)\n\n# 2. Precise context isolation and backtrace\n# Sub-tasks only focus on their own input but can access parent background via {{parent.xxx}}\nparent_goal = await sub_context.prompt_service.async_format(\"{{parent.task_input}}\")\n\n# 3. Task execution and state merging\n# After task completion, facts and KV variables generated by the sub-task are automatically updated to the parent task\ncontext.merge_sub_context(sub_context)\n</code></pre>"},{"location":"Agents/Context/#parallel-execution-support","title":"Parallel Execution Support","text":"<p>In distributed scenarios, AmniContext supports multiple sub-tasks running in parallel across different execution engines. Each node maintains context consistency through <code>snapshot</code> and <code>restore</code>, ultimately achieving global state consolidation at the root node.</p>"},{"location":"Agents/Context/#53-agent-isolation","title":"5.3 Agent Isolation","text":"<p>Establishes an independent private state space for each Agent to prevent variable pollution.</p> <pre><code># 1. Initialize Agent private state\nawait context.build_agents_state([web_agent, analyst_agent])\n\n# 2. Access in specific namespace\ncontext.put(\"search_history\", [\"link1\", \"link2\"], namespace=web_agent.id())\n</code></pre>"},{"location":"Agents/Context/#54-environment-integration-freedom-space","title":"5.4 Environment Integration &amp; Freedom Space","text":"<p><code>FreedomSpaceService</code> provides an isolated \"Freedom Space\" (working directory) for the Agent. Its core capability is achieving file system sharing between persistent storage and execution environments (Sandbox/Docker).</p>"},{"location":"Agents/Context/#core-features","title":"Core Features","text":"<ul> <li>File System Mapping: Files operated by the Agent in Freedom Space are automatically mapped to <code>env_mount_path</code> in the execution environment.</li> <li>Transparent Access: Code written or artifacts generated by the Agent are transparently synchronized between the physical storage layer (local/OSS) and the logical execution layer (Docker).</li> <li>Persistence Guarantee: Even if the execution environment is destroyed, data in the Freedom Space remains in the Workspace, supporting cross-task recovery.</li> </ul>"},{"location":"Agents/Context/#example-configuration-and-usage","title":"Example: Configuration and Usage","text":"<pre><code># 1. Configure environment sharing parameters\nconfig = AmniConfigFactory.create(level=AmniConfigLevel.COPILOT)\nconfig.env_config.env_type = \"remote\" # Enable remote/sandbox mode\nconfig.env_config.env_mount_path = \"/workspace\" # Mount point inside the execution environment\n\n# 2. Add file to Freedom Space and get environment path\nsuccess, env_abs_path, content = await context.freedom_space_service.add_file(\n    filename=\"data_process.py\",\n    content=\"import os\\nprint(os.getcwd())\",\n    mime_type=\"text/x-python\"\n)\n# env_abs_path will return \"/workspace/data_process.py\"\n\n# 3. Use in code executor\n# The Agent can directly execute files under this path in the sandbox\n</code></pre>"},{"location":"Agents/Context/#path-variable-reference","title":"Path Variable Reference","text":"<p>In Prompt templates, the following variables can be used for precise environment referencing:</p> <ul> <li><code>{{working_dir_env_mounted_path}}</code>: Gets the absolute mount path of Freedom Space in the execution environment.</li> <li><code>{{working_dir}}</code>: Returns a formatted list of all mounted files in Freedom Space (XML format, including filenames and absolute paths).</li> <li><code>{{current_working_directory}}</code>: Gets the operating system running directory of the current process.</li> </ul>"},{"location":"Agents/Context/#55-autonomous-cognition","title":"5.5 Autonomous Cognition","text":"<p>At the <code>NAVIGATOR</code> level, the system fully enables an \"autopilot\" mode based on a \"cognitive closed loop,\" achieving System Prompt Augment and Dynamic Tool Injection:</p> <ul> <li>System Prompt Augment: The system automatically concatenates \"neurons\" such as current task status, working directory file lists, and basic environment information into the Agent's System Prompt based on configured <code>neuron_names</code> (e.g., <code>task</code>, <code>working_dir</code>, <code>skills</code>, <code>basic</code>).</li> <li>Dynamic Tool Injection: Via the <code>skills</code> neuron, the system automatically injects a list of available tools (Skills) and usage guides for the Agent.<ul> <li>Progressive Disclosure: Initially only tool summaries are injected. When the Agent decides it needs a specific skill, it dynamically loads the full tool Schema and instructions via <code>active_skill</code>.</li> <li>Automatic Guidance: Automatically concatenates <code>&lt;skills_guide&gt;</code>, informing the Agent how to manage its own skill stack (Activate/Offload).</li> </ul> </li> <li>Automated Reasoning Orchestrator: Enables autonomous reasoning orchestration. The system automatically drives the reasoning engine for strategy formulation and task logic flow decomposition based on goals. Enabling this automatically injects the <code>context_planning</code> tool.</li> <li>Automated Cognitive Ingestion: Enables automatic cognitive ingestion. Enabling this automatically injects the <code>context_knowledge</code> tool and simultaneously loads <code>todo</code> (task list) and <code>action_info</code> (execution history) neurons.</li> <li>Automated Memory Recursive: Enables recursive experience loops.</li> <li>Automated Memory Recall: Enables automatic memory recall.</li> </ul>"},{"location":"Agents/Context/#6-scenario-based-strategies","title":"6. Scenario-based Strategies","text":"<p>Strategies should be chosen flexibly based on task complexity:</p>"},{"location":"Agents/Context/#61-scenario-1-simple-chat","title":"6.1 Scenario 1: Simple Chat","text":"<ul> <li>Features: Clear goals, no reliance on complex files or long history.</li> <li>Recommended Strategy:<ul> <li>Config Level: <code>AmniConfigLevel.PILOT</code></li> <li>Core Neurons: <code>basic</code> + <code>task</code></li> <li>Details: Maintain low <code>history_rounds</code> (e.g., 5-10); no need for auto-summary or offloading.</li> </ul> </li> </ul>"},{"location":"Agents/Context/#62-scenario-2-complex-research-rag","title":"6.2 Scenario 2: Complex Research (RAG)","text":"<ul> <li>Features: Needs to read many documents/webpages; retrieval recall is key.</li> <li>Recommended Strategy:<ul> <li>Config Level: <code>AmniConfigLevel.COPILOT</code></li> <li>Core Neurons: <code>knowledge</code> + <code>summaries</code></li> <li>Practice: Force Contextual Retrieval and utilize Prompt Caching for large reference materials.</li> </ul> </li> </ul>"},{"location":"Agents/Context/#63-scenario-3-planning-intensive-tasks","title":"6.3 Scenario 3: Planning Intensive Tasks","text":"<ul> <li>Features: Long task chains, multiple sub-tasks, frequent tool calls, needs Task Tree awareness.</li> <li>Recommended Strategy:<ul> <li>Config Level: <code>AmniConfigLevel.NAVIGATOR</code></li> <li>Core Neurons: <code>task</code> + <code>todo</code> + <code>action_info</code></li> <li>Capabilities: Enable <code>automated_reasoning_orchestrator</code> for autonomous task management.</li> </ul> </li> </ul>"},{"location":"Agents/Context/#64-scenario-4-code-sandbox-collaboration","title":"6.4 Scenario 4: Code Sandbox Collaboration","text":"<ul> <li>Features: Relies on file systems, frequent reads/writes of artifacts.</li> <li>Recommended Strategy:<ul> <li>Config Level: <code>AmniConfigLevel.COPILOT</code> / <code>NAVIGATOR</code></li> <li>Core Neurons: <code>working_dir</code> + <code>skills</code></li> <li>Integration: Configure <code>env_mount_path</code> for file sharing.</li> </ul> </li> </ul>"},{"location":"Agents/Context/#7-best-practices-guide","title":"7. Best Practices Guide","text":"<ol> <li>Attention Budget Management: Always follow the \"Minimum Necessity Principle.\"</li> <li>Namespace Isolation: In multi-agent collaboration, always use the <code>namespace</code> parameter.</li> <li>Structured Processing Flow: Prioritize storing raw data as Artifacts and use <code>Context Op</code> for recursive summarization.</li> </ol>"},{"location":"Agents/Custom%20Agent/","title":"Custom Agent","text":"<p>AWorld provides a fundamental Agent interface that unlocks limitless possibilities for agent capabilities. While the LLMAgent is the most commonly used implementation, the framework imposes no restrictions on other agent types\u2014such as those powered by rule-based systems or traditional machine learning models\u2014as their decision core.</p>"},{"location":"Agents/Custom%20Agent/#llmagent-customization","title":"LLMAgent customization","text":"<p>The most typical ability of LLM Agent is to use LLM to make decisions, which is abstracted into 5 steps in AWorld:</p> <ol> <li>Agent initialization,</li> <li>Construct LLM input,</li> <li>Call LLM,</li> <li>Parse the LLM output,</li> <li>Generate Agent response.</li> </ol>"},{"location":"Agents/Custom%20Agent/#customizing-agent-input","title":"Customizing Agent Input","text":"<p>Override the <code>init_observation()</code> function to customize how your agent processes initial observations:</p> <pre><code>async def init_observation(self, observation: Observation) -&gt; Observation:\n    # You can add extended information from other agents or third-party storage\n    # For example, enrich the observation with additional context\n    observation.metadata = {\"timestamp\": time.time(), \"source\": \"custom\"}\n    return observation\n</code></pre>"},{"location":"Agents/Custom%20Agent/#customizing-model-input","title":"Customizing Model Input","text":"<p>Override the <code>async_messages_transform()</code> function to customize how messages are transformed before being sent to the model:</p> <pre><code>async def async_messages_transform(self,\n                                   image_urls: List[str] = None,\n                                   observation: Observation = None,\n                                   message: Message = None,\n                                   **kwargs) -&gt; List[Dict[str, Any]]:\n    \"\"\"\n    Transform input data into the format expected by the LLM.\n\n    Args:\n         image_urls: List of images encoded using base64\n         observation: Observation from the environment\n         message: Event received by the Agent\n    \"\"\"\n    messages = []\n\n    # Add system context\n    if hasattr(self, 'system_prompt'):\n        messages.append({\"role\": \"system\", \"content\": self.system_prompt})\n\n    # Add user message\n    if message and message.content:\n        messages.append({\"role\": \"user\", \"content\": message.content})\n\n    # Add images if present\n    if image_urls:\n        for img_url in image_urls:\n            messages.append({\n                \"role\": \"user\",\n                \"content\": [{\"type\": \"image_url\", \"image_url\": {\"url\": img_url}}]\n            })\n\n    return messages\n</code></pre>"},{"location":"Agents/Custom%20Agent/#customizing-model-logic","title":"Customizing Model Logic","text":"<p>Override the <code>invoke_model()</code> function to implement custom model logic:</p> <pre><code>async def invoke_model(self,\n                       messages: List[Dict[str, str]] = [],\n                       message: Message = None,\n                       **kwargs) -&gt; ModelResponse:\n    \"\"\"Custom model invocation logic.\n       You can use neural networks, rule-based systems, or any other business logic.\n    \"\"\"\n\n      # Example: Use a custom model or business logic\n      if self.use_custom_logic:\n          # Your custom logic here\n          response_content = self.custom_model.predict(messages)\n      else:\n          # Use the default LLM\n          response_content = await self.llm_client.chat_completion(messages)\n\n      return ModelResponse(\n          id=f\"response_{int(time.time())}\",\n          model=self.model_name,\n          content=response_content,\n          tool_calls=None  # Set if tool calls are present\n      )\n</code></pre>"},{"location":"Agents/Custom%20Agent/#customizing-model-output","title":"Customizing Model Output","text":"<p>Create a custom <code>ModelOutputParser</code> class and specify it using the <code>model_output_parser</code> parameter:</p> <pre><code>from aworld.models.model_output_parser import ModelOutputParser\n\n\nclass CustomOutputParser(ModelOutputParser[ModelResponse, AgentResult]):\n    async def parse(self, resp: ModelResponse, **kwargs) -&gt; AgentResult:\n        \"\"\"Custom parsing logic based on your model's API response format.\"\"\"\n\n         # Extract relevant information from the model response\n         content = resp.content\n         tool_calls = resp.tool_calls\n\n         # Create your custom AgentResult\n         result = AgentResult(\n             content=content,\n             tool_calls=tool_calls,\n             metadata={\"parsed_at\": time.time()}\n         )\n\n         return result\n\n# Use the custom parser\n\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    model_output_parser=CustomOutputParser()\n)\n</code></pre>"},{"location":"Agents/Custom%20Agent/#customizing-agent-response","title":"Customizing Agent Response","text":"<p>Override the <code>async_post_run()</code> function to customize how your agent responds:</p> <pre><code>from aworld.core.message import Message\n\nclass CustomMessage(Message):\n      def __init__(self, content: str, custom_field: str = None):\n            super().__init__(content=content)\n            self.custom_field = custom_field\n\nasync def async_post_run(self,\n                        policy_result: List[ActionModel],\n                        policy_input: Observation,\n                        message: Message = None) -&gt; Message:\n      \"\"\"\n      Customize the agent's response after processing.\n      \"\"\"\n\n      # Process the policy result and create a custom response\n      response_content = f\"Processed {len(policy_result)} actions\"\n      custom_field = \"custom_value\"\n\n       return CustomMessage(\n           content=response_content,\n           custom_field=custom_field\n       )\n</code></pre>"},{"location":"Agents/Custom%20Agent/#custom-agent-policy","title":"Custom Agent Policy","text":"<p>Override the <code>async_policy()</code> function to customize your agent policy logic:</p> <pre><code>async def async_policy(self, observation: Observation, info: Dict[str, Any] = {}, message: Message = None,\n                           **kwargs) -&gt; List[ActionModel]:\n    self._finished = False\n    # build model input messages\n    messages = await self.build_llm_input(observation, info, message)\n    # call model\n    llm_response = await self.invoke_model(messages, message=message, **kwargs)\n    # parse model response\n    agent_result = await self.model_output_parser.parse(llm_response,\n                                                        agent_id=self.id(),\n                                                        use_tools_in_prompt=self.use_tools_in_prompt)\n\n    self._finished = True\n    return agent_result.actions\n</code></pre>"},{"location":"Agents/Custom%20Agent/#custom-agent-event-parsing","title":"Custom Agent Event Parsing","text":"<p>If the framework still does not support the response structure you want, or if there is special logic processing (such as triggering multiple downstream agents based on Agent response), you can create a custom agent response event handler:</p> <pre><code>from aworld.runners import HandlerFactory\nfrom aworld.runners.default_handler import DefaultHandler\n\n# Define a custom handler name\ncustom_name = \"custom_handler\"\n\n\n@HandlerFactory.register(name=custom_name)\nclass CustomHandler(DefaultHandler):\n    def is_valid_message(self, message: Message):\n        \"\"\"Check if this handler should process the message.\"\"\"\n        return message.category == custom_name\n\n\nasync def _do_handle(self, message: Message) -&gt; AsyncGenerator[Message, None]:\n    \"\"\"Custom message processing logic.\"\"\"\n    if not self.is_valid_message(message):\n        return\n\n    # Implement your custom message processing logic here\n    processed_message = self.process_custom_message(message)\n    yield processed_message\n\n\n# Use the custom handler\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    event_handler_name=custom_name\n)\n</code></pre> <p>Important Note: The <code>custom_name</code> variable value must remain consistent across your handler registration and agent configuration.</p>"},{"location":"Agents/Custom%20Agent/#agent-customization","title":"Agent customization","text":"<p>Users can also implement their own designed Agent, as long as it complies with interface specifications.</p>"},{"location":"Agents/Custom%20Agent/#customize-the-overall-process","title":"Customize the overall process","text":"<p>Override the<code>run()</code> or<code>async_run()</code> function to implement custom model logic:</p> <pre><code># async\nasync def async_run(self, message: Message, **kwargs) -&gt; Message:\n    return Message(...)\n\n# sync\ndef run(self, message: Message, **kwargs) -&gt; Message:\n    return Message(...)\n</code></pre>"},{"location":"Agents/Custom%20Agent/#customized-decision-process","title":"Customized decision process","text":"<p>It is recommended to use Observation and List [ActionModel] for INPUT and OUTPUT, which can be customized with minimal cost.</p> <p>Override the<code>policy()</code> or<code>async_policy()</code> function to implement custom model logic:</p> <pre><code># async\nasync def async_policy(\n    self, observation: INPUT, info: Dict[str, Any] = None, **kwargs\n) -&gt; OUTPUT:\n    pass\n\n# sync\ndef policy(\n    self, observation: INPUT, info: Dict[str, Any] = None, **kwargs\n) -&gt; OUTPUT:\n    pass\n</code></pre>"},{"location":"Agents/Memory/","title":"Memory","text":"<p>AWorld Memory is a unified memory management framework designed for multi-agent systems. It aims to help agents store, retrieve, and process information, enabling continuous learning, personalized interaction, and experiential evolution across sessions.</p>"},{"location":"Agents/Memory/#1-core-concepts","title":"1. Core Concepts","text":"<p>AWorld divides memory into two primary dimensions: Short-Term Memory (STM) and Long-Term Memory (LTM).</p>"},{"location":"Agents/Memory/#11-short-term-memory-stm","title":"1.1 Short-Term Memory (STM)","text":"<p>Used to store immediate interaction records of the agent in the current task or session.</p> <ul> <li>Storage Objects: <code>MemoryHumanMessage</code> (User input), <code>MemoryAIMessage</code> (AI response), <code>MemoryToolMessage</code> (Tool execution results), <code>MemorySystemMessage</code> (System instructions).</li> <li>Storage Engines: Supports multiple backends, defaulting to <code>InMemoryMemoryStore</code>. <code>PostgresMemoryStore</code> is recommended for production environments.</li> <li>Context Management: To prevent context overflow, several automatic compression strategies are provided:<ul> <li>Trimming: Keeps only the last N rounds of conversation.</li> <li>Fixed Step Summary: Generates a summary every N messages and removes the summarized messages.</li> <li>Length-based Summary: Triggers summarization when the total message length exceeds a threshold.</li> <li>Single Round Summary: Compresses individual messages that are excessively long.</li> </ul> </li> </ul>"},{"location":"Agents/Memory/#12-long-term-memory-ltm","title":"1.2 Long-Term Memory (LTM)","text":"<p>Used to store information with persistent value, supporting cross-session retrieval.</p> <ul> <li>UserProfile:<ul> <li>Structured storage of user preferences, profession, tech stack, communication style, etc.</li> <li>Example: <code>key=\"preferences.technical\", value={\"preferred_languages\": [\"Python\"]}</code>.</li> </ul> </li> <li>AgentExperience:<ul> <li>Records the successful paths and skills of the agent in solving complex problems.</li> <li>Structure: <code>skill</code> (Skill name), <code>actions</code> (Action sequence), <code>outcome</code> (Execution result).</li> </ul> </li> <li>Fact:<ul> <li>Concrete factual information extracted from conversations (e.g., \"User lives in Shanghai\").</li> </ul> </li> <li>ConversationSummary:<ul> <li>High-level summaries of completed sessions, serving as background reference for future interactions.</li> </ul> </li> </ul>"},{"location":"Agents/Memory/#2-quick-start","title":"2. Quick Start","text":""},{"location":"Agents/Memory/#21-initializing-the-memory-environment","title":"2.1 Initializing the Memory Environment","text":"<p>It is recommended to use <code>MemoryFactory</code> for global initialization.</p> <pre><code>from aworld.memory.main import MemoryFactory\nfrom aworld.core.memory import MemoryConfig, MemoryLLMConfig\n\n# Initialize Memory Factory\nMemoryFactory.init(\n    config=MemoryConfig(\n        provider=\"aworld\", # Core engine\n        llm_config=MemoryLLMConfig(\n            provider=\"openai\",\n            model_name=\"gpt-4o\",\n            api_key=\"your_api_key\"\n        )\n    )\n)\n\n# Get Instance\nmemory = MemoryFactory.instance()\n</code></pre>"},{"location":"Agents/Memory/#22-using-memory-in-agents","title":"2.2 Using Memory in Agents","text":"<p>Deeply customize the memory behavior of each agent through <code>AgentMemoryConfig</code>.</p> <pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.core.memory import AgentMemoryConfig, LongTermConfig\n\n# 1. Configure Memory Behavior\nmemory_config = AgentMemoryConfig(\n    enable_summary=True,        # Enable automatic summarization\n    trim_rounds=20,             # Keep the last 20 rounds\n    enable_long_term=True,      # Enable long-term memory\n    long_term_config=LongTermConfig.create_simple_config(\n        enable_user_profiles=True,\n        enable_agent_experiences=True\n    )\n)\n\n# 2. Create Agent\nagent = Agent(\n    name=\"MemoryAgent\",\n    agent_memory_config=memory_config,\n    # ... other configurations\n)\n</code></pre>"},{"location":"Agents/Memory/#3-basic-operations","title":"3. Basic Operations","text":""},{"location":"Agents/Memory/#31-core-operation-interface-crud","title":"3.1 Core Operation Interface (CRUD)","text":"<p>After obtaining an instance via <code>MemoryFactory.instance()</code>, you can perform the following core operations:</p>"},{"location":"Agents/Memory/#1-add-record-add","title":"1. Add Record (<code>add</code>)","text":"<p>Used to store new messages or memory items into the system. In AWorld, adding a record usually triggers subsequent automatic summarization or long-term memory extraction logic.</p> <pre><code>from aworld.memory.models import MemoryHumanMessage, MessageMetadata\n\n# Prepare metadata\nmetadata = MessageMetadata(\n    user_id=\"u_001\",\n    session_id=\"s_123\",\n    agent_id=\"a_999\",\n    task_id=\"t_456\"\n)\n\n# Create message object\nmessage = MemoryHumanMessage(content=\"Hello\", metadata=metadata)\n\n# Add memory\n# agent_memory_config is optional, used to trigger specific summarization strategies for that agent\nawait memory.add(\n    message, \n    agent_memory_config=context.get_config().get_agent_memory_config(namespace=\"a_999\")\n)\n</code></pre>"},{"location":"Agents/Memory/#2-delete-record-delete","title":"2. Delete Record (<code>delete</code>)","text":"<p>Deletes a specified memory item based on its ID (usually a logical deletion).</p> <pre><code># Delete by memory_id\nawait memory.delete(\"mem_uuid_12345\")\n</code></pre>"},{"location":"Agents/Memory/#3-get-recent-history-get_last_n","title":"3. Get Recent History (<code>get_last_n</code>)","text":"<p>This is the most commonly used interface, used to retrieve the recent conversation context when building LLM Prompts. It automatically handles the merging of <code>init</code> (system/initial info), <code>message</code> (dialogue), and <code>summary</code>.</p> <pre><code># Get the last 10 rounds of history\n# filters must include agent_id, session_id, task_id to ensure isolation\nfilters = {\n    \"agent_id\": \"a_999\",\n    \"session_id\": \"s_123\",\n    \"task_id\": \"t_456\"\n}\n\nhistories = memory.get_last_n(\n    last_rounds=10, \n    filters=filters,\n    agent_memory_config=agent_memory_config # Pass config to support complex merging logic\n)\n</code></pre>"},{"location":"Agents/Memory/#4-get-all-records-get_all","title":"4. Get All Records (<code>get_all</code>)","text":"<p>Retrieves all matching memory items based on a filter.</p> <pre><code># Get all message records under the current task\nall_messages = memory.get_all(filters={\n    \"task_id\": \"t_456\",\n    \"memory_type\": \"message\"\n})\n</code></pre>"},{"location":"Agents/Memory/#32-memory-isolation-levels-and-retrieval-filters","title":"3.2 Memory Isolation Levels and Retrieval Filters","text":"<p>After obtaining the instance, the most important step is to determine the History Scope. This determines the range of historical information the agent can \"recall.\"</p>"},{"location":"Agents/Memory/#1-isolation-level-history-scope","title":"1. Isolation Level (History Scope)","text":"<p>Configured via the <code>history_scope</code> parameter in <code>AgentMemoryConfig</code>. It supports three levels:</p> Level Parameter Value Description Use Case Task Level (Default) <code>task</code> Retrieves only messages under the current <code>task_id</code>. Independent task execution without historical context. Session Level <code>session</code> Retrieves all messages under the same <code>session_id</code> (may span multiple tasks). Continuous multi-round dialogue composed of sub-tasks. User Level <code>user</code> Retrieves all history of that <code>user_id</code> on that specific Agent. Long-term personal assistant needing to remember user habits."},{"location":"Agents/Memory/#2-building-retrieval-filters","title":"2. Building Retrieval Filters","text":"<p>When calling <code>get_last_n</code> or <code>search</code>, the framework automatically builds filters based on the configured Scope. Manual operation example:</p> <pre><code># Logic reference: aworld/agents/llm_agent.py\ndef build_filters(self, context: Context):\n    filters = {\"agent_id\": self.id()}\n    config = context.get_agent_memory_config(self.id())\n\n    # Core logic: Determine filter dimensions based on history_scope\n    scope = config.history_scope or \"task\"\n    if scope == \"user\":\n        filters[\"user_id\"] = context.user_id # or from task\n    elif scope == \"session\":\n        filters[\"session_id\"] = context.get_task().session_id\n    else:\n        filters[\"task_id\"] = context.get_task().id\n    return filters\n\n# Use filter to get recent history\nhistories = memory.get_last_n(\n    last_rounds=config.history_rounds, \n    filters=build_filters(context)\n)\n</code></pre>"},{"location":"Agents/Memory/#33-retrieving-long-term-memory","title":"3.3 Retrieving Long-Term Memory","text":"<pre><code># Retrieve UserProfile\nprofiles = await memory.retrival_user_profile(\n    user_id=\"u_001\", \n    user_input=\"I want to write some Python code\"\n)\n\n# Retrieve Related Experiences\nexperiences = await memory.retrival_agent_experience(\n    agent_id=\"a_999\",\n    user_input=\"Handling API rate limit errors\"\n)\n</code></pre>"},{"location":"Agents/Memory/#4-long-term-extraction","title":"4. Long-term Extraction","text":"<p>Long-term extraction is the core mechanism for \"Agent Evolution\" in AWorld. It automatically distills knowledge with persistent value by analyzing short-term dialogue history.</p>"},{"location":"Agents/Memory/#41-triggering-mechanism","title":"4.1 Triggering Mechanism","text":"<p>Long-term memory extraction does not happen in every round; it is triggered by the <code>DefaultMemoryOrchestrator</code> based on configuration:</p> <ul> <li>Message Count Trigger: Triggered when the number of messages in STM reaches the <code>message_count_threshold</code> (default 10).</li> <li>Importance Trigger: Monitors keywords in messages (e.g., \"error\", \"success\", \"completed\") and triggers upon a match.</li> <li>Forced Trigger: Triggered by setting <code>force=True</code> in <code>trigger_short_term_memory_to_long_term</code>.</li> </ul>"},{"location":"Agents/Memory/#42-extraction-flow","title":"4.2 Extraction Flow","text":"<p>AWorld's long-term memory extraction is a fully automated process executed silently in the background.</p> <ol> <li>Task Creation: The Orchestrator automatically collects relevant message streams based on the <code>history_scope</code>.</li> <li>Asynchronous Processing: If <code>enable_background_processing</code> is enabled, the extraction task runs in the background, not affecting the response speed of the main dialogue.</li> <li>LLM Extraction (Gungnir): <ul> <li>Automatic Identification: The system automatically identifies key information in the dialogue and structures it.</li> <li>Support for Prompt Customization: Although extraction is auto-triggered, developers can customize extraction Prompt templates. By modifying <code>user_profile_extraction_prompt</code> or <code>agent_experience_extraction_prompt</code> in <code>ExtractionConfig</code>, you can precisely control what information the LLM focuses on and the output format.</li> </ul> </li> <li>Structured Storage: Extraction results are converted into <code>UserProfile</code> or <code>AgentExperience</code> objects and persisted in the <code>MemoryStore</code> and vector database.</li> </ol>"},{"location":"Agents/Memory/#43-fact-extraction","title":"4.3 Fact Extraction","text":"<p>Besides profiles and experiences, AWorld supports extracting atomized Facts from tool execution results (e.g., search results).</p> <ul> <li>Scenario: Usually triggered by <code>ExtractToolFactOp</code> when a tool returns a large volume of information.</li> <li>Characteristics: Deconstructs complex information streams into independent, minimum units of knowledge (e.g., a company's financial data, a software's release date).</li> <li>Function: Prevents the agent from losing details when processing long documents or vast search results, while enabling precise \"Fact Recall\" through vector retrieval.</li> </ul>"},{"location":"Agents/Memory/#44-related-configuration","title":"4.4 Related Configuration","text":"<pre><code>from aworld.core.memory import LongTermConfig\n\n# Deeply customize extraction behavior\nlt_config = LongTermConfig()\nlt_config.trigger.message_count_threshold = 15      # Increase trigger threshold\nlt_config.trigger.enable_importance_trigger = True  # Enable importance monitoring\n\n# Customize Extraction Prompt (Optional)\nlt_config.extraction.user_profile_extraction_prompt = \"You are a professional personality analyst, please extract from the conversation...\"\nlt_config.extraction.agent_experience_extraction_prompt = \"Please summarize the core technical path of the agent in this task...\"\n\nlt_config.extraction.enable_user_profile_extraction = True\nlt_config.processing.enable_background_processing = True\n</code></pre>"},{"location":"Agents/Memory/#5-advanced-features","title":"5. Advanced Features","text":""},{"location":"Agents/Memory/#51-vector-storage-and-semantic-search","title":"5.1 Vector Storage and Semantic Search","text":"<p>AWorld Memory has built-in vectorization support, enabling retrieval of the most relevant historical information based on semantics.</p> <pre><code>from aworld.core.memory import EmbeddingsConfig, VectorDBConfig\n\n# Configure Vector Database (e.g., ChromaDB)\ncustom_config = MemoryConfig(\n    embedding_config=EmbeddingsConfig(\n        provider=\"openai\",\n        model_name=\"text-embedding-3-small\"\n    ),\n    vector_store_config=VectorDBConfig(\n        provider=\"chroma\",\n        config={\"chroma_data_path\": \"./data/chroma\"}\n    )\n)\n</code></pre>"},{"location":"Agents/Memory/#52-semantic-retrieval-interface","title":"5.2 Semantic Retrieval Interface","text":"<p>The <code>search</code> method supports hybrid retrieval:</p> <pre><code>results = memory.search(\n    query=\"User preferences for programming languages\",\n    memory_type=\"user_profile\",\n    filters={\"user_id\": \"u_001\"},\n    limit=5\n)\n</code></pre>"},{"location":"Agents/Memory/#53-internal-implementation-and-optimization-reference","title":"5.3 Internal Implementation and Optimization Reference","text":""},{"location":"Agents/Memory/#message-format-conversion-llm-adaptation","title":"Message Format Conversion (LLM Adaptation)","text":"<p>AWorld internally uses <code>to_openai_message()</code> to uniformly convert memory items into formats acceptable by models:</p> <pre><code># Logic reference: aworld/agents/llm_agent.py\nmessages = []\nfor history in histories:\n    if isinstance(history, MemoryMessage):\n        # Automatically handles role, content, and complex structures like tool_calls\n        messages.append(history.to_openai_message())\n</code></pre>"},{"location":"Agents/Memory/#redundant-tool-call-cleaning","title":"Redundant Tool Call Cleaning","text":"<p>To keep the context clean and save tokens, the framework automatically cleans up redundant tool call messages at specific moments (e.g., loop termination or reset):</p> <pre><code># See _clean_redundant_tool_call_messages implementation\n# Logic: Traverse backwards, deleting tool_call records that produced no results or are invalid\nmemory.delete(history_item_id)\n</code></pre>"},{"location":"Agents/Memory/#5-best-practices","title":"5. Best Practices","text":"<ol> <li>Metadata Consistency: Always provide complete <code>MessageMetadata</code>. Since AWorld defaults to using <code>task_id</code> for isolation, missing metadata will lead to \"amnesia\" or \"memory interference\" for the agent.</li> <li>Choosing Isolation Level (History Scope):<ul> <li>Use <code>task</code> (Default): <ul> <li>When tasks are atomized (e.g., translating a paragraph, executing a SQL).</li> <li>To save tokens and prevent history from interfering with current decisions.</li> <li>Executing multiple unrelated sub-tasks in parallel.</li> </ul> </li> <li>Use <code>session</code>:<ul> <li>Interactive dialogues (Chat): Users will refer to history with \"what I just said.\"</li> <li>Complex pipelines: The output of a previous Task is the background for the next (e.g., Search -&gt; Organize -&gt; Write Report).</li> <li>Context maintenance during a single login period.</li> </ul> </li> <li>Use <code>user</code>:<ul> <li>Personalized butler: Needs to remember the user's name, preferences, profession, etc.</li> <li>Long-term project tracking: Continuous support spanning multiple days and logins.</li> <li>Note: The higher the level, the greater the token consumption and retrieval pressure. It is recommended to use this with <code>enable_summary</code>.</li> </ul> </li> </ul> </li> <li>Context Compression and History Transfer Strategy:<ul> <li>Short Context Scenarios: Recommended to share history messages via <code>session</code> level. When session length is controllable, passing original messages maintains the highest interaction fidelity.</li> <li>Long Context Scenarios: <ul> <li>Summary Strategy: Recommended to enable <code>enable_summary</code> to replace old messages with periodic summaries, effectively reducing token consumption while retaining key background.</li> <li>Combining with <code>add_knowledge</code>: For ultra-long information or knowledge that needs persistence, it's recommended to use <code>add_knowledge</code> to distill it into knowledge snippets. Use the pattern of \"Summary for streaming background\" + \"<code>add_knowledge</code> for key details\" to achieve efficient context management.</li> </ul> </li> </ul> </li> </ol> <p>For more technical details, please refer to the source module: <code>aworld.memory</code></p>"},{"location":"Agents/Trace/","title":"Trace","text":""},{"location":"Agents/Trace/#overview","title":"Overview","text":"<p>The AWorld Trace module is a full-featured distributed tracing system built on OpenTelemetry, providing comprehensive observability capabilities for the AWorld framework. It offers flexible tracing configuration, automatic instrumentation, and manual tracing support, with compatibility for multiple backend storage and export options.</p>"},{"location":"Agents/Trace/#core-features","title":"Core Features","text":"<ul> <li>Built on the OpenTelemetry standard, ensuring compatibility with mainstream observability platforms</li> <li>Automatic instrumentation: Tracks key components (Agent, Tool, LLM, etc.) without code modification</li> <li>Manual span creation and management for fine-grained tracing control</li> <li>Built-in in-memory storage and Trace UI Server for quick inspection of trace data</li> <li>Seamless integration with third-party observability platforms (e.g., Logfire, Jaeger)</li> <li>Highly configurable to meet diverse use-case requirements</li> </ul>"},{"location":"Agents/Trace/#main-components","title":"Main Components","text":"<ul> <li><code>**TraceManager**</code>: Core tracing manager responsible for creating and managing spans</li> <li><code>**ContextManager**</code>: Handles propagation of tracing context across components and threads</li> <li><code>**Instrumentation**</code>: Automatically instruments core framework components</li> <li><code>**OpenTelemetryAdapter**</code>: Bridges AWorld\u2019s tracing API with OpenTelemetry\u2019s native APIs</li> <li><code>**TraceServer**</code>: Built-in UI server for visualizing trace data</li> </ul>"},{"location":"Agents/Trace/#quick-start","title":"Quick Start","text":""},{"location":"Agents/Trace/#enabling-tracing-in-aworld","title":"Enabling Tracing in AWorld","text":"<p>To enable tracing, configure <code>ObservabilityConfig</code> at application startup:</p> <pre><code>from aworld.trace.config import configure, ObservabilityConfig\n\n# Configure tracing\nconfig = ObservabilityConfig(\n    trace_provider=\"otlp\",\n    trace_backends=[\"memory\"],        # Use in-memory storage\n    trace_server_enabled=True,        # Enable built-in Trace UI Server\n    trace_server_port=7079            # UI server port\n)\n\n# Apply configuration\nconfigure(config)\n</code></pre>"},{"location":"Agents/Trace/#viewing-traces-via-built-in-ui","title":"Viewing Traces via Built-in UI","text":"<p>Once the Trace UI Server is enabled, access traces at: http://localhost:7079</p> <p>The UI provides:</p> <ul> <li>List of all recorded traces</li> <li>Full call chain visualization for individual traces</li> <li>Detailed span information (attributes, status, duration)</li> <li>Time-based sorting and filtering</li> </ul>"},{"location":"Agents/Trace/#interpreting-trace-ui-data","title":"Interpreting Trace UI Data","text":"<p>During execution, AWorld automatically creates several core span types to track component behavior:</p> <ul> <li>Event Span<ul> <li>Name format: <code>event.&lt;event_type&gt;</code></li> <li>Description: AWorld is event-driven; each event execution is traced as a span prefixed with <code>event.</code> (e.g., <code>event.output</code>).</li> <li>Key attributes:<ul> <li><code>event.topic</code>: Event topic</li> <li><code>event.payload</code>: Event payload</li> <li><code>event.sender</code> / <code>event.receiver</code>: Source and destination</li> </ul> </li> </ul> </li> <li>Task Span<ul> <li>Name format: <code>task.&lt;session_id&gt;</code></li> <li>Description: Represents a complete task execution.</li> <li>Key attributes:<ul> <li><code>task.id</code>, <code>task.input</code>, <code>task.is_sub_task</code></li> </ul> </li> </ul> </li> <li>Agent Span<ul> <li>Name format: <code>agent.&lt;agent_name&gt;</code></li> <li>Description: Traces an agent\u2019s execution lifecycle.</li> <li>Key attributes:<ul> <li><code>agent.name</code>, <code>agent.id</code>, <code>session.id</code>, <code>user.id</code></li> </ul> </li> </ul> </li> <li>Tool Span<ul> <li>Name format: <code>tool.&lt;tool_name&gt;</code> (for MCP tools, <code>&lt;tool_name&gt;</code> = MCP service name)</li> <li>Description: Captures tool execution.</li> <li>Key attributes:<ul> <li><code>tool.name</code>, <code>agent.name</code>, <code>agent.id</code>, <code>session.id</code>, <code>user.id</code></li> </ul> </li> <li>Viewing results: Check child span <code>event.output.tool_call_result</code></li> </ul> </li> <li>LLM Span<ul> <li>Name format: <code>llm.&lt;model_name&gt;</code></li> <li>Description: Records a single LLM invocation.</li> <li>Key attributes:<ul> <li><code>gen_ai.prompt</code>, <code>gen_ai.prompt.tools</code></li> <li><code>gen_ai.request.*</code> (e.g., <code>top_k</code>)</li> <li><code>gen_ai.completion.content</code>, <code>.reasoning_content</code>, <code>.tool_calls</code></li> <li><code>gen_ai.duration</code>, <code>gen_ai.first_token_duration</code></li> <li>Token usage: <code>input_tokens</code>, <code>output_tokens</code>, <code>total_tokens</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"Agents/Trace/#core-concepts","title":"Core Concepts","text":""},{"location":"Agents/Trace/#trace","title":"Trace","text":"<p>A complete call chain composed of multiple spans, representing an end-to-end operation (e.g., one user task). Identified by a unique Trace ID.</p>"},{"location":"Agents/Trace/#span","title":"Span","text":"<p>A single operation unit within a trace, representing a specific execution step. Contains:</p> <ul> <li>Name, start/end time, duration</li> <li>Key-value attributes</li> <li>Status (success/failure)</li> <li>Parent Span ID and list of child spans</li> </ul>"},{"location":"Agents/Trace/#tracecontext","title":"TraceContext","text":"<p>Carries tracing metadata (Trace ID, Span ID, etc.) across services in distributed environments to link related spans.</p>"},{"location":"Agents/Trace/#traceprovider","title":"TraceProvider","text":"<p>Factory for creating <code>Tracer</code> instances. AWorld abstracts tracing implementation, allowing pluggable providers (default: OpenTelemetry).</p>"},{"location":"Agents/Trace/#tracer","title":"Tracer","text":"<p>Component that creates and manages spans in application code.</p>"},{"location":"Agents/Trace/#spanconsumer","title":"SpanConsumer","text":"<p>Processes span data for custom logic\u2014e.g., exporting to backends or generating real-time agent trajectories.</p>"},{"location":"Agents/Trace/#usage-example","title":"Usage Example","text":"<pre><code>from aworld.trace.span_consumer import SpanConsumer, register_span_consumer\nfrom typing import Sequence\n\n@register_span_consumer\nclass MySpanConsumer(SpanConsumer):\n    def consume(self, spans: Sequence[Span]) -&gt; None:\n        for span in spans:\n            print(f\"Span processed: {span.get_name()}\")\n</code></pre>"},{"location":"Agents/Trace/#instrumentation","title":"Instrumentation","text":"<p>Automatic tracing of core components via bytecode enhancement or decorators\u2014no code changes needed. AWorld includes built-in instrumentors (all enabled by default):</p> <ul> <li><code>**EventBusInstrumentor**</code>: Traces event execution and parent-child relationships</li> <li><code>**AgentInstrumentor**</code>: Auto-traces agent runs</li> <li><code>**ToolInstrumentor**</code>: Auto-traces tool executions</li> <li><code>**LLMModelInstrumentor**</code>: Auto-traces LLM calls</li> <li><code>**ThreadingInstrumentor**</code>: Propagates trace context across threads</li> <li>Web Framework Instrumentors:<ul> <li><code>FastAPIInstrumentor</code></li> <li><code>FlaskInstrumentor</code></li> </ul> </li> <li><code>**RequestsInstrumentor**</code>: Traces outbound HTTP calls</li> </ul>"},{"location":"Agents/Trace/#enabling-example-fastapi","title":"Enabling Example (FastAPI)","text":"<pre><code>from aworld.trace.instrumentation.fastapi import FastAPIInstrumentor\n\nFastAPIInstrumentor().instrument()\n</code></pre>"},{"location":"Agents/Trace/#integration-with-third-party-observability-platforms","title":"Integration with Third-Party Observability Platforms","text":"<p>Built on OpenTelemetry and using the OTLP protocol (the de facto standard for trace data), AWorld integrates seamlessly with a wide range of observability platforms.</p>"},{"location":"Agents/Trace/#commercial-platforms","title":"Commercial Platforms","text":""},{"location":"Agents/Trace/#logfire-httpslogfirepydanticdev","title":"Logfire (https://logfire.pydantic.dev)","text":"<ol> <li>Create a project on Logfire and obtain a Write Token</li> <li>Configure AWorld:</li> </ol> <pre><code>from aworld.trace.config import configure, ObservabilityConfig\n\nconfig = ObservabilityConfig(\n    trace_provider=\"otlp\",\n    trace_backends=[\"logfire\"],\n    trace_base_url=\"https://logfire-us.pydantic.dev\",\n    trace_write_token=\"your-logfire-write-token\"\n)\n\nconfigure(config)\n</code></pre>"},{"location":"Agents/Trace/#open-source-platforms","title":"Open-Source Platforms","text":""},{"location":"Agents/Trace/#jaeger-httpswwwjaegertracingio","title":"Jaeger (https://www.jaegertracing.io/)","text":"<p>Deploy Jaeger per official docs, then configure AWorld:</p> <pre><code>config = ObservabilityConfig(\n    trace_provider=\"otlp\",\n    trace_backends=[\"other_otlp\"],\n    trace_base_url=\"http://localhost:4317\",  # Jaeger OTLP endpoint\n    trace_write_token=None\n)\n\nconfigure(config)\n</code></pre>"},{"location":"Agents/Trace/#custom-tracing","title":"Custom Tracing","text":""},{"location":"Agents/Trace/#using-context-manager","title":"Using Context Manager","text":"<pre><code>import aworld.trace as trace\n\nwith trace.span(\"custom_operation\", attributes={\"custom_attr\": \"value\"}):\n    result = perform_custom_operation()\n</code></pre>"},{"location":"Agents/Trace/#decorator-approach","title":"Decorator Approach","text":"<pre><code>@trace.func_span(\"custom_function\", attributes={\"function_type\": \"business\"}, extract_args=True)\ndef custom_function(param1, param2):\n    return result\n# `extract_args=True` logs function arguments as span attributes (default: False)\n</code></pre>"},{"location":"Agents/Trace/#adding-attributes-to-current-span","title":"Adding Attributes to Current Span","text":"<pre><code>current_span = trace.get_current_span()\ncurrent_span.set_attribute(\"custom_key\", \"custom_value\")\n</code></pre>"},{"location":"Agents/Trace/#manual-span-lifecycle","title":"Manual Span Lifecycle","text":"<pre><code>span = trace.span(\"manual_operation\")\ntry:\n    result = perform_operation()\n    span.set_status(\"OK\")\nfinally:\n    span.end()\n</code></pre>"},{"location":"Agents/Trace/#advanced-features","title":"Advanced Features","text":""},{"location":"Agents/Trace/#auto-tracing-configuration","title":"Auto-Tracing Configuration","text":"<p>Automatically trace all function calls in specified modules:</p> <pre><code>trace.auto_tracing(\n    modules=[\"my_module\", \"another_module\"],\n    min_duration=0.1  # Only trace functions taking &gt;100ms\n)\n</code></pre>"},{"location":"Agents/Trace/#trace-namespace-isolation","title":"Trace Namespace Isolation","text":"<p>Isolate traces from different applications using environment variables:</p> <pre><code>os.environ[\"MONITOR_SERVICE_NAME\"] = \"otlp_example\"\n</code></pre>"},{"location":"Agents/Trace/#integration-with-other-trace-propagation-protocols","title":"Integration with Other Trace Propagation Protocols","text":"<p>By default, AWorld uses OpenTelemetry\u2019s W3C TraceContext propagation. To interoperate with systems using other protocols (e.g., Zipkin B3, SOFATracer), implement custom propagators.</p> <p></p>"},{"location":"Agents/Trace/#core-concepts_1","title":"Core Concepts","text":"<ul> <li><code>**Propagator**</code>: Interface for injecting/extracting trace context</li> <li><code>**TraceContext**</code>: Holds <code>trace_id</code>, <code>span_id</code>, flags, etc.</li> <li><code>**Carrier**</code>: Transport medium (e.g., HTTP headers, message headers)</li> </ul>"},{"location":"Agents/Trace/#architecture","title":"Architecture","text":"<p>AWorld uses a <code>**CompositePropagator**</code> to support multiple protocols simultaneously.</p> <p></p>"},{"location":"Agents/Trace/#implementing-a-custom-propagator","title":"Implementing a Custom Propagator","text":"<ol> <li>Subclass <code>**Propagator**</code>:</li> </ol> <pre><code>from aworld.trace.base import Propagator, TraceContext, Carrier\nfrom typing import Optional\n\nclass CustomTracePropagator(Propagator):\n    _CUSTOM_TRACE_ID_HEADER = \"X-Custom-Trace-ID\"\n    _CUSTOM_SPAN_ID_HEADER = \"X-Custom-Span-ID\"\n    _CUSTOM_FLAGS_HEADER = \"X-Custom-Flags\"\n\n    def extract(self, carrier: Carrier) -&gt; Optional[TraceContext]:\n        trace_id = self._get_value(carrier, self._CUSTOM_TRACE_ID_HEADER)\n        span_id = self._get_value(carrier, self._CUSTOM_SPAN_ID_HEADER)\n        flags = self._get_value(carrier, self._CUSTOM_FLAGS_HEADER) or \"01\"\n\n        if not trace_id or not span_id:\n            return None\n\n        return TraceContext(\n            trace_id=trace_id,\n            span_id=span_id,\n            trace_flags=flags,\n            version=\"00\",\n            attributes={\"custom_protocol\": \"v1\"}\n        )\n\n    def inject(self, trace_context: TraceContext, carrier: Carrier) -&gt; None:\n        if not trace_context:\n            return\n        carrier.set(self._CUSTOM_TRACE_ID_HEADER, trace_context.trace_id)\n        carrier.set(self._CUSTOM_SPAN_ID_HEADER, trace_context.span_id)\n        carrier.set(self._CUSTOM_FLAGS_HEADER, trace_context.trace_flags)\n        if \"custom_protocol\" in trace_context.attributes:\n            carrier.set(\"X-Custom-Protocol-Version\", trace_context.attributes[\"custom_protocol\"])\n</code></pre> <ol> <li>Register the Propagator:</li> </ol> <pre><code>from aworld.trace.propagator import get_global_trace_propagator, CompositePropagator\n\nglobal_propagator = get_global_trace_propagator()\npropagators = list(global_propagator._propagators) if isinstance(global_propagator, CompositePropagator) else [global_propagator]\n\npropagators.append(CustomTracePropagator())\nnew_propagator = CompositePropagator(propagators)\n\n# Replace global propagator\nfrom aworld.trace.propagator import _GLOBAL_TRACE_PROPAGATOR\n_GLOBAL_TRACE_PROPAGATOR = new_propagator\n</code></pre> <p>This enables seamless trace context propagation between AWorld and external systems using non-OpenTelemetry protocols.</p>"},{"location":"Agents/Runtime/Custom%20Runner/","title":"Custom Runner","text":"<p>The AWorld framework provides a flexible runtime infrastructure that enables developers to implement arbitrarily complex execution logic without modifying the core framework code. As the heart of the runtime, the Runner is also fully extensible\u2014developers can create entirely custom task executors and engines to meet specific business requirements.</p>"},{"location":"Agents/Runtime/Custom%20Runner/#when-to-implement-a-custom-runner","title":"When to Implement a Custom Runner","text":"<ul> <li>\u2705 You need a specialized execution flow (e.g., parallel execution, conditional branching, loops)</li> <li>\u2705 You require custom error handling and recovery mechanisms</li> <li>\u2705 You must integrate with a specific external system</li> <li>\u2705 You need performance optimization or fine-grained resource control</li> <li>\u2705 You want to implement a custom scheduling policy</li> <li>\u2705 You require fully customized output formatting or monitoring logic</li> </ul>"},{"location":"Agents/Runtime/Custom%20Runner/#when-not-to-implement-a-custom-runner","title":"When Not to Implement a Custom Runner","text":"<ul> <li>\u274c To modify post-processing logic \u2192 Use a Handler</li> <li>\u274c To adjust parameters or inputs \u2192 Use Hooks or Callbacks</li> <li>\u274c To change output format \u2192 Use an OutputProcessHook</li> <li>\u274c To customize trajectory recording \u2192 Extend the TrajectoryStrategy</li> </ul>"},{"location":"Agents/Runtime/Custom%20Runner/#creating-a-custom-runner","title":"Creating a Custom Runner","text":""},{"location":"Agents/Runtime/Custom%20Runner/#for-agent-tasks","title":"For Agent Tasks","text":"<p>It is recommended to base your implementation on <code>**TaskRunner**</code>.</p>"},{"location":"Agents/Runtime/Custom%20Runner/#inherit-from-taskrunner","title":"Inherit from <code>TaskRunner</code>","text":"<p>Override the necessary methods to define your custom execution behavior.</p> <pre><code>from aworld.runners.task_runner import TaskRunner\nfrom aworld.core.task import Task, TaskResponse\nfrom aworld.core.context.base import Context\n\nclass MyCustomRunner(TaskRunner):\n    \"\"\"Custom Runner\"\"\"\n\n    def __init__(self, task: Task, *args, **kwargs):\n        super().__init__(task, *args, **kwargs)\n        # add custom init\n        self.custom_state = {}\n\n    async def pre_run(self):\n        \"\"\"prepare\"\"\"\n        await super().pre_run()\n        # custom logic\n        logger.info(\"Custom runner preparing...\")\n\n    async def do_run(self, context: Context = None) -&gt; TaskResponse:\n        \"\"\"core logic\"\"\"\n        pass\n\n    async def post_run(self):\n        \"\"\"clean\"\"\"\n        await super().post_run()\n        # custom logic\n        logger.info(\"Custom runner cleaning up...\")\n</code></pre>"},{"location":"Agents/Runtime/Custom%20Runner/#customize-the-core-execution-process","title":"Customize the core execution process","text":"<pre><code>async def do_run(self, context: Context = None) -&gt; TaskResponse:\n    \"\"\"Custom response\uff0creturn TaskResponse.\"\"\"\n    observation = self.observation\n\n    try:\n        # 1. execution core logic\n        result = await self._execute_custom_logic(observation)\n\n        # 2. gen response\n        response = TaskResponse(\n            task_id=self.task.id,\n            content=result,\n            status=\"success\"\n        )\n\n        return response\n\n    except Exception as e:\n        logger.error(f\"Execution failed: {e}\")\n        return TaskResponse(\n            task_id=self.task.id,\n            content=str(e),\n            status=\"failed\"\n        )\n\nasync def _execute_custom_logic(self, observation):\n    \"\"\"Custom logic\"\"\"\n    pass\n</code></pre>"},{"location":"Agents/Runtime/Custom%20Runner/#other-types-of-tasks","title":"Other types of tasks","text":""},{"location":"Agents/Runtime/Custom%20Runner/#inheriting-runner","title":"Inheriting Runner","text":"<pre><code>class TreeSearchRunner(Runner):\n    \"\"\"Customization based on tree search runner.\"\"\"\n\n    def __init__(self, task: Task, *args, **kwargs):\n        super().__init__(task, *args, **kwargs)\n        self.max_depth = self.conf.get('max_depth', 3)\n        self.max_breadth = self.conf.get('max_breadth', 3)\n        self.search_tree = {}\n</code></pre>"},{"location":"Agents/Runtime/Custom%20Runner/#execution-core","title":"Execution Core","text":"<pre><code>async def do_run(self, context: Context = None) -&gt; TaskResponse:\n        \"\"\"Perform tree search.\"\"\"\n        observation = self.observation\n\n        # depth search first\n        best_result = await self._dfs(observation, depth=0)\n\n        return TaskResponse(\n            task_id=self.task.id,\n            content=best_result,\n            status=\"success\"\n        )\n\n    async def _dfs(self, state, depth):\n        \"\"\"depth search first\"\"\"\n        if depth &gt;= self.max_depth:\n            return state\n\n        agent = self.swarm.ordered_agents[0]\n        # get action\n        actions = await self._get_possible_actions(agent, state)\n\n        # Exploring the max-breadth actions before exploration\n        best_result = state\n        best_score = self._evaluate(state)\n\n        for action in actions[:self.max_breadth]:\n            # execute action\n            next_state = await self._execute_action(action, state)\n\n            # Recursively searching \n            result = await self._dfs(next_state, depth + 1)\n\n            # Evaluate result\n            score = self._evaluate(result)\n            if score &gt; best_score:\n                best_score = score\n                best_result = result\n\n        return best_result\n\n    async def _get_possible_actions(self, agent, state):\n        \"\"\"Obtain possible actions.\"\"\"\n        obs = Observation(content=str(state))\n        output = await agent.run(obs)\n        return output.get('actions', [])\n\n    async def _execute_action(self, action, state):\n        \"\"\"Execute action.\"\"\"\n        tool = self.tools.get(action['tool'])\n        result = await tool.step(action['args'])\n        return result.get('next_state', state)\n\n    def _evaluate(self, state):\n        \"\"\"Evaluate the status.\"\"\"\n        # custom evaluate process\n        return len(str(state))\n</code></pre>"},{"location":"Agents/Runtime/Custom%20Runner/#best-practices","title":"Best Practices","text":"<p>\u2705 Suggestion: Clear division of responsibilities</p> <p>modular design</p> <pre><code>class WellDesignedRunner(TaskRunner):\n    \"\"\"Clear processes and modules\"\"\"\n\n    async def do_run(self, context):\n        # Only handle the main process\n        return await self._main_execution(context)\n\n    async def _main_execution(self, context):\n        \"\"\"main logic\"\"\"\n        observation = ...\n\n        # 1. pre process\n        processed_obs = await self._preprocess(observation)\n\n        # 2. execute main logic\n        for step in range(self.max_steps):\n            output = await self._execute_step(processed_obs, step)\n            results.append(output)\n\n            if self._should_stop(output):\n                break\n\n            # 3. update observation\n            processed_obs = self._update_observation(processed_obs, output)\n\n        # 4. post process\n        final_result = await self._postprocess(results)\n        ...\n\n    async def _execute_step(self, obs, step):\n        pass\n\n    def _should_stop(self, output):\n        pass\n\n    def _update_observation(self, ob, output):\n        pass\n\n    async def _preprocess(self):\n        pass\n\n    async def _postprocess(self):\n        pass\n</code></pre> <p>\u274c Not recommended: a single method is too large</p> <p>Severe coupling, difficult to measure individually</p> <pre><code>class PoorlyDesignedRunner(TaskRunner):\n    async def do_run(self, context):\n        # All logic is executed inside\n        # ... Hundreds of lines of code ...\n        pass\n</code></pre>"},{"location":"Agents/Runtime/Hooks/","title":"Hooks","text":"<p>Hooks are a runtime lifecycle interception mechanism in the AWorld framework, embodying the Open-Closed Principle (OCP). They allow developers to inject custom logic at critical points during task execution\u2014without modifying the framework\u2019s core code.</p>"},{"location":"Agents/Runtime/Hooks/#why-use-hooks","title":"Why Use Hooks?","text":"<p>In architectures without hooks, extending functionality typically requires modifying framework code directly. With hooks, developers can register callback functions to enhance behavior while keeping the main execution flow untouched. When used properly, hooks enable elegant, non-intrusive extensions that improve code clarity and maintainability.</p> <p>Key benefits include:</p> <ol> <li>Non-intrusive extension \u2013 No need to alter framework internals</li> <li>Clear lifecycle interception \u2013 Logic inserted precisely at well-defined points</li> <li>Flexible composition \u2013 Supports hook chains and conditional execution</li> <li>Powerful observability \u2013 Enables end-to-end event tracking</li> <li>Maintainable code \u2013 Achieves separation of concerns</li> </ol>"},{"location":"Agents/Runtime/Hooks/#core-purposes-of-hooks","title":"Core Purposes of Hooks","text":"<p>Hooks are instrumental in the following scenarios:</p> <ol> <li>Monitoring &amp; Logging \u2013 Record data at key execution points</li> <li>Performance Profiling \u2013 Measure time consumption across stages</li> <li>Data Transformation \u2013 Clean or transform data between phases</li> <li>Business Logic Injection \u2013 Insert domain-specific rules</li> <li>Error Handling &amp; Recovery \u2013 Intervene when failures occur</li> <li>Auditing &amp; Tracing \u2013 Log all critical operations for compliance or debugging</li> </ol>"},{"location":"Agents/Runtime/Hooks/#hook-mechanism","title":"Hook Mechanism","text":""},{"location":"Agents/Runtime/Hooks/#hook-points","title":"Hook Points","text":"<p>Hook points are predefined moments in the task lifecycle where custom logic can be injected. The framework provides a standard set:</p> <pre><code>class HookPoint:\n    START = \"start\"                    # Task starts\n    FINISHED = \"finished\"              # Task completes\n    ERROR = \"error\"                    # Task encounters an error\n    PRE_LLM_CALL = \"pre_llm_call\"      # Before LLM invocation\n    POST_LLM_CALL = \"post_llm_call\"    # After LLM invocation\n    PRE_TOOL_CALL = \"pre_tool_call\"    # Before tool invocation\n    POST_TOOL_CALL = \"post_tool_call\"  # After tool invocation\n    OUTPUT_PROCESS = \"output_process\"  # During output processing\n</code></pre>"},{"location":"Agents/Runtime/Hooks/#hook-the-executable-unit","title":"Hook (The Executable Unit)","text":"<p>A <code>Hook</code> is an executable component triggered at a specific hook point:</p> <pre><code>class Hook(abc.ABC):\n    @abc.abstractmethod\n    def point(self) -&gt; str:\n        \"\"\"Return the hook point this hook belongs to.\"\"\"\n\n    @abc.abstractmethod\n    async def exec(self, message: Message, context: Context = None) -&gt; Message:\n        \"\"\"\n        Execute hook logic.\n\n        Args:\n            message: Current message object\n            context: Execution context\n\n        Returns:\n            Modified (or original) message object\n        \"\"\"\n</code></pre>"},{"location":"Agents/Runtime/Hooks/#hook-chain","title":"Hook Chain","text":"<p>Multiple hooks can be registered at the same hook point and will execute sequentially, forming a processing chain:</p> <pre><code>Incoming Message\n       \u2193\n[Hook1 executes] \u2192 may modify message\n       \u2193\n[Hook2 executes] \u2192 may further modify message\n       \u2193\n[Hook3 executes] \u2192 may modify again\n       \u2193\nOutgoing Message\n</code></pre>"},{"location":"Agents/Runtime/Hooks/#hook-registration","title":"Hook Registration","text":"<p>Hooks can be auto-registered via the <code>HookFactory</code> using decorators:</p> <pre><code>@HookFactory.register(name=\"PreLLMCallContextProcessHook\", desc=\"Processes context before LLM call\")\nclass PreLLMCallContextProcessHook(PreLLMCallHook):\n    def name(self):\n        return convert_to_snake(\"PreLLMCallContextProcessHook\")\n\n    async def exec(self, message: Message, context: Context = None) -&gt; Message:\n        # Custom logic here\n        pass\n</code></pre>"},{"location":"Agents/Runtime/Hooks/#hook-execution","title":"Hook Execution","text":"<p>The framework executes all hooks at a given point via an async generator:</p> <pre><code>async def run_hooks(self, message: Message, hook_point: str) -&gt; AsyncGenerator[Message, None]:\n    \"\"\"Execute all hooks registered at the specified hook point.\"\"\"\n    if not self.hooks:\n        return\n\n    hooks = self.hooks.get(hook_point, [])\n    for hook in hooks:\n        try:\n            msg = await hook.exec(message)\n            if msg:\n                yield msg\n        except Exception as e:\n            logger.error(f\"Hook execution failed: {e}\")\n</code></pre>"},{"location":"Agents/Runtime/Hooks/#custom-hooks-examples","title":"Custom Hooks Examples","text":"<p>By leveraging hooks, developers can build highly extensible, observable, and maintainable agent systems\u2014while keeping business logic cleanly decoupled from the framework\u2019s execution engine.</p> <pre><code>from aworld.runners.hook.hooks import StartHook, FinishedHook\n\nclass MonitoringStartHook(StartHook):\n    \"\"\"Clear naming and documentation.\n\n    Logs task startup details for monitoring.\n    \"\"\"\n    async def exec(self, message, context):\n        task = context.get_task()\n        print(f\"\u2713 Task started: {task.id}\")\n        print(f\"  Input: {task.input}\")\n        return message\n\nclass MonitoringFinishedHook(FinishedHook):\n    \"\"\"Robust error handling in hooks.\"\"\"\n    async def exec(self, message, context):\n        try:\n            task = context.get_task()\n            print(f\"\u2713 Task finished: {task.id}\")\n            print(f\"  Result: {message.payload}\")\n        except Exception:\n            pass  # Avoid hook failures breaking main flow\n        return message\n\n# Usage\ntask = Task(name=\"test\", input=\"What is AI?\", agent=agent)\nrunner = TaskEventRunner(task)\n\nrunner.hooks = {\n    HookPoint.START: [MonitoringStartHook()],\n    HookPoint.FINISHED: [MonitoringFinishedHook()]\n}\n\nresponse = await runner.run()\n</code></pre>"},{"location":"Agents/Runtime/Overview/","title":"Overview","text":"<p>AWorld runtime is a general-purpose, flexible, distributed execution framework built on top of pluggable compute engines. It provides a complete agent-oriented implementation and includes the following key capabilities:</p> <ol> <li>Full Lifecycle Management \u2014 Clear phases for initialization, execution, and cleanup</li> <li>Flexible Execution Modes \u2014 Event-driven, call-driven, or custom execution logic to support arbitrarily complex orchestration</li> <li>Unified Multi-Engine Support \u2014 Compatible with multiple compute backends including local, Spark, and Ray</li> <li>Convenient Distributed Execution \u2014 Configuration-based support for distributed task execution and state synchronization</li> <li>Comprehensive Observability \u2014 Built-in tracing, logging, event states, and trajectory recording</li> <li>Holistic Context Management \u2014 Full state tracking at the session, task, and agent levels</li> <li>Powerful Extensibility \u2014 Customizable handlers, callbacks, and hooks across multiple dimensions</li> <li>Robust Error Handling \u2014 Supports mechanisms such as retries and recovery</li> </ol>"},{"location":"Agents/Runtime/Overview/#runtime-architecture","title":"Runtime Architecture","text":""},{"location":"Agents/Runtime/Overview/#framework","title":"Framework","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    AWorld Runtime Framework                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502               Runner Layer                              \u2502   \u2502\n\u2502  \u2502      (XRunner / Handler / Callback / Hooks )            \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                     \u2502                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  \u2502    Context  Layer                   \u2502                       \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502                       \u2502\n\u2502  \u2502  \u2502   Session    \u2502  \u2502   Context    \u2502 \u2502                       \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502                       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                     \u2502                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  \u2502   Event Management Layer            \u2502                       \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502                       \u2502\n\u2502  \u2502  \u2502  EventBus    \u2502  \u2502  EventManager\u2502 \u2502                       \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502                       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                     \u2502                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  \u2502    Compute Engine Layer             \u2502                       \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2510  \u2502                       \u2502\n\u2502  \u2502  \u2502  Local   \u2502 \u2502  Spark   \u2502 \u2502 Ray \u2502  \u2502                       \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518  \u2502                       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                     \u2502                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  \u2502      Multi-Agent / Sandbox          \u2502                       \u2502\n\u2502  \u2502  (Tools, Agents, Storage)           \u2502                       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                                                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"Agents/Runtime/Overview/#key-point","title":"Key Point","text":"<p>The core execution flow integrates all components\u2014agents, tools, context, memory, and human interaction\u2014into a cohesive, observable, and controllable pipeline.</p> <pre><code>Create task\n   \u2193\n[Init Runner]\n   \u251c\u2500 pre_run()        : Verify, Load, Context\n   \u2502\n[Execution]\n   \u251c\u2500 do_run()         \n   \u2502   \u251c\u2500 Event/Call\n   \u2502   \u251c\u2500 Sync/Async\n   \u2502   \u251c\u2500 Trace\n   \u2502   \u2514\u2500 ErrorProcess\n   \u2502   \u2514\u2500 Trajectory\n   \u2502\n[Post process]\n   \u2514\u2500 post_run()       : release, notify\n   \u2193\nTask response\n</code></pre>"},{"location":"Agents/Runtime/Overview/#core-components","title":"Core Components","text":""},{"location":"Agents/Runtime/Overview/#task-task-definition","title":"Task \u2013 Task Definition","text":"<p><code>Task</code> is one of the three fundamental executable concepts in AWorld (with <code>Agent</code> and <code>Tool</code>). It encapsulates all information required to execute a task, typically including: input data, the agent(s) involved, required tools, contextual dependencies, and execution mode. See a concrete implementation of the <code>Task</code> structure for details.</p> <pre><code>from aworld.core.task import Task\nfrom aworld.core.common import StreamingMode\n\n# example of task\ntask = Task(\n    name=\"complex_task\",\n    input=user_input,\n    swarm=multi_agent,\n    conf={\n        \"max_steps\": 20,\n        \"run_mode\": \"interactive\",\n        \"check_input\": True\n    },\n    hooks={\n        \"start\": [\"init_logging\", \"init_context\"],\n        \"error\": [\"handle_error\", \"send_alert\"]\n    },\n    streaming_mode=StreamingMode.CORE\n)\n</code></pre>"},{"location":"Agents/Runtime/Overview/#runner-task-executor","title":"Runner \u2013 Task Executor","text":"<p>The <code>Runner</code> is the concrete executor of a <code>Task</code> and serves as the heart of the runtime. Each major task category\u2014such as agent execution, evaluation, data generation, or training\u2014has a dedicated <code>Runner</code> responsible for managing its full lifecycle and workflow.</p> <p>For example, in agent tasks, an event-driven Runner manages the entire event loop: receiving and emitting events, orchestrating the execution flow, and linking upstream and downstream components via events.</p> <pre><code>async def do_run(self):\n    # send init msg\n    await self.event_mng.emit_message(msg)\n    # core process\n    await self._do_run()\n    # gen trajectory\n    await self._save_trajectories()\n    # build response\n    resp = self._response()\n</code></pre>"},{"location":"Agents/Runtime/Overview/#runtimeengine-compute-engine","title":"RuntimeEngine \u2013 Compute Engine","text":"<p><code>RuntimeEngine</code> abstracts underlying compute backends (local, Ray, Spark, etc.) behind a unified interface, enabling tasks to run seamlessly on any specified engine\u2014including in distributed mode. It hides the complexity of distributed computing, allowing developers to focus on business logic rather than infrastructure. New capabilities of engine can be added through extension.</p> <pre><code>class RuntimeEngine(object):\n\n    ...\n\n    async def execute(self, funcs: List[Callable], *args, **kwargs):\n        pass\n\n    # gather as extend\n    async def agather(self):\n        pass\n\n    ...\n</code></pre>"},{"location":"Agents/Runtime/Overview/#eventbus-event-communication","title":"EventBus \u2013 Event Communication","text":"<p>The <code>EventBus</code> is the core messaging infrastructure in AWorld, enabling communication between system components via a publish-subscribe model with asynchronous message passing. This decouples components and enhances scalability and concurrency. Agents, Tools, and other modules communicate loosely through the EventBus. Currently supports two implementations: in-memory and Redis.</p> <pre><code>async def publish(self, messages: Message, **kwargs):\n    \"\"\"publish msg.\"\"\"\n\nasync def consume(self, message: Message, **kwargs):\n    \"\"\"consume msg.\"\"\"\n</code></pre>"},{"location":"Agents/Runtime/Overview/#eventmanager-event-orchestration","title":"EventManager \u2013 Event Orchestration","text":"<p>As the central coordinator of the event system, <code>EventManager</code> manages the full lifecycle of events\u2014including registration, dispatching, and storage. It maintains a registry of event handlers, provides subscription interfaces, and supports event persistence, enabling replay and audit capabilities for full traceability of system state.</p> <pre><code>async def emit_message(self, event: Message):\n    # store msg\n    await self.store.create_data(Data(block_id=event.context.get_task().id, value=event, id=event.id))\n    # publish msg\n    await self.event_bus.publish(event)\n    # for streaming\n    await self._handle_streaming(event)\n\nasync def messages_by_task_id(self, task_id: str):\n    # get messages by special task id\n</code></pre>"},{"location":"Agents/Runtime/Overview/#handler-event-processor","title":"Handler \u2013 Event Processor","text":"<p>A <code>Handler</code> is the execution unit that processes events delivered via the EventBus. Different handlers specialize in specific event types\u2014for example, <code>AgentHandler</code> for agent-related events, <code>ToolHandler</code> for tool invocations. Handlers implement standardized interfaces to ensure proper processing and support chaining and asynchronous execution.</p>"},{"location":"Agents/Runtime/Overview/#callback-asynchronous-result-handling","title":"Callback \u2013 Asynchronous Result Handling","text":"<p>The <code>Callback</code> mechanism handles results from asynchronous operations\u2014especially after tool execution or long-running tasks. Tightly integrated with state management, it ensures accurate tracking and handling of completion status, preventing state inconsistencies caused by async operations.</p>"},{"location":"Agents/Runtime/Overview/#hooks-extensibility-injection-points","title":"Hooks \u2013 Extensibility Injection Points","text":"<p><code>Hooks</code> provide powerful extensibility by allowing custom logic to be injected at key points in the task execution flow (e.g., before/after LLM calls, before/after tool execution, at task start/end). Developers can implement logging, input/output transformation, permission checks, etc., without modifying core code.</p>"},{"location":"Agents/Runtime/Overview/#statemanager-state-tracking","title":"StateManager \u2013 State Tracking","text":"<p>The <code>StateManager</code> tracks and manages all runtime state\u2014including execution status, results, and errors\u2014using structured data models like <code>RunNode</code> and <code>NodeGroup</code>. It enables hierarchical state organization, dependency coordination via waiting mechanisms, and correct execution of complex workflows.</p>"},{"location":"Agents/Runtime/Overview/#event-driven-agent-runtime","title":"Event-Driven Agent Runtime","text":"<p>AWorld implements a complete event-driven runtime specifically for agents. </p> <p></p> <p>This runtime fully integrates all behaviors, modules, and capabilities\u2014including context updates, trajectory construction, and human-in-the-loop interactions\u2014into a single, coherent execution flow.</p> <p>To simplify runner invocation, the framework provides a utility class called <code>**Runners**</code>, which offers a standardized, tool-like interface for executing various types of tasks on demand.</p> <pre><code>from aworld.runners import Runners\n\n# run an Agent or Multi-Agent (Swarm)\nRunners.run(...)\n# run one or multiple tasks\nRunners.run_task(...)\n\n# streaming response of running an Agent or Multi-Agent (Swarm)\nRunners.streaming_run(...)\n# streaming response of running a Task\nRunners.streaming_run_task(...)\n</code></pre>"},{"location":"Deployment/OceanBase/","title":"OceanBase Deployment Guide","text":"<p>This guide explains how to deploy OceanBase Database (Community Edition) for use with AWorld. OceanBase is a distributed SQL database that offers high availability and scalability, compatible with MySQL protocol.</p>"},{"location":"Deployment/OceanBase/#prerequisites","title":"Prerequisites","text":"<ul> <li>Docker: Ensure Docker is installed and running.</li> <li>Resources: Recommended at least 4 CPU cores and 8GB RAM for the container.</li> <li>Python 3.11+</li> <li>PyMySQL or mysql-connector-python</li> </ul>"},{"location":"Deployment/OceanBase/#1-deploy-with-docker","title":"1. Deploy with Docker","text":"<p>The fastest way to get started is using the official standalone Docker image.</p> <p>Run the following command to start a mini standalone instance:</p> <pre><code># Pull the OceanBase CE image\ndocker pull oceanbase/oceanbase-ce:latest\n\n# Run OceanBase container\ndocker run -p 2881:2881 --name oceanbase-ce -e MODE=mini -e OB_root_PASSWORD=root_password -d oceanbase/oceanbase-ce:latest\n</code></pre> <ul> <li><code>MODE=mini</code>: Optimized for low-resource development environments.</li> <li><code>-p 2881:2881</code>: Maps the SQL port.</li> </ul>"},{"location":"Deployment/OceanBase/#verify-connection","title":"Verify Connection","text":"<p>Wait for the initialization to complete (typically 2-5 minutes).  Connect using the MySQL client:</p> <pre><code># Connect to OceanBase\nmysql -h127.0.0.1 -P2881 -uroot@sys\n</code></pre> <p>Default connection parameters: - Host: <code>127.0.0.1</code> - Port: <code>2881</code> - User: <code>root@sys</code> - Password: (empty)</p> <p>You can check the status with:</p> <pre><code>docker logs -f oceanbase-ce\n</code></pre> <p>Look for the message <code>boot success!</code>.</p>"},{"location":"Deployment/OceanBase/#2-database-initialization","title":"2. Database Initialization","text":"<p>Once the container is running, you need to create a database for AWorld.</p> <p>Connect to the instance using a MySQL client:</p> <pre><code># Connect using the root user (default tenant is usually 'test' or 'sys' depending on version, try root@test)\nmysql -h127.0.0.1 -P2881 -uroot@test -proot_password\n</code></pre> <p>Create the database and schema:</p> <pre><code>CREATE DATABASE IF NOT EXISTS aworld_db;\nUSE aworld_db;\n\n-- (Optional) If AWorld requires specific tables, apply them here.\n-- Example:\n-- CREATE TABLE IF NOT EXISTS test_table (id INT PRIMARY KEY, name VARCHAR(255));\n</code></pre>"},{"location":"Deployment/OceanBase/#verify-tables","title":"Verify Tables","text":"<pre><code>-- List created tables\nSHOW TABLES;\n\n-- Describe the test table\nDESCRIBE test_table;\n</code></pre>"},{"location":"Deployment/OceanBase/#3-integration-with-aworld","title":"3. Integration with AWorld","text":"<p>Configure AWorld to use OceanBase as its storage backend. Update your configuration file (e.g., <code>config.yaml</code> or <code>.env</code>) with the following parameters:</p> <pre><code>database:\n  type: oceanbase\n  host: 127.0.0.1\n  port: 2881\n  user: root@test\n  password: root_password\n  database: aworld_db\n</code></pre> <p>Update your python code to use OceanBase: <pre><code># config.py or environment variables\nDATABASE_CONFIG = {\n    \"host\": \"127.0.0.1\",\n    \"port\": 2881,\n    \"user\": \"root@sys\",\n    \"password\": \"\",\n    \"database\": \"aworld_db\",\n}\n</code></pre></p> <p>Note: OceanBase usernames often follow the format <code>user@tenant</code>. For the standalone Docker image, the default tenant is usually <code>test</code>.</p>"},{"location":"Deployment/OceanBase/#4-verification-script","title":"4. Verification Script","text":"<p>You can verify the connectivity and compatibility using the following Python script:</p> <pre><code>import pymysql\nimport sys\n\ndef verify_connection():\n    config = {\n        'host': '127.0.0.1',\n        'port': 2881,\n        'user': 'root@test',\n        'password': 'root_password',\n        'database': 'aworld_db',\n        'charset': 'utf8mb4',\n        'cursorclass': pymysql.cursors.DictCursor\n    }\n\n    try:\n        print(f\"Connecting to OceanBase at {config['host']}:{config['port']}...\")\n        connection = pymysql.connect(**config)\n\n        with connection.cursor() as cursor:\n            # Check version\n            cursor.execute(\"SELECT VERSION()\")\n            version = cursor.fetchone()\n            print(f\"\u2705 Connection successful! Server Version: {version['VERSION()']}\")\n\n            # Create a test table\n            cursor.execute(\"CREATE TABLE IF NOT EXISTS ob_connectivity_test (id INT PRIMARY KEY, msg VARCHAR(50))\")\n            cursor.execute(\"INSERT INTO ob_connectivity_test VALUES (1, 'Hello OceanBase') ON DUPLICATE KEY UPDATE msg='Hello OceanBase'\")\n            connection.commit()\n            print(\"\u2705 Write test successful!\")\n\n            # Read back\n            cursor.execute(\"SELECT * FROM ob_connectivity_test WHERE id=1\")\n            result = cursor.fetchone()\n            print(f\"\u2705 Read test successful! Data: {result}\")\n\n            # Cleanup\n            cursor.execute(\"DROP TABLE ob_connectivity_test\")\n            connection.commit()\n\n    except Exception as e:\n        print(f\"\u274c Connection failed: {e}\")\n        sys.exit(1)\n    finally:\n        if 'connection' in locals() and connection.open:\n            connection.close()\n\nif __name__ == \"__main__\":\n    verify_connection()\n</code></pre>"},{"location":"Deployment/OceanBase/#5-troubleshooting","title":"5. Troubleshooting","text":"<ul> <li>Connection Refused: Ensure the Docker container is running (<code>docker ps</code>) and port 2881 is mapped correctly.</li> <li>Authentication Failed: Double-check the tenant name in the username (<code>root@test</code> vs <code>root</code>). The standalone image default is often <code>test</code>.</li> <li>Resource Issues: If the container exits unexpectedly, check if Docker has enough memory allocated (minimum 6GB recommended for stability).</li> <li>Table Creation Fails: Verify the database exists: <code>SHOW DATABASES</code>, Use the correct database: <code>USE aworld_db</code></li> </ul>"},{"location":"Deployment/OceanBase/#related-documentation","title":"Related Documentation","text":"<ul> <li>OceanBase Documentation</li> </ul>"},{"location":"Environment/Advanced%20Capabilities/","title":"Advanced Capabilities","text":""},{"location":"Environment/Advanced%20Capabilities/#introduction","title":"Introduction","text":"<p>This document introduces the advanced capabilities of Environment, including registry integration, streaming response, environment context, Agent runtime support, tool management, and more. These features help you better manage and extend Environment capabilities.</p> <p>If you are new to Environment, we recommend reading the Env Client document first to understand basic usage.</p>"},{"location":"Environment/Advanced%20Capabilities/#registry-integration","title":"Registry Integration","text":""},{"location":"Environment/Advanced%20Capabilities/#local-registry","title":"Local Registry","text":"<pre><code># Use a local JSON file as the registry (Builder pattern)\nsandbox = Sandbox().tools([\"tool1\", \"tool2\"]).registry_url(\"~/workspace/registry.json\").build()\n\n# Registry file format\n{\n    \"tool:server_name\": {\n        \"entity_type\": \"tool\",\n        \"name\": \"server_name\",\n        \"description\": \"Server description\",\n        \"tools\": [\n            {\n                \"name\": \"tool_name\",\n                \"description\": \"Tool description\"\n            }\n        ],\n        \"data\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://...\",\n            \"headers\": {...}\n        }\n    }\n}\n</code></pre>"},{"location":"Environment/Advanced%20Capabilities/#remote-registry","title":"Remote Registry","text":"<pre><code># Use a remote registry (Builder pattern)\nsandbox = Sandbox().tools([\"tool1\", \"tool2\"]).registry_url(\"https://registry.example.com\").build()\n\n# Registry API\n# POST /api/v1/registry/search\n{\n    \"entity_type\": \"tool\",\n    \"status\": \"active\",\n    \"tools\": [\"tool1\", \"tool2\"]  # Optional\n}\n</code></pre>"},{"location":"Environment/Advanced%20Capabilities/#streaming-response","title":"Streaming Response","text":"<p>The streaming response feature supports real-time return of tool results, including progress callbacks. This is useful for long-running tools.</p> <pre><code># Enable streaming (Builder pattern)\nsandbox = Sandbox().mcp_config({...}).streaming(True).build()\n\n# During tool calls, progress messages are automatically sent to the event bus\nresult = await sandbox.call_tool(action_list=[{\n    \"tool_name\": \"server_name\",\n    \"action_name\": \"long_running_tool\",\n    \"params\": {}\n}])\n\n# Progress message format\n# Message(\n#     category=Constants.OUTPUT,\n#     payload=Output(data=\"Progress information\"),\n#     sender=\"server_name__tool_name\"\n# )\n</code></pre>"},{"location":"Environment/Advanced%20Capabilities/#environment-context-capability","title":"Environment Context Capability","text":"<p>The environment context feature allows you to define context parameters that are automatically injected into tool calls. This is useful for passing user information, environment configuration, etc.</p> <pre><code># Set environment context (Builder pattern)\nsandbox = Sandbox().mcp_config({...}).env_content({\n    \"user_id\": \"user123\",\n    \"workspace\": \"/path/to/workspace\",\n    \"custom_config\": {\"key\": \"value\"}\n}).env_content_name(\"env_content\").build()  # env_content_name is optional, defaults to \"env_content\"\n\n# When calling tools, env_content parameter is automatically injected\n# task_id, session_id, agent_id, etc. are also added dynamically\nresult = await sandbox.call_tool(\n    action_list=[{\n        \"tool_name\": \"server_name\",\n        \"action_name\": \"tool_name\",\n        \"params\": {\n            # env_content is automatically injected, no need to pass manually\n            # Final parameters will include:\n            # {\n            #     \"user_id\": \"user123\",\n            #     \"workspace\": \"/path/to/workspace\",\n            #     \"custom_config\": {\"key\": \"value\"},\n            #     \"task_id\": \"...\",  # Automatically added from context\n            #     \"session_id\": \"...\",  # Automatically added from context\n            #     \"agent_id\": \"...\"  # Automatically added from event_message\n            # }\n        }\n    }],\n    context=context  # Pass context to automatically add task_id and session_id\n)\n</code></pre> <p>How it works: 1. Environment context parameters are hidden in tool schemas (LLM cannot see them) 2. User-defined values are automatically injected during tool calls 3. Dynamic context information like <code>task_id</code>, <code>session_id</code>, <code>agent_id</code> is added automatically 4. If user manually provides parameter values, user values take priority</p>"},{"location":"Environment/Advanced%20Capabilities/#agent-runtime-support","title":"Agent Runtime Support","text":"<p>Support for configuring Agents to run in Environment, allowing Agents to be called as tools by other Agents.</p>"},{"location":"Environment/Advanced%20Capabilities/#local-agents","title":"Local Agents","text":"<pre><code># Simple format: Directly specify agent directory path (Builder pattern)\nsandbox = Sandbox().mcp_config({...}).agents({\n    \"local_agent\": \"/path/to/agents\"  # Agent directory path\n}).build()\n\n# Extended format: Provide more configuration options (Builder pattern)\nsandbox = Sandbox().mcp_config({...}).agents({\n    \"advanced_agent\": {\n        \"location\": \"/path/to/agents\",\n        \"run_mode\": \"local\",  # Optional: \"local\" or \"remote\", default is \"local\"\n        \"env\": {\"KEY\": \"value\"},  # Optional: Environment variables\n        \"cwd\": \"/path/to/workdir\",  # Optional: Working directory\n        \"headers\": {\n            \"SANDBOX_ENV\": '{\"key\": \"value\"}'  # Optional: Pass env vars through headers (JSON string)\n        }\n    }\n}).build()\n\n# Using chain Builder API to configure agents\nsandbox = (Sandbox()\n    .mcp_config({...})\n    .agents()\n    .advanced_agent()\n    .location(\"/path/to/agents\")\n    .run_mode(\"local\")\n    .env({\"KEY\": \"value\"})\n    .build()\n)\n</code></pre>"},{"location":"Environment/Advanced%20Capabilities/#remote-agents","title":"Remote Agents","text":"<pre><code>import os\n\n# Set environment variables (required for remote agents)\nos.environ[\"CUSTOM_ENV_URL\"] = \"https://custom.example.com\"\nos.environ[\"CUSTOM_ENV_TOKEN\"] = \"your_token\"\nos.environ[\"CUSTOM_ENV_IMAGE_VERSION\"] = \"v1.0.0\"\n\n# Simple format: Directly specify remote URL (Builder pattern)\nsandbox = Sandbox().mcp_config({...}).agents({\n    \"remote_agent\": \"https://github.com/user/repo.git\"  # Git repository URL\n}).build()\n\n# Extended format: Provide more configuration options (Builder pattern)\nsandbox = Sandbox().mcp_config({...}).agents({\n    \"remote_agent\": {\n        \"location\": \"https://github.com/user/repo.git\",\n        \"run_mode\": \"remote\",  # Explicitly specify remote mode\n        \"repo_url\": \"https://github.com/user/repo.git\",  # Optional: If location is not a URL\n        \"project_path\": \"subdir\",  # Optional: Project subdirectory\n        \"env\": {\"KEY\": \"value\"},  # Optional: Environment variables\n        \"headers\": {\"Custom-Header\": \"value\"}  # Optional: Custom HTTP headers\n    }\n}).build()\n</code></pre> <p>Notes: - Local agents use the <code>aworld-cli serve --mcp --agent-dir</code> command to start - Remote agents require <code>CUSTOM_ENV_URL</code>, <code>CUSTOM_ENV_TOKEN</code>, and <code>CUSTOM_ENV_IMAGE_VERSION</code> environment variables - Agent configurations are automatically converted to MCP server configurations and merged into <code>mcp_config</code></p>"},{"location":"Environment/Advanced%20Capabilities/#custom-environment-tools","title":"Custom Environment Tools","text":"<pre><code>import os\n\n# Set environment variables\nos.environ[\"CUSTOM_ENV_URL\"] = \"https://custom.example.com\"\nos.environ[\"CUSTOM_ENV_TOKEN\"] = \"your_token\"\nos.environ[\"CUSTOM_ENV_IMAGE_VERSION\"] = \"v1.0.0\"\n\n# Use custom environment tools (Builder pattern)\nsandbox = Sandbox().custom_env_tools({\n    \"custom_server\": {\n        \"type\": \"streamable-http\",\n        \"url\": \"...\",\n        \"headers\": {...}\n    }\n}).build()\n</code></pre>"},{"location":"Environment/Advanced%20Capabilities/#blacklisted-tools","title":"Blacklisted Tools","text":"<pre><code># Disable specific tools (Builder pattern)\nsandbox = Sandbox().mcp_config({\n    \"mcpServers\": {\n        \"server_name\": {...}\n    }\n}).black_tool_actions({\n    \"server_name\": [\"tool1\", \"tool2\"]  # Disable these tools\n}).build()\n</code></pre>"},{"location":"Environment/Advanced%20Capabilities/#skill-configuration","title":"Skill Configuration","text":"<pre><code># Configure skill system (Builder pattern)\nsandbox = Sandbox().mcp_config({\n    \"mcpServers\": {\n        \"server_name\": {...}\n    }\n}).skill_configs({\n    \"skill1\": {\n        \"tools\": [\"tool1\", \"tool2\"],\n        \"description\": \"Skill description\"\n    }\n}).build()\n</code></pre>"},{"location":"Environment/Advanced%20Capabilities/#tool-registration","title":"Tool Registration","text":""},{"location":"Environment/Advanced%20Capabilities/#registering-to-remote-registry","title":"Registering to Remote Registry","text":"<pre><code>from aworld.sandbox import Sandbox\n\nresult = await Sandbox.register(\n    registry_url=\"https://registry.example.com\",\n    name=\"my-server\",\n    version=\"1.0.0\",\n    description=\"My server description\",\n    data={\n        \"type\": \"streamable-http\",\n        \"url\": \"https://...\",\n        \"headers\": {...}\n    },\n    tools=[\n        {\n            \"name\": \"tool_name\",\n            \"description\": \"Tool description\"\n        }\n    ],\n    token=\"your_registry_token\"\n)\n\n# Return result\n# {\n#     \"success\": True,\n#     \"entity_id\": \"...\",\n#     \"message\": \"Successfully registered my-server\"\n# }\n</code></pre>"},{"location":"Environment/Advanced%20Capabilities/#registering-to-local-file","title":"Registering to Local File","text":"<pre><code>result = await Sandbox.register(\n    registry_url=\"~/workspace/registry.json\",\n    servers={\n        \"mcpServers\": {\n            \"server_name\": {\n                \"type\": \"streamable-http\",\n                \"url\": \"https://...\",\n                \"headers\": {...}\n            }\n        }\n    }\n)\n\n# Return result\n# {\n#     \"success\": True,\n#     \"file_path\": \"/path/to/registry.json\",\n#     \"message\": \"Successfully registered 1 server(s) to local file\",\n#     \"registered_count\": 1\n# }\n</code></pre>"},{"location":"Environment/Env%20Client/","title":"Env Client","text":"<p>This document introduces how to use the Environment client (Sandbox) to create and manage Environment instances, and perform basic tool operations. If you are not familiar with the basic concepts of Environment, we recommend reading the Overview document first.</p>"},{"location":"Environment/Env%20Client/#core-concepts","title":"Core Concepts","text":""},{"location":"Environment/Env%20Client/#environment","title":"Environment","text":"<p>Environment is a core concept in the AWorld framework, representing a tool execution environment. Environment provides the infrastructure for tool execution, with each Environment instance managing a group of MCP servers and providing a unified tool access interface for agents.</p>"},{"location":"Environment/Env%20Client/#sandbox-client-implementation-of-environment","title":"Sandbox (Client Implementation of Environment)","text":"<p><code>Sandbox</code> is a client implementation class of Environment. In code, you create and use Environment instances through the <code>Sandbox</code> class:</p> <pre><code>from aworld.sandbox import Sandbox\n\n# Sandbox is a client implementation of Environment\nsandbox = Sandbox(mcp_config={...})\n</code></pre> <p>Although the code uses the <code>Sandbox</code> class, conceptually, you are creating an Environment instance. <code>Sandbox</code> provides a concrete implementation of the Environment interface, including:</p> <ul> <li>MCP server connection management</li> <li>Tool discovery and invocation</li> <li>Resource cleanup and other functions</li> </ul>"},{"location":"Environment/Env%20Client/#mcp-servers","title":"MCP Servers","text":"<p>MCP (Model Context Protocol) servers provide tool services. The following types are supported:</p> <ul> <li>stdio: Standard input/output (local processes)</li> <li>sse: Server-Sent Events (HTTP SSE)</li> <li>streamable-http: Streaming HTTP (supports progress callbacks)</li> <li>api: RESTful API (simple HTTP calls)</li> <li>function_tool: Python function tools</li> </ul>"},{"location":"Environment/Env%20Client/#tools","title":"Tools","text":"<p>Tools are executable functions provided by MCP servers. Tool naming format: <code>server_name__tool_name</code></p> <p>Example: <code>gaia-mcp__doc_txt__list_supported_formats_for_txt</code></p>"},{"location":"Environment/Env%20Client/#basic-operations","title":"Basic Operations","text":""},{"location":"Environment/Env%20Client/#creating-an-environment","title":"Creating an Environment","text":"<p>In AWorld, you create Environment instances through the <code>Sandbox</code> class (Environment's client implementation). Builder pattern is recommended:</p> <pre><code>from aworld.sandbox import Sandbox\n\n# Method 1: Using mcp_config (Builder pattern)\nsandbox = Sandbox().mcp_config({\n    \"mcpServers\": {\n        \"server1\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://...\",\n            \"headers\": {...}\n        }\n    }\n}).build()\n\n# Method 2: Specify server names (Builder pattern)\nsandbox = Sandbox().mcp_servers([\"server1\", \"server2\"]).mcp_config({\n    \"mcpServers\": {\n        \"server1\": {...},\n        \"server2\": {...}\n    }\n}).build()\n\n# Method 3: Using tool names (lookup from registry, Builder pattern)\nsandbox = Sandbox().tools([\"tool1\", \"tool2\"]).registry_url(\"https://registry.example.com\").build()\n\n# Method 4: Specify sandbox_id (Builder pattern)\nsandbox = Sandbox().sandbox_id(\"my-sandbox-id\").mcp_config({\n    \"mcpServers\": {\n        \"server_name\": {...}\n    }\n}).build()\n\n# Method 5: Chain multiple options (Builder pattern)\nsandbox = (Sandbox()\n    .mcp_config({...})\n    .streaming(True)  # Enable streaming, see Advanced Capabilities\n    .env_content({\"user_id\": \"user123\"})  # Configure environment context, see Advanced Capabilities\n    .agents({\"my_agent\": \"/path/to/agents\"})  # Configure agents, see Advanced Capabilities\n    .build()\n)\n\n# Note: Direct constructor is also supported (backward compatible)\nsandbox = Sandbox(mcp_config={...})\n</code></pre>"},{"location":"Environment/Env%20Client/#listing-tools","title":"Listing Tools","text":"<pre><code># Get all available tools\ntools = await sandbox.list_tools()\n\n# Tool format example\n[\n    {\n        \"type\": \"function\",\n        \"function\": {\n            \"name\": \"server_name__tool_name\",\n            \"description\": \"Tool description\",\n            \"parameters\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"param1\": {\n                        \"type\": \"string\",\n                        \"description\": \"Parameter description\"\n                    }\n                },\n                \"required\": [\"param1\"]\n            }\n        }\n    }\n]\n</code></pre>"},{"location":"Environment/Env%20Client/#calling-tools","title":"Calling Tools","text":"<pre><code># Single tool call\nresult = await sandbox.call_tool(action_list=[{\n    \"tool_name\": \"server_name\",\n    \"action_name\": \"tool_name\",\n    \"params\": {\n        \"param1\": \"value1\"\n    }\n}])\n\n# Multiple tool calls (parallel)\nresults = await sandbox.call_tool(action_list=[\n    {\n        \"tool_name\": \"server1\",\n        \"action_name\": \"tool1\",\n        \"params\": {}\n    },\n    {\n        \"tool_name\": \"server2\",\n        \"action_name\": \"tool2\",\n        \"params\": {}\n    }\n])\n\n# Result format\n[\n    ActionResult(\n        tool_name=\"server_name\",\n        action_name=\"tool_name\",\n        content=\"Execution result\",\n        success=True,\n        metadata={...}\n    )\n]\n</code></pre>"},{"location":"Environment/Env%20Client/#getting-environment-information","title":"Getting Environment Information","text":"<pre><code>info = sandbox.get_info()\n# {\n#     \"sandbox_id\": \"...\",\n#     \"status\": \"Running\",\n#     \"metadata\": {...}\n# }\n</code></pre>"},{"location":"Environment/Env%20Client/#cleaning-up-resources","title":"Cleaning Up Resources","text":"<pre><code># Manual cleanup\nawait sandbox.cleanup()\n\n# Automatic cleanup (when object is destroyed)\n# Environment will automatically clean up in __del__\n</code></pre>"},{"location":"Environment/Env%20Client/#frequently-asked-questions","title":"Frequently Asked Questions","text":""},{"location":"Environment/Env%20Client/#q1-how-to-view-all-tools-supported-by-environment","title":"Q1: How to view all tools supported by Environment?","text":"<pre><code>tools = await sandbox.list_tools()\nfor tool in tools:\n    print(tool[\"function\"][\"name\"])\n</code></pre>"},{"location":"Environment/Env%20Client/#q2-what-to-do-when-tool-calls-fail","title":"Q2: What to do when tool calls fail?","text":"<pre><code># Check tool call results\nresult = await sandbox.call_tool(action_list=[{\n    \"tool_name\": \"server_name\",\n    \"action_name\": \"tool_name\",\n    \"params\": {}\n}])\nfor r in result:\n    if not r.success:\n        print(f\"Tool {r.tool_name} call failed: {r.content}\")\n</code></pre>"},{"location":"Environment/Env%20Client/#q3-how-to-set-timeout","title":"Q3: How to set timeout?","text":"<pre><code># Builder pattern\nsandbox = Sandbox().timeout(10000).mcp_config({\n    \"mcpServers\": {\n        \"server_name\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://...\",\n            \"timeout\": 6000,  # 6 seconds\n            \"sse_read_timeout\": 6000\n        }\n    }\n}).build()\n</code></pre>"},{"location":"Environment/Env%20Client/#q4-how-to-disable-a-server","title":"Q4: How to disable a server?","text":"<pre><code>mcp_config = {\n    \"mcpServers\": {\n        \"server_name\": {\n            \"disabled\": True,  # Disable this server\n            ...\n        }\n    }\n}\n</code></pre>"},{"location":"Environment/Env%20Client/#q5-how-to-find-tools-from-the-registry","title":"Q5: How to find tools from the registry?","text":"<pre><code># Method 1: Search by tool name (Builder pattern)\nsandbox = Sandbox().tools([\"tool1\", \"tool2\"]).registry_url(\"https://registry.example.com\").build()\n\n# Method 2: Search by server name (Builder pattern)\nsandbox = Sandbox().mcp_servers([\"server1\", \"server2\"]).registry_url(\"https://registry.example.com\").build()\n</code></pre>"},{"location":"Environment/Env%20Client/#q6-how-to-use-environment-context-capability","title":"Q6: How to use environment context capability?","text":"<p>See the \"Environment Context Capability\" section in the Advanced Capabilities document.</p>"},{"location":"Environment/Env%20Client/#q7-how-to-configure-agents-to-run-in-environment","title":"Q7: How to configure agents to run in Environment?","text":"<p>See the \"Agent Runtime Support\" section in the Advanced Capabilities document.</p>"},{"location":"Environment/Env%20Client/#best-practices","title":"Best Practices","text":""},{"location":"Environment/Env%20Client/#1-reuse-environment-instances","title":"1. Reuse Environment Instances","text":"<pre><code># \u2705 Recommended: Create once, use multiple times (Builder pattern)\nsandbox = Sandbox().mcp_config(mcp_config).build()\ntools = await sandbox.list_tools()\nresult = await sandbox.call_tool(action_list=[{\n    \"tool_name\": \"server_name\",\n    \"action_name\": \"tool_name\",\n    \"params\": {}\n}])\nanother_result = await sandbox.call_tool(action_list=[{\n    \"tool_name\": \"server_name\",\n    \"action_name\": \"another_tool\",\n    \"params\": {}\n}])\nawait sandbox.cleanup()\n\n# \u274c Not recommended: Frequently create and destroy\nfor i in range(10):\n    # Creating a new Environment instance in each loop is inefficient\n    sandbox = Sandbox().mcp_config(mcp_config).build()\n    result = await sandbox.call_tool(action_list=[{\n        \"tool_name\": \"server_name\",\n        \"action_name\": \"tool_name\",\n        \"params\": {}\n    }])\n    await sandbox.cleanup()\n</code></pre>"},{"location":"Environment/Env%20Client/#2-use-connection-pool","title":"2. Use Connection Pool","text":"<p>Environment automatically manages server connection pools, no need to manually manage connections.</p>"},{"location":"Environment/Env%20Client/#3-set-reasonable-timeouts","title":"3. Set Reasonable Timeouts","text":"<pre><code># Set appropriate timeouts based on tool execution time (Builder pattern)\nsandbox = Sandbox().timeout(30000).mcp_config({\n    \"mcpServers\": {\n        \"server_name\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://...\",\n            \"timeout\": 60000,  # 60 seconds\n            \"sse_read_timeout\": 120000  # 120 seconds\n        }\n    }\n}).build()\n</code></pre>"},{"location":"Environment/Env%20Client/#4-use-registry-to-manage-tools","title":"4. Use Registry to Manage Tools","text":"<pre><code># Recommended: Use registry to centrally manage tool configurations (Builder pattern)\nsandbox = Sandbox().tools([\"tool1\", \"tool2\"]).registry_url(\"https://registry.example.com\").build()\n</code></pre>"},{"location":"Environment/Env%20Client/#5-error-handling","title":"5. Error Handling","text":"<pre><code>try:\n    result = await sandbox.call_tool(action_list=[{\n        \"tool_name\": \"server_name\",\n        \"action_name\": \"tool_name\",\n        \"params\": {}\n    }])\n    for r in result:\n        if not r.success:\n            logger.error(f\"Tool call failed: {r.content}\")\nexcept Exception as e:\n    logger.error(f\"Environment operation failed: {e}\")\nfinally:\n    await sandbox.cleanup()\n</code></pre>"},{"location":"Environment/Env%20Client/#example-code","title":"Example Code","text":""},{"location":"Environment/Env%20Client/#complete-example-using-gaia-environment","title":"Complete Example: Using GAIA Environment","text":"<pre><code>import asyncio\nimport json\nfrom aworld.sandbox import Sandbox\n\n# GAIA MCP configuration\nURL = \"https://mcp.aworldagents.com/vpc-pre/mcp\"\nTOKEN = \"YOUR_TOKEN\"\nIMAGE_VERSION = \"gaia-20251125152015\"\n\ngaia_mcp_config = {\n    \"mcpServers\": {\n        \"gaia-mcp\": {\n            \"type\": \"streamable-http\",\n            \"url\": URL,\n            \"headers\": {\n                \"env_name\": \"gaia\",\n                \"Authorization\": f\"Bearer {TOKEN}\",\n                \"MCP_SERVERS\": (\n                    \"googlesearch,readweb-server,media-audio,media-image,\"\n                    \"media-video,intell-code,intell-guard,doc-csv,doc-xlsx,\"\n                    \"doc-docx,doc-pptx,doc-txt,doc-pdf,download,parxiv-server,\"\n                    \"terminal-server,wayback-server,wiki-server\"\n                ),\n                \"IMAGE_VERSION\": IMAGE_VERSION,\n            },\n            \"timeout\": 6000,\n            \"sse_read_timeout\": 6000,\n            \"client_session_timeout_seconds\": 6000,\n        }\n    }\n}\n\nasync def main():\n    # Create an Environment instance through Sandbox (Environment's client) (Builder pattern)\n    sandbox = Sandbox().mcp_config(gaia_mcp_config).build()\n\n    # List tools\n    tools = await sandbox.list_tools()\n    print(f\"Number of available tools: {len(tools)}\")\n\n    # Example tool call\n    result = await sandbox.call_tool(action_list=[{\n        \"tool_name\": \"gaia-mcp\",\n        \"action_name\": \"doc_txt__list_supported_formats_for_txt\",\n        \"params\": {}\n    }])\n\n    print(f\"Tool execution result: {json.dumps(result, ensure_ascii=False, indent=2)}\")\n\n    # Cleanup\n    await sandbox.cleanup()\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"},{"location":"Environment/Env%20Client/#example-integration-with-agent","title":"Example: Integration with Agent","text":"<pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.runner import Runners\n\n# Create an Environment instance through Sandbox (Environment's client) (Builder pattern)\nsandbox = Sandbox().mcp_config({...}).build()\n\n# Create Agent (automatically uses Environment)\nagent = Agent(\n    name=\"MyAgent\",\n    system_prompt=\"You are an assistant\",\n    sandbox=sandbox  # Pass Environment instance\n)\n\n# Run Agent (automatically uses tools from Environment)\nresult = await Runners.run(\n    input=\"Use tools to execute tasks\",\n    agent=agent\n)\n</code></pre>"},{"location":"Environment/Overview/","title":"Overview","text":""},{"location":"Environment/Overview/#introduction","title":"Introduction","text":"<p>Environment is a core concept in the AWorld framework, providing agents with a secure and isolated tool execution environment. Environment uniformly manages MCP (Model Context Protocol) servers, enabling agents to seamlessly use various external tools and services.</p> <p>In the AWorld framework, <code>Sandbox</code> is a client implementation of Environment, providing a concrete implementation of the Environment interface. Through the <code>Sandbox</code> class, you can create and manage Environment instances.</p>"},{"location":"Environment/Overview/#key-features","title":"Key Features","text":"<ul> <li>\u2705 MCP Server Management: Unified management of multiple MCP server connections</li> <li>\u2705 Automatic Tool Discovery: Automatically discover and register MCP tools</li> <li>\u2705 Connection Pool Management: Intelligently cache server connections to improve performance</li> <li>\u2705 Registry Integration: Support for local and remote tool registries</li> <li>\u2705 Streaming Response: Support for streaming tool responses, including progress callbacks</li> <li>\u2705 Environment Context Capability: Automatically inject user-defined context parameters into tool calls</li> <li>\u2705 Agent Runtime Support: Support for running Agents in Environment</li> </ul>"},{"location":"Environment/Using%20API/","title":"Using API","text":""},{"location":"Environment/Using%20API/#install-aworld","title":"Install AWorld","text":"<p>The Environment is included in the AWorld framework and does not require separate installation.</p> <pre><code>pip install aworld\n</code></pre>"},{"location":"Environment/Using%20API/#minimal-example","title":"Minimal Example","text":"<pre><code>import asyncio\nfrom aworld.sandbox import Sandbox\n\n# Configure MCP servers\nmcp_config = {\n    \"mcpServers\": {\n        \"gaia-mcp\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://mcp.example.com/mcp\",\n            \"headers\": {\n                \"Authorization\": \"Bearer YOUR_TOKEN\"\n            }\n        }\n    }\n}\n\nasync def main():\n    # Create an Environment instance\n    sandbox = Sandbox(mcp_config=mcp_config)\n\n    # List available tools\n    tools = await sandbox.list_tools()\n    print(f\"Number of available tools: {len(tools)}\")\n\n    # Clean up resources\n    await sandbox.cleanup()\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"},{"location":"Environment/Using%20API/#online-access-to-complex-environments","title":"Online Access to Complex Environments","text":"<p>Provisioning rich environments is hard\u2014packages conflict, APIs need keys, concurrency must scale. We make it painless with three access modes: 1. Use our default hosted setup (tooling with usage costs includes a limited free tier). 2. Bring your own API keys for unrestricted access (coming soon). 3. Pull our Docker images and run everything on your own infrastructure (coming soon).</p> <pre><code>import os\nimport asyncio\nfrom aworld.sandbox import Sandbox\n\nINVITATION_CODE = os.environ.get(\"INVITATION_CODE\", \"\")\n\nmcp_config = {\n    \"mcpServers\": {\n        \"gaia_server\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://playground.aworldagents.com/environments/mcp\",\n            \"timeout\": 600,\n            \"sse_read_timeout\": 600,\n            \"headers\": {\n                \"ENV_CODE\": \"gaia\",\n                \"Authorization\": f\"Bearer {INVITATION_CODE}\",\n            }\n        }\n    }\n}\n\nasync def _list_tools():\n    sand_box = Sandbox(mcp_config=mcp_config, mcp_servers=[\"gaia_server\"])\n    return await sand_box.mcpservers.list_tools()\n\nif __name__ == \"__main__\":\n    tools = asyncio.run(_list_tools())\n    print(tools)\n</code></pre> <p></p>"},{"location":"Get%20Start/Core%20Capabilities/","title":"Core Capabilities","text":"<p>AWorld delivers a vibrant set of capabilities for building AI agents. At the architectural level, it offers four core pillars:</p>"},{"location":"Get%20Start/Core%20Capabilities/#1-flexible-multi-agent-orchestration","title":"1. Flexible Multi-Agent Orchestration","text":"<p>One of AWorld\u2019s most distinctive features is its built-in support for multi-agent collaboration, enabling flexible orchestration of Multi-Agent Systems (MAS) with diverse topologies and interaction patterns.</p> <p>Key Features:</p> <ul> <li>Supports multiple collaboration paradigms: Workflow, Handoff, Team, and more</li> <li>Enables the construction of both DAG (Directed Acyclic Graph) and DCG (Directed Cyclic Graph) agent topologies</li> <li>Support infinite nesting of topology</li> <li>Accommodates various structural layouts: star, tree, mesh, ring, and other network topologies</li> </ul> <pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.config import AgentConfig\nfrom aworld.core.agent.swarm import Swarm\n\nagent_config = AgentConfig(\n    llm_config=ModelConfig(\n        llm_model_name=\"gpt-4\",\n        llm_api_key=\"your-api-key\",\n        llm_base_url='available url'\n    ),\n)\n# create agent\nresearcher = Agent(name=\"\u7814\u7a76\u5458\", conf=agent_config, system_prompt=\"\u4f60\u662f\u4e00\u4e2a\u4e13\u4e1a\u7684\u7814\u7a76\u5458...\")\nwriter = Agent(name=\"\u4f5c\u5bb6\", conf=agent_config, system_prompt=\"\u4f60\u662f\u4e00\u4e2a\u4e13\u4e1a\u7684\u5185\u5bb9\u521b\u4f5c\u8005...\")\n\n# build collaboration topology\nswarm = Swarm(\n    researcher, writer\n)\n</code></pre>"},{"location":"Get%20Start/Core%20Capabilities/#2-rich-environment-sandbox","title":"2. Rich Environment Sandbox","text":"<p>AWorld provides a standardized tool abstraction layer that transforms complex real-world environments into agent-friendly, Gym-style or API-style interfaces. It supports both local and remote tools and integrates seamlessly with tools implementing the Model Context Protocol (MCP).</p> <p>Key Features:</p> <ul> <li>Unified tool description and interface</li> <li>Sandboxed execution environment with strong isolation</li> <li>Built-in error handling and timeout controls</li> <li>Seamless integration with MCP-compliant servers</li> </ul> <pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.config import AgentConfig, ModelConfig\n\n# config\nmcp_servers=[\"simple-calculator\"],\nmcp_config={\n    \"mcpServers\": {\n        \"simple-calculator\": {\n            \"type\": \"sse\",\n            \"url\": \"http://127.0.0.1:55555/calculator/sse\",\n            \"timeout\": 5,\n            \"sse_read_timeout\": 300\n        }\n    }\n}\n\nagent_config = AgentConfig(\n    llm_config=ModelConfig(\n        llm_model_name=\"gpt-4\",\n        llm_api_key=\"your-api-key\",\n        llm_base_url='available url'\n    ),\n)\nagent = Agent(\n    name=\"tool_agent\", \n    conf=agent_config, \n    mcp_servers=mcp_servers, \n    mcp_config=mcp_config\n)\n</code></pre>"},{"location":"Get%20Start/Core%20Capabilities/#3-closed-loop-self-evolution-training","title":"3. Closed-Loop Self-Evolution Training","text":"<p>This is AWorld\u2019s most innovative capability. Beyond just building and running agents, AWorld collects high-quality execution trajectories and provides a complete pipeline for training and continuous evolution.</p> <p>Key Features:</p> <ul> <li>Framework-agnostic design</li> <li>Integration with third-party RL training frameworks (e.g., VeRL, AReaL)</li> <li>Full support for tool-based environments in training</li> <li>One-command, code-driven training launch</li> </ul> <pre><code>from train.trainer.agent_trainer import AgentTrainer\n\n# define dataset\ntrain_dataset, test_dataset = \"None or string or code reference\"\n# define agent\nagent = Agent(...)\n# train config\ncustom_train_config = \"string or json\"\n# define reward\nreward_func = \"None or string or code reference\"\n# create trainer instance\ntrainer = AgentTrainer(agent=agent,\n                       config=custom_train_config,\n                       reward_func=reward_func,\n                       train_dataset=train_dataset,\n                       test_dataset=test_dataset)\ntrainer.train()\n</code></pre>"},{"location":"Get%20Start/Core%20Capabilities/#4-comprehensive-observability-tracing","title":"4. Comprehensive Observability Tracing","text":"<p>AWorld includes a full-featured tracing framework that supports distributed tracing, context propagation, and span management\u2014capturing every tool call and token consumption across multi-step reasoning chains.</p> <p>Key Features:</p> <ul> <li>Distributed tracing support</li> <li>Integration with mainstream observability frameworks and protocols</li> <li>Real-time monitoring of agents, tools, and task execution</li> <li>Performance profiling and bottleneck identification</li> </ul> <pre><code>import aworld.trace as trace\nfrom aworld.trace.config import ObservabilityConfig\n\n# use trace, call before start task\ntrace.configure(ObservabilityConfig(trace_server_enabled=True))\n\n...\n\n# asyncio monitor\nasyncio_monitor = AsyncioMonitor(detect_duration_second=1, shot_file_name=False)\nasyncio_monitor.start()\n\n# execute task\nexecute_your_task()\n\nasyncio_monitor.stop()\n</code></pre>"},{"location":"Get%20Start/Core%20Capabilities/#additional-key-capabilities","title":"Additional Key Capabilities","text":""},{"location":"Get%20Start/Core%20Capabilities/#task-runtime","title":"Task Runtime","text":"<p>AWorld offers a flexible and powerful task execution runtime, supporting diverse execution modes through multiple types of Runners.</p> <p>Key Features:</p> <ul> <li>Event-driven </li> <li>Extensible runtime architecture (Runner, Handler, Callback, Hooks)</li> <li>Support for multiple compute backends (local, Spark, Ray, etc.)</li> <li>End-to-end execution trajectory tracking</li> </ul> <pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.config import AgentConfig, RunConfig, EngineName\nfrom aworld.runner import Runners\n\n# create agent\nagent = Agent(\n    name=\"analysis_agent\",\n    conf=AgentConfig(\n        llm_model_name=\"gpt-4\",\n        llm_api_key=\"your-api-key\",\n        llm_base_url='available url'\n    ),\n    system_prompt=\"...\"\n)\n\n# sync execute task\nresult = Runners.sync_run(\n    input=\"analysis AI agent development trend\",\n    agent=agent,\n    run_conf=RunConfig(\n        # engine name\n        engine_name=EngineName.LOCAL,\n        worker_num=len(tasks),\n        reuse_process=True\n    )\n)\n\nprint(f\"answer: {result.answer}, trajectory: {result.trajectory}\")\n</code></pre>"},{"location":"Get%20Start/Core%20Capabilities/#context-management","title":"Context Management","text":"<p>AWorld\u2019s context management system provides agents with comprehensive state tracking, configuration control, and prompt optimization.</p> <p>Key Features:</p> <ul> <li>Full state tracking and recovery</li> <li>Intelligent prompt management and optimization</li> <li>Task context penetration and isolation</li> <li>Multi-layered task state management</li> </ul> <pre><code>from aworld.core.context.base import Context\nfrom aworld.core.task import Task\n\n# create context\ncontext = Context()\ncontext.set_task(Task(input=\"\u5206\u6790\u6700\u65b0\u7684AI\u53d1\u5c55\u8d8b\u52bf\"))\ncontext.post_init()\n\n# isolate based on task ID\ncontext.task_id\n\n# merging task context\ncontext.merge_context(other_context)\n# merging subtask context\ncontext.merge_sub_context(sub_task_context)\n</code></pre>"},{"location":"Get%20Start/Core%20Capabilities/#memory-system","title":"Memory System","text":"<p>AWorld includes an extensible memory module that supports short-term and long-term memory, summarization, retrieval, and embedding.</p> <p>Key Features:</p> <ul> <li>Short-term memory: Fast access to recent interactions</li> <li>Long-term memory: Persistent storage of critical information</li> <li>Flexible backend support: Compatible with multiple vector databases</li> <li>Automatic summarization strategies: Optimizes performance and context window usage</li> </ul> <pre><code>from aworld.config import AgentMemoryConfig\nfrom aworld.memory.main import MemoryFactory\nfrom aworld.memory.models import MemoryHumanMessage, MessageMetadata\n\n# create instance\nMemoryFactory.init()\nmemory = MemoryFactory.instance()\nmetadata = MessageMetadata(\n    user_id=\"zues\",\n    session_id=\"session#foo\",\n    task_id=\"zues:session#foo:task#1\",\n    agent_id=\"super_agent\",\n    agent_name=\"super_agent\"\n)\n\n# add memory\nawait memory.add(\n    MemoryHumanMessage(content=\"what is memory\", metadata=metadata), \n    agent_memory_config=AgentMemoryConfig()\n)\n</code></pre>"},{"location":"Get%20Start/Core%20Capabilities/#multi-model-support","title":"Multi-Model Support","text":"<p>AWorld\u2019s Models module offers a powerful and flexible LLM interface, enabling seamless integration of various large language model providers and effortless switching between them.</p> <p>Key Features:</p> <ul> <li>Unified API across all models</li> <li>Tool-style invocation pattern</li> <li>Support for synchronous, asynchronous, and streaming modes</li> <li>Customizable and extensible architecture</li> </ul> <pre><code>from aworld.config import ModelConfig\nfrom aworld.models.llm import get_llm_model, call_llm_model, acall_llm_model, acall_llm_model_stream\n\nllm = get_llm_model(ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n))\n\nquery = \"What is an agent?\"\nmessages = [\n    {\"role\": \"system\", \"content\": \"You are a helpful assistant.\"},\n    {\"role\": \"user\", \"content\": query},\n]\n# sync\nprint(call_llm_model(llm, messages))\n\n# async\n# print(await acall_llm_model(llm, messages))\n\n# async stream\n# async for chunk in acall_llm_model_stream(llm, messages):\n#     print(chunk)\n</code></pre>"},{"location":"Get%20Start/HITL/","title":"Human in the Loop (HITL)","text":"<p>As an advanced multi-agent framework, AWorld places strong emphasis on user involvement in its design.</p> <p>The Human in the Loop (HITL) capability allows users to intervene at critical decision points in the AI workflow, ensuring system safety and accuracy\u2014especially when handling sensitive operations or tasks that require human expertise.</p> <ul> <li>Enhanced Safety: By requiring user confirmation at key action points, the system effectively mitigates risks from malicious or erroneous operations, particularly in scenarios involving financial transactions or access to sensitive data.</li> <li>Increased Trustworthiness: In domains that require expert judgment, human oversight improves the credibility of system decisions and ensures that critical choices undergo appropriate review.</li> <li>Regulatory Compliance: In regulated industries such as finance and healthcare, HITL mechanisms help satisfy legal requirements for human review and approval.</li> </ul> <p>The design of HITL functionality follows several core principles:</p> <ul> <li>Minimal Intervention: Users are only prompted when necessary\u2014typically when encountering specific authorization barriers\u2014not during routine operations.</li> <li>Clear Boundaries: Strict delineation of which actions require explicit user confirmation.</li> <li>Security Assurance: User intervention is triggered for sensitive operations (e.g., login, payment, admin-level actions).</li> </ul>"},{"location":"Get%20Start/HITL/#hitl-process","title":"HITL process","text":"<p>AWorld implements HITL based on tools and events,  example.</p> <p></p>"},{"location":"Get%20Start/HITL/#humantool","title":"HumanTool","text":"<p>HumanTool is a built-in utility dedicated to human-AI collaboration. When user input is required, the agent invokes this tool, emits a HumanMessage event, and pauses the task execution until a response is received. Once the user replies, the system treats the response as the tool\u2019s execution result and resumes the workflow.</p>"},{"location":"Get%20Start/HITL/#event-messaging","title":"Event Messaging","text":"<p>AWorld uses the HumanMessage event type to manage human-AI interactions. This message carries the information that requires user confirmation or input.</p> <p>This design enables the system to send a request for human intervention at any point in the execution flow and wait for a response before proceeding.</p>"},{"location":"Get%20Start/HITL/#agent-integration","title":"Agent Integration","text":"<p>Developers can enable human-in-the-loop functionality by registering the <code>human</code> tool within an Agent. The Agent autonomously determines when human input is needed and constructs an appropriate tool-call request.</p> <pre><code>from aworld.tools.human.human import HUMAN\n\nagent = Agent(\n    conf=agent_config,\n    name='human_test',\n    tool_names=[HUMAN]\n)\n</code></pre>"},{"location":"Get%20Start/HITL/#rule-based-intervention","title":"Rule-Based Intervention","text":"<p>Intervention can also be triggered by predefined rules. For example:</p> <p>When a terminal command requires administrator privileges, the system prompts: \u201cThis operation requires admin rights. Please confirm whether to authorize execution.\u201d</p> <pre><code>from aworld.tools.human.human import HUMAN\nfrom aworld.utils.run_util import exec_tool\n\n# trigger after match \ncontext = your_context or Context()\nexec_tool(tool_name=HUMAN, action_name=\"HUMAN_CONFIRM\", \n          params={\"confirm_content\": \"This operation requires admin rights. Please confirm whether to authorize execution.\"}, \n          agent_name=\"human\", context=context)\n</code></pre>"},{"location":"Get%20Start/HITL/#trigger-conditions","title":"Trigger Conditions","text":"<p>HITL can be activated in the following scenarios:</p> <ul> <li>Browser automation encounters login, authentication, or payment pages</li> <li>Terminal commands require <code>sudo</code> or administrator privileges</li> <li>File system tools attempt to access protected directories</li> <li>Information gathering or analysis tasks require domain-specific user knowledge</li> <li>Content retrieval needs additional search criteria from the user</li> <li>Data processing or report generation requires user \u201csign-off\u201d to finalize</li> <li>Decision-making or task completion requires compliance verification</li> <li>Explicit approval is needed before proceeding with a high-risk action</li> </ul>"},{"location":"Get%20Start/HITL/#in-a-word","title":"In a Word","text":"<p>AWorld HITL capability through a thoughtfully designed tool system, messaging mechanism, and usage policies\u2014enables timely human judgment precisely when needed. This not only enhances system safety and reliability but also embodies the principle that AI systems should be controllable by design. By preserving AI autonomy while guaranteeing user authority at critical moments, AWorld lays a solid foundation for building trustworthy AI applications.</p>"},{"location":"Get%20Start/Overview/","title":"Welcome to AWorld","text":"<p>AWorld is a friendly and streamlined foundational framework for building, orchestrating, evaluating, and evolving AI Agents. AWorld provides a comprehensive suite of basic and advanced components that empower self-evolving AI Agents to handle a wide variety of tasks.</p>"},{"location":"Get%20Start/Overview/#what-is-aworld","title":"What is AWorld?","text":"<p>AWorld is an end-to-end multi-agent framework designed to help you effortlessly:</p> <ul> <li>\ud83e\udd16 Build intelligent agents \u2014 declaratively create LLM-based AI agents</li> <li>\ud83d\udd04 Orchestrate multi-agent collaboration \u2014 construct complex multi-agent systems using handoffs and workflows</li> <li>\ud83d\udcda Capture full execution traces \u2014 log detailed, token-level execution trajectories</li> <li>\ud83c\udf0d Interact with diverse environments \u2014 access extensible tool environments and connect to third-party systems</li> <li>\ud83e\udde0 Enable self-improvement \u2014 allow agents to learn from experience and continuously optimize their behavior</li> </ul>"},{"location":"Get%20Start/Overview/#core-concepts","title":"Core Concepts","text":"<p>Based on rules or models, entities can reason, use tools, and collaborate with other intelligent agents.</p>"},{"location":"Get%20Start/Overview/#fundamental-components","title":"Fundamental Components","text":"<ol> <li> <p>Agent: An entity, rule-based or model-driven, that can reason, use tools, and collaborate with other agents.</p> </li> <li> <p>Swarm: A unified topological model for defining, constructing, and managing collaborative patterns among multiple agents (Multi-Agent systems, MAS).</p> </li> <li> <p>Tool: An external capability that extends beyond the native abilities of an LLM, enabling agents to perform more complex and diverse tasks.</p> </li> <li> <p>Sandbox: A secure environment where agents can execute code or interact with external software safely.</p> </li> <li> <p>Runner: AWorld's scheduling and execution engine, responsible for task dispatching, state transitions, parallel/sequential execution, and recording interaction traces.</p> </li> <li> <p>Context: Manages the execution context of a task, supporting state tracking and recovery.</p> </li> <li> <p>Memory: Stores and retrieves information generated during agent execution, supporting both short-term and long-term memory management.</p> </li> <li> <p>Environment: Provides APIs, tools, and resources that agents can interact with.</p> </li> <li> <p>Trainer: A module for training and optimizing agent behavior, typically leveraging reinforcement learning or other machine learning techniques.</p> </li> <li> <p>Evaluation: A framework for assessing agent capabilities through standardized metrics and benchmarks.</p> </li> <li> <p>Tracer: Tracks fine-grained steps and state changes throughout agent execution for debugging and analysis.</p> </li> <li> <p>Output: Manages system outputs, including logs, reports, and visualized data.</p> </li> </ol>"},{"location":"Get%20Start/Overview/#extended-concepts","title":"Extended Concepts","text":"<p>Under these core concepts, several sub-concepts further enrich the framework:</p> <ul> <li>An Agent leverages Models and MCP tools to accomplish tasks.</li> <li>A Tool consists of one or more executable Actions.</li> <li>The Runner uses an event-driven architecture to orchestrate Tasks via Handlers and Callbacks with support for injecting Hooks at various points in the execution pipeline.</li> </ul>"},{"location":"Get%20Start/Overview/#architecture","title":"Architecture","text":"<p>AWorld's typical runtime architecture forms a feedback control loop:</p> <ol> <li>Perceive: The current state of the Environment (Observation) is passed to the Agent.</li> <li>Decide: The Agent\u2014leveraging its underlying model, rules, and context\u2014generates the next action (Action).</li> <li>Act: The Environment executes the specified Action, producing a new Observation and feedback (Reward).</li> <li>Experience: Through interaction with the environment, the Agent collects trajectory data (Trajectory) that captures both successful and failed attempts.</li> <li>Learn: These trajectories are logged and used for subsequent optimization via reinforcement learning (RL) or in-context learning, enabling the Agent to continuously self-improve and evolve.</li> </ol> <p></p>"},{"location":"Get%20Start/Overview/#key-features","title":"Key Features","text":"<p>AWorld is designed to balance flexibility with production-grade performance, offering a rich set of features to better support agent-based applications and products:</p>"},{"location":"Get%20Start/Overview/#1-simple-flexible-and-powerful-multi-agent-system","title":"1. Simple, Flexible, and Powerful Multi-Agent System","text":"<p>Enables both centralized and decentralized multi-agent systems through a unified graph-based syntax. Supports composition and nesting of agents, and provides built-in patterns such as Workflow, Handoff, and Team for constructing sophisticated collaborative systems.</p>"},{"location":"Get%20Start/Overview/#2-rich-tool-usage-paradigms","title":"2. Rich Tool-usage Paradigms","text":"<p>Supports multiple tool integration modes: - Local tools - MCP (Model Context Protocol) tools - Agent-as-a-Tool - Programmatic Tool Calling (PTC)</p>"},{"location":"Get%20Start/Overview/#3-diverse-runtime-backends","title":"3. Diverse Runtime Backends","text":"<p>Compatible with multiple runtime backends via a unified interface, including Local process, Apache Spark, and Ray. Switch between environments seamlessly without modifying task definitions.</p>"},{"location":"Get%20Start/Overview/#4-broad-llm-provider-support","title":"4. Broad LLM Provider Support","text":"<p>Integrates with major LLM providers such as OpenAI, Anthropic, Qwen, and more. Models can be easily swapped or configured through a consistent API.</p>"},{"location":"Get%20Start/Overview/#5-event-driven-architecture","title":"5. Event-Driven Architecture","text":"<p>Built on an event-driven execution model where dedicated handlers process events by type. This enables modularity, extensibility, and concurrent processing of execution steps.</p>"},{"location":"Get%20Start/Overview/#6-context-management","title":"6. Context Management","text":"<p>Unified management of context across tasks, events, and multi-turn conversations, with built-in capabilities for compression, filtering, and state recovery to ensure efficient tracking.</p>"},{"location":"Get%20Start/Overview/#7-trajectory-construction","title":"7. Trajectory Construction","text":"<p>The runtime captures complete execution trajectories for every task\u2014including every LLM call, action, and reward\u2014enabling synthesis of training samples, performance evaluation, and iterative improvement.</p>"},{"location":"Get%20Start/Overview/#8-environment-support","title":"8. Environment Support","text":"<p>Provides external or simulated environments that agents can perceive, interact with, learn from, and act within. Supports complex real-world online environment access.</p>"},{"location":"Get%20Start/Overview/#9-data-generation","title":"9. Data Generation","text":"<p>Includes built-in data generation capabilities to produce high-quality training data from agent execution trajectories, facilitating model training and optimization.</p>"},{"location":"Get%20Start/Overview/#10-self-evolution-capability","title":"10. Self-Evolution Capability","text":"<p>Supports meta-learning\u2013based self-evolution mechanisms that optimize the entire agent system, not just model weights, enabling continuous adaptation and improvement.</p>"},{"location":"Get%20Start/Overview/#11-evaluation","title":"11. Evaluation","text":"<p>Offers a comprehensive evaluation suite to assess agent capabilities across multiple dimensions, supporting standard benchmarks and custom metrics.</p>"},{"location":"Get%20Start/Overview/#12-servicification-support","title":"12. Servicification Support","text":"<p>Allows agents and components to be deployed as services with exposed APIs, enabling integration into larger systems.</p>"},{"location":"Get%20Start/Overview/#13-visualization-support","title":"13. Visualization Support","text":"<p>Records and persists key interaction data during task execution for UI rendering, analysis, and user inspection.</p>"},{"location":"Get%20Start/Overview/#14-observability","title":"14. Observability","text":"<p>Features a built-in tracing framework that logs detailed information about agents, tool invocations, and multi-agent interactions\u2014greatly simplifying debugging and monitoring.</p>"},{"location":"Get%20Start/Overview/#15-high-extensibility","title":"15. High Extensibility","text":"<p>Modular by design, AWorld supports extension at every layer making it adaptable to diverse use cases, including agents, tools, memory, runners, and more.</p>"},{"location":"Get%20Start/Overview/#16-multiple-usage-modes","title":"16. Multiple Usage Modes","text":"<p>Available via SDK, CLI, and Web UI, catering to developers, researchers, and end users alike.</p>"},{"location":"Get%20Start/Overview/#get-started","title":"Get Started","text":"<p>Ready to build your first agent? Check out our Quick Start Guide to get up and running in minutes.</p> <p>For detailed information on each component, explore our comprehensive documentation:</p> <ul> <li>Build Your First Agent</li> <li>Runtime Overview</li> <li>Environment Setup</li> </ul> <p>Together, these features make AWorld a powerful and flexible framework for self-evolving agents, equally suited for simple single-agent applications and complex, large-scale multi-agent collaboration systems.</p>"},{"location":"Get%20Start/Parallel%20Tasks/","title":"Parallel Tasks","text":"<p>AWorld supports parallel execution of multiple tasks\u2014not only via local multi-processing, but also through seamless integration with distributed computing engines like Ray and Apache Spark\u2014making large-scale parallel task processing simple and efficient. This capability is built upon several core design principles:</p> <ul> <li>Unified Abstraction: Regardless of the underlying compute engine (local, Ray, or Spark), AWorld exposes a consistent API to users.</li> <li>Transparent Switching: Users can effortlessly switch between different compute engines without modifying their business logic.</li> <li>High Scalability: The framework is designed to support a smooth transition from small-scale local testing to large-scale distributed production environments.</li> </ul> <p>Through elegant design and high-level abstraction, AWorld delivers unified parallel task processing across diverse compute backends. With a single, consistent API, developers can easily parallelize workloads\u2014boosting both development efficiency and system performance. Key advantages include:</p> <ul> <li>Improved Execution Efficiency: Parallel execution of multiple tasks significantly reduces total runtime, especially when handling large volumes of independent tasks.</li> <li>Flexible Deployment Options: Users can choose the most suitable execution engine based on their needs\u2014enabling seamless progression from local development to large-scale production.</li> <li>Simplified Distributed Computing: The complexity of distributed systems is abstracted away, allowing developers to focus on business logic rather than infrastructure details.</li> <li>Strong Extensibility: A modular, plugin-based architecture makes it easy to add support for new compute engines to meet evolving requirements.</li> </ul>"},{"location":"Get%20Start/Parallel%20Tasks/#tasks-execution-process","title":"Tasks Execution Process","text":""},{"location":"Get%20Start/Parallel%20Tasks/#runtime-engines","title":"Runtime Engines","text":"<p>AWorld currently supports three execution engines:</p> <ul> <li>LocalRuntime: A local multi-process engine requiring no external dependencies\u2014ideal for development and small-scale deployments.</li> <li>RayRuntime: A distributed execution engine built on Ray, optimized for large-scale parallel processing.</li> <li>SparkRuntime: An execution engine based on Apache Spark, tailored for big data processing scenarios.</li> </ul>"},{"location":"Get%20Start/Parallel%20Tasks/#runtime-configuration","title":"Runtime Configuration","text":"<p>RunConfig is the key to switching between runtime engines. By setting properties such as:</p> <ul> <li><code>engine_name</code>: Specifies which compute engine to use (e.g., <code>\"ray\"</code>, <code>\"spark\"</code>, <code>\"local\"</code>),</li> <li><code>sequence_dependent</code>: Indicates whether tasks have sequential dependencies,</li> <li><code>in_local</code>: For distributed engines, enables local mode for testing,</li> <li><code>cls</code>: Allows custom <code>RuntimeEngine</code> implementations,</li> </ul> <p>Users can fine-tune execution for optimal performance.</p>"},{"location":"Get%20Start/Parallel%20Tasks/#unified-entry-point","title":"Unified Entry Point","text":"<p>Runners provide a standardized, tool-oriented interface for task submission. Internally, they expose utility methods like <code>exec_tasks</code>, enabling on-demand task submission and immediate execution.</p> <pre><code>from aworld.core.task import Task\nfrom aworld.runner import Runners\nfrom aworld.config import RunConfig, EngineName\n\n# create tasks\ntasks = [\n    Task(input=\"what is machine learning?\", agent=my_agent, id=\"task1\"),\n    Task(input=\"explain neural networks\", agent=my_agent, id=\"task2\"),\n    Task(input=\"what is deep learning?\", agent=my_agent, id=\"task3\")\n]\n# Use Ray\nrun_conf=RunConfig(\n    engine_name=EngineName.RAY,\n    worker_num=len(tasks)\n)\n\n# utility entry point\nresults = Runners.sync_run_task(\n    task=tasks,\n    run_conf=run_conf\n)\n\nfrom aworld.utils.run_util import exec_tasks\n\n# inner utility func\nexec_tasks(tasks=tasks, run_conf=run_conf)\n</code></pre>"},{"location":"Get%20Start/Parallel%20Tasks/#agent-level-parallelism","title":"Agent-Level Parallelism","text":"<p>While tasks represent a coarser granularity than agents, AWorld also supports parallelism at the agent level via ParallelizableAgent.</p> <pre><code>sub_agents = [google_search, bing_search, wiki, ...]\nparallel_agent = ParallelizableAgent(name=f\"parallel_search\",\n                                     agents=sub_agents)\n</code></pre> <p>Additionally, users can define custom result aggregation functions to process outputs from parallel agent executions.</p> <pre><code>def custom_aggregate_func(agent: ParallelizableAgent, results: Dict[str, Any]) -&gt; ActionModel:\n    # custom logic\n    aggregated_result = \"...process parallel results...\"\n    return ActionModel(policy_info=aggregated_result)\n\nparallel_agent = ParallelizableAgent(\n    agents=sub_agents,\n    aggregate_func=custom_aggregate_func\n)\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/","title":"Quick Start","text":"<p>AWorld is far more than just an agent foundation framework; it\u2019s an industrial-grade agent production closed-loop.</p> <ul> <li>For users: It offers a suite of intuitive tools that enable defining agents and orchestrating multi-agent collaboration with just a single line of code.</li> <li>For developers: It provides a large number of atomic functions and expandable APIs to help build production applications.</li> <li>For researchers: It delivers an end-to-end pipeline, from data collection to training, making it a powerful tool for reproducing state-of-the-art (SOTA) results.</li> </ul> <p>AWorld provides a complete solution for building, deploying, and evolving sophisticated multi-agent systems. If you aim to create intelligent systems capable of self-improvement and handling complex, long-horizon tasks, AWorld stands out as one of the best choices currently available in the open-source community.</p>"},{"location":"Get%20Start/Quick%20Start/#agent","title":"Agent","text":""},{"location":"Get%20Start/Quick%20Start/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.11 or higher</li> <li>pip package manager</li> <li>Git</li> </ul>"},{"location":"Get%20Start/Quick%20Start/#setup-steps","title":"Setup Steps","text":""},{"location":"Get%20Start/Quick%20Start/#1-clone-the-repository","title":"1. Clone the Repository","text":"<pre><code>git clone https://github.com/inclusionAI/AWorld.git\ncd AWorld\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/#2-install-dependencies","title":"2. Install Dependencies","text":"<pre><code># Install in development mode\npip install -e .\n\n# Or install \npip install aworld\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/#3-configure-environment-variables","title":"3. Configure Environment Variables","text":"<p>Create a <code>.env</code> file in your project root:</p> <pre><code># LLM Configuration\nLLM_PROVIDER=openai\nLLM_MODEL_NAME=gpt-4\nLLM_API_KEY=your-api-key-here\nLLM_BASE_URL=https://api.openai.com/v1\nLLM_TEMPERATURE=0.7\n\n# Other Variables\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/#4-verify-installation","title":"4. Verify Installation","text":"<pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.log.util import logger\n\nlogger.info(\"\u2705 AWorld installed successfully!\")\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/#environment","title":"Environment","text":""},{"location":"Get%20Start/Quick%20Start/#prerequisites_1","title":"Prerequisites","text":"<ul> <li>Docker</li> <li>Docker Compose</li> </ul>"},{"location":"Get%20Start/Quick%20Start/#setup-steps_1","title":"Setup Steps","text":""},{"location":"Get%20Start/Quick%20Start/#1-verify","title":"1. Verify","text":"<pre><code># Verify Docker versions\ndocker --version\ndocker compose --version\n\n# Confirm the Docker daemon is running\ndocker ps\ndocker compose ps\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/#2-configuration","title":"2. Configuration","text":"<p>Copy the environment configuration file template and modify it according to your needs:</p> <pre><code>cp ./gaia-mcp-server/mcp_servers/.env_template ./gaia-mcp-server/mcp_servers/.env\n</code></pre> <p>The GAIA dataset is needed if you use the gaia-mcp-server.</p>"},{"location":"Get%20Start/Quick%20Start/#3-launch-virtualpc-mcp-server","title":"3. Launch VirtualPC MCP Server","text":"<pre><code>sh run-local.sh\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/#4-connect-the-mcp-server","title":"4. Connect the MCP Server","text":"<p>Use the configuration to connect to your VirtualPC MCP Server instance:</p> <pre><code>{\n    \"virtualpc-mcp-server\": {\n        \"type\": \"streamable-http\",\n        \"url\": \"http://localhost:8000/mcp\",\n        \"timeout\": 6000,\n        \"sse_read_timeout\": 6000,\n        \"client_session_timeout_seconds\": 6000\n    }\n}\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/#training","title":"Training","text":""},{"location":"Get%20Start/Quick%20Start/#prerequisites_2","title":"Prerequisites","text":"<ul> <li>aworld</li> <li>AWorld env</li> <li>Special train framework</li> </ul>"},{"location":"Get%20Start/Quick%20Start/#setup-steps_2","title":"Setup Steps","text":"<p>Example with Verl</p>"},{"location":"Get%20Start/Quick%20Start/#1-docker-image","title":"1. Docker Image","text":"<p>Use a mirror of the specified training framework, example\uff1averl0.5-cu126-torch2.7.1-fa2.8.0\uff0cURL: https://github.com/volcengine/verl/tree/main/docker</p>"},{"location":"Get%20Start/Quick%20Start/#2-agent-define","title":"2. Agent Define","text":"<p>Define Agent\uff1a</p> <pre><code># define agent\nagent = Agent(\n    name=\"train_agent\",\n    desc=\"train_agent\",\n    system_prompt=\"train agent system prompt\",\n    mcp_config=mcp_config,\n    mcp_servers=[your_server],\n    conf=agent_config\n)\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/#3-dataset","title":"3. Dataset","text":"<p>Specify the path to the local file, Huggingface Dataset, or load the dataset (requiring secondary processing). </p> <pre><code># define dataset\ntrain_dataset, test_dataset = \"/Users/your_name/dataset/train\", \"/Users/your_name/dataset/test\"\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/#4-training-config","title":"4. Training Config","text":"<p>Customize configuration items based on specific training frameworks.</p> <p>Note: It is necessary to define a reward function for evaluating agent behavior based on specific task objectives, which can be set in the training configuration.</p> <pre><code># define train config\ncustom_train_config = \"string or json\"\n# define reward\nreward_func = \"None or string or code reference\"\n</code></pre>"},{"location":"Get%20Start/Quick%20Start/#5-run","title":"5. Run","text":"<p>Build a trainer instance and start training.</p> <p>Note: If reward_func is code reference, it needs to be used as a parameter for AgentTrain.</p> <pre><code>from train.trainer.agent_trainer import AgentTrainer\n\ntrainer = AgentTrainer(agent=agent,\n                       config=custom_train_config,\n                       reward_func=reward_func,\n                       train_dataset=train_dataset,\n                       test_dataset=test_dataset)\ntrainer.train()\n</code></pre>"},{"location":"Get%20Start/Streaming%20Response/","title":"Streaming Response","text":"<p>Stream agent responses in real-time for responsive user interfaces and applications.</p>"},{"location":"Get%20Start/Streaming%20Response/#overview","title":"Overview","text":"<p>Messages from the AWorld runtime can be streamed to the client. If you\u2019re building a UI on AWorld, enabling streaming allows your UI to update in real-time as the agent generates a response (tokens), executes tools, or changes state.</p> <p>When working with agents that execute long-running operations (e.g., complex tool calls, extensive searches, or code execution), streaming provides immediate feedback to the user.</p>"},{"location":"Get%20Start/Streaming%20Response/#quick-start","title":"Quick Start","text":"<p>AWorld supports flexible streaming modes via the <code>Runners.streaming_run</code> interface.</p> <p>To enable streaming, use <code>Runners.streaming_run</code> (for direct execution) or <code>Runners.streaming_run_task</code> (for task objects):</p> <pre><code>import asyncio\nfrom aworld.runner import Runners\nfrom aworld.core.common import StreamingMode\nfrom aworld.core.event.base import ChunkMessage, AgentMessage\n\nasync def main():\n    # 1. Create your agent (assuming 'agent' is already defined)\n    # ... \n\n    # 2. Start streaming\n    stream = Runners.streaming_run(\n        input=\"Write a short poem about coding.\",\n        agent=agent,\n        streaming_mode=StreamingMode.ALL  # Receive all event types\n    )\n\n    # 3. Consume the stream\n    async for msg in stream:\n        if isinstance(msg, ChunkMessage):\n             # Partial token content\n            print(msg.payload.content, end=\"\", flush=True)\n        elif isinstance(msg, AgentMessage):\n            # Complete agent step\n            print(f\"\\n[Agent Step]: {msg.payload}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"},{"location":"Get%20Start/Streaming%20Response/#streaming-modes","title":"Streaming Modes","text":"<p>AWorld provides granular control over what information is streamed back to the client via the <code>StreamingMode</code> enum.</p> Mode Description <code>StreamingMode.CORE</code> (Default) Streams core life-cycle events: Agent, Tool, Chunk, Task, and Group messages. <code>StreamingMode.CHUNK</code> Only streams <code>ChunkMessage</code> events (raw LLM token generation). Best for simple \"typewriter\" interfaces. <code>StreamingMode.OUTPUT</code> Only streams final <code>Output</code> messages. <code>StreamingMode.CHUNK_OUTPUT</code> Streams both partial tokens (<code>ChunkMessage</code>) and final outputs. <code>StreamingMode.ALL</code> Streams all events including detailed debug info, state changes, and memory operations. <pre><code>from aworld.core.common import StreamingMode\n\n# Only get the raw tokens\nstream = Runners.streaming_run(..., streaming_mode=StreamingMode.CHUNK)\n</code></pre>"},{"location":"Get%20Start/Streaming%20Response/#understanding-message-flow","title":"Understanding Message Flow","text":"<p>Unlike simple LLM streaming, AWorld streams Events. An agent execution involves multiple steps: reasoning, tool calling, tool execution, and memory updates.</p>"},{"location":"Get%20Start/Streaming%20Response/#message-types-reference","title":"Message Types Reference","text":"<p>The stream yields <code>Message</code> objects. Key message types you will encounter:</p> <ul> <li><code>ChunkMessage</code>: Represents a partial piece of content (e.g., a token from the LLM).<ul> <li><code>msg.category</code>: \"chunk\"</li> <li><code>msg.payload</code>: Object containing <code>content</code> (str).</li> </ul> </li> <li><code>ToolMessage</code>: Indicates a tool call is requested or completed.<ul> <li><code>msg.category</code>: \"tool\"</li> <li><code>msg.payload</code>: List of <code>ActionModel</code> (tool name, params).</li> </ul> </li> <li><code>AgentMessage</code>: Represents a completed agent step or observation.<ul> <li><code>msg.category</code>: \"agent\"</li> </ul> </li> <li><code>TaskMessage</code>: Indicates task status updates (Start, Finish, Error).<ul> <li><code>msg.topic</code>: <code>TopicType.TASK_RESPONSE</code> signals the end of the stream.</li> </ul> </li> </ul>"},{"location":"Get%20Start/Streaming%20Response/#example-handling-different-events","title":"Example: handling Different Events","text":"<p>Here is a comprehensive example handling various event types to build a rich UI experience:</p> <pre><code>from aworld.core.event.base import ChunkMessage, ToolMessage, TopicType\n\nasync for msg in Runners.streaming_run(input=\"Search for weather in Beijing\", agent=agent):\n\n    # 1. Handle Real-time Tokens (Typewriter effect)\n    if isinstance(msg, ChunkMessage):\n        # chunk.payload is typically a ModelResponse chunk\n        content = msg.payload.content\n        if content:\n            print(content, end=\"\", flush=True)\n\n    # 2. Handle Tool Calls (Show \"Executing...\" status)\n    elif isinstance(msg, ToolMessage):\n        actions = msg.payload\n        for action in actions:\n            print(f\"\\n[Tool Call]: {action.tool_name} (params: {action.params})\")\n\n    # 3. Handle Task Completion\n    elif msg.topic == TopicType.TASK_RESPONSE:\n        result = msg.payload\n        if result.success:\n            print(f\"\\n[Finished]: {result.answer}\")\n        else:\n            print(f\"\\n[Failed]: {result.msg}\")\n</code></pre>"},{"location":"Training/Evaluation/","title":"Evaluation","text":"<p>AWorld\u2019s evaluation system provides a comprehensive and flexible evaluation framework that supports diverse evaluation scenarios and objectives\u2014such as multi-agent systems, tool usage, and task completion quality. Built on a modular design, it allows users to easily extend evaluation capabilities to meet specific needs, forming a critical foundation for the continuous improvement of agents.</p>"},{"location":"Training/Evaluation/#core-components","title":"Core Components","text":"<ul> <li>Evaluation Target (<code>**EvalTarget**</code>)   The central concept of the evaluation system, defining what to evaluate and how to evaluate it.<ul> <li>Built-in Evaluation Targets:<ul> <li><code>AworldAgentEvalTarget</code>: Evaluates the performance of AWorld agents.</li> <li><code>AworldTaskEvalTarget</code>: Evaluates the completion quality of AWorld tasks.</li> </ul> </li> <li>Custom Evaluation Targets: Users can implement their own by subclassing <code>EvalTarget</code>. The core logic resides   in the <code>predict</code> method, which executes the evaluation and returns results.</li> </ul> </li> <li>Metrics<ul> <li>Functional Metrics: Measure task accuracy and correctness.</li> <li>Performance Metrics: Assess execution efficiency and resource consumption.</li> <li>Quality Metrics: Evaluate output quality, fluency, diversity, etc.</li> </ul> </li> <li>Evaluation Dataset (<code>**EvalDataset**</code>)   Stores evaluation data in various formats (e.g., JSON, CSV). Each entry includes input data and expected output,   enabling comparison against actual agent responses.</li> <li>EvaluateRunner   Orchestrates the entire evaluation pipeline: loading datasets, executing evaluations, collecting results, and   generating reports.</li> </ul>"},{"location":"Training/Evaluation/#evaluation-workflow","title":"Evaluation Workflow","text":"<ol> <li>Evaluation Configuration    Before evaluation, configure:<ul> <li>Evaluation target type</li> <li>Dataset path</li> <li>Selected metrics</li> <li>Evaluation strategy</li> <li>Output directory</li> </ul> </li> <li>Data Loading    Load evaluation data (inputs + expected outputs) from the specified dataset in supported formats.</li> <li>Evaluation Execution    For each data item:<ul> <li>Feed input to the evaluation target</li> <li>Invoke the target\u2019s <code>predict</code> method</li> <li>Collect execution results</li> <li>Compute metrics</li> <li>Log the evaluation trace</li> </ul> </li> <li>Result Analysis    After completion, the framework provides:<ul> <li>Detailed Results: Per-case evaluation outcomes</li> <li>Execution Summary: Overall success rate, average metrics, total runtime, etc.</li> <li>Evaluation Report: Insights including failure analysis, performance breakdowns, and visualizations</li> <li>Result Persistence: Saves all results to the configured output directory</li> </ul> </li> </ol>"},{"location":"Training/Evaluation/#code-example","title":"Code Example","text":"<pre><code>from aworld.evaluations.base import Evaluator, EvalTarget, EvalDataCase\nfrom aworld.core.task import Task\nfrom aworld.runner import Runners\n\n\nclass MyEvalTarget(EvalTarget):\n    async def predict(self, index: int, input: EvalDataCase[dict]) -&gt; dict:\n        # Extract input and expected output\n        task_input = input.case_data[\"input\"]\n        expected_output = input.case_data[\"expected\"]\n\n        # Execute the task\n        result = await Runners.run_task(\n            task=Task(input=task_input, agent=my_agent)\n        )\n\n        # Return evaluation metrics\n        return {\n            \"success\": result.answer == expected_output,\n            \"accuracy\": calculate_accuracy(result.answer, expected_output),\n            \"time_cost\": result.time_cost\n        }\n\n\n# Create evaluator\nevaluator = Evaluator(\n    eval_target=MyEvalTarget(),\n    dataset=my_dataset\n)\n\n# Run evaluation\nresults = await evaluator.evaluate()\n</code></pre>"},{"location":"Training/Evaluation/#best-practices","title":"Best Practices","text":"<p>Evaluation framework's modular, extensible design ensures that AWorld\u2019s evaluation system remains both powerful out-of-the-box and adaptable to advanced research or production requirements.</p> <p>The framework supports four common evaluation patterns:</p> <ol> <li>Single-Item Evaluation: Assess individual cases for precise performance testing.</li> <li>Batch Evaluation: Evaluate an entire dataset for holistic performance analysis.</li> <li>Comparative Evaluation: Compare multiple models or agent configurations.</li> <li>Progressive Evaluation: Gradually increase task complexity to probe capability boundaries.</li> </ol>"},{"location":"Training/Evaluation/#custom-evaluation-metrics","title":"Custom Evaluation Metrics","text":"<p>Users can define custom metrics by implementing the <code>Scorer</code> interface:</p> <pre><code>from aworld.evaluations.base import Scorer\n\n\nclass CustomScore(Scorer):\n    async def score(self, index: int, input: EvalDataCase[EvalCaseDataType], output: dict) -&gt; ScorerResult:\n        # Implement custom scoring logic\n        return custom_score\n</code></pre>"},{"location":"Training/Evaluation/#custom-evaluation-strategies","title":"Custom Evaluation Strategies","text":"<p>Custom evaluation logic can be implemented by inheriting from <code>EvalTarget</code>:</p> <pre><code>class CustomEvalTarget(EvalTarget):\n    async def predict(self, index: int, input: EvalDataCase[dict]) -&gt; dict:\n        # Implement domain-specific evaluation strategy\n        pass\n</code></pre>"},{"location":"Training/Trainer/","title":"Trainer","text":"<p><code>AgentTrainer</code> is the unified training API entry point in the AWorld framework, providing a highly abstracted and flexible interface for agent training. It supports multiple backend training frameworks (e.g., VeRL) and centrally manages four core modules: Agent, Dataset, Reward Function, and Training Configuration.</p>"},{"location":"Training/Trainer/#key-features","title":"Key Features","text":"<ul> <li>\u2705 Unified API Entry Point: Offers a consistent interface across different training frameworks</li> <li>\u2705 Modular Design: Independently manages the four core modules\u2014Agent, Dataset, Reward, and Config</li> <li>\u2705 Flexible Extensibility: Supports registration of custom training engines</li> <li>\u2705 Comprehensive Validation: Validates all modules during initialization</li> <li>\u2705 Robust Error Handling: Provides clear error messages and detailed logging</li> </ul>"},{"location":"Training/Trainer/#architecture-design","title":"Architecture Design","text":"<p>This modular, extensible design allows AWorld to support diverse training methodologies while maintaining a clean, unified API for users.</p>"},{"location":"Training/Trainer/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    AgentTrainer                 \u2502\n\u2502            (Unified Training API Entry Point)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502           \u2502           \u2502\n  Initialization   Module      Framework\n   Validation     Management    Selection\n         \u2502           \u2502           \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502                         \u2502\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502   Trainer    \u2502         \u2502   Trainer    \u2502\n   \u2502   (VeRL)     \u2502  ...... \u2502   (Swift)    \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502                       \u2502\n    \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u250c\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510\n    \u2502          \u2502          \u2502          \u2502\n  Agent    Dataset     Reward    Config\n</code></pre>"},{"location":"Training/Trainer/#module-interaction-flow","title":"Module Interaction Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  1. Parameter Validation            \u2502\n\u2502     - Ensures agent is not empty    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  2. Fetch Training Engine Class     \u2502\n\u2502     - Looks up in TRAIN_PROCESSOR   \u2502\n\u2502     - Default 'verl' if unspecified \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  3. Instantiate Training Engine     \u2502\n\u2502     - Creates a subclass            \u2502\n\u2502     - Passes run_path for output    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  4. Module Validation (Critical!)   \u2502\n\u2502     \u251c\u2500 check_agent()                \u2502\n\u2502     \u251c\u2500 check_dataset()              \u2502\n\u2502     \u251c\u2500 check_reward()               \u2502\n\u2502     \u2514\u2500 check_config()               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  5. Mark Initialization as Complete \u2502\n\u2502     - mark_initialized()            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  6. Start Training                  \u2502\n\u2502     - train_processor.train()       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"Training/Trainer/#core-modules","title":"Core Modules","text":""},{"location":"Training/Trainer/#agenttrainer","title":"AgentTrainer","text":"<p>The central training coordinator that unifies and manages all training-related components.</p> Attribute Type Description <code>agent</code> <code>Union[str, Agent]</code> Agent instance or config file path <code>train_dataset</code> <code>Union[str, Dataset]</code> Training dataset or path <code>test_dataset</code> <code>Union[str, Dataset]</code> Test dataset or path <code>reward_func</code> <code>Union[str, Callable]</code> Reward function or its path <code>config</code> <code>Union[str, Config]</code> Training configuration <code>train_engine_name</code> <code>str</code> Training framework name (default: <code>'verl'</code>) <code>run_path</code> <code>str</code> Output directory (default: <code>'runs'</code>) <code>train_processor</code> <code>TrainerProcessor</code> Actual training processor instance"},{"location":"Training/Trainer/#initialization-example","title":"Initialization Example","text":"<pre><code>trainer = AgentTrainer(\n    agent='path/to/agent_config.yaml',\n    train_dataset='path/to/train_dataset.csv',\n    test_dataset='path/to/test_dataset.csv',\n    reward_func=my_reward_function,\n    config=training_config,\n    run_path='./outputs',\n    train_engine_name='verl'\n)\n</code></pre>"},{"location":"Training/Trainer/#start-training","title":"Start Training","text":"<pre><code>def train(self) -&gt; None:\n    # Checks if the training processor is initialized\n    # Calls train_processor.train()\n    # Raises ValueError if not initialized\n</code></pre>"},{"location":"Training/Trainer/#register-a-custom-training-engine","title":"Register a Custom Training Engine","text":"<pre><code>AgentTrainer.register_processor(\n    train_engine_name='custom', \n    train_type=CustomTrainer\n)\n# - `train_engine_name`: Unique identifier for the framework\n# - `train_type`: Subclass of `TrainerProcessor`\n</code></pre>"},{"location":"Training/Trainer/#unregister-a-training-engine","title":"Unregister a Training Engine","text":"<pre><code>AgentTrainer.unregister_processor(train_engine_name='custom')\n</code></pre>"},{"location":"Training/Trainer/#trainerprocessor","title":"TrainerProcessor","text":"<p>Abstract base class defining the interface for all training frameworks. Concrete implementations must inherit from this class.</p>"},{"location":"Training/Trainer/#train","title":"<code>train()</code>","text":"<p>Responsibilities:</p> <ul> <li>Implement specific training logic</li> <li>Load data</li> <li>Initialize model</li> <li>Execute training loop</li> </ul>"},{"location":"Training/Trainer/#check_dataset","title":"<code>check_dataset(...)</code>","text":"<p>Responsibilities:</p> <ul> <li>Validate dataset format against framework requirements</li> <li>Convert datasets to framework-compatible formats</li> <li>Resolve dataset paths (if provided as strings)</li> <li>Verify integrity of train/test splits</li> </ul>"},{"location":"Training/Trainer/#check_agent","title":"<code>check_agent(...)</code>","text":"<p>Responsibilities:</p> <ul> <li>Validate agent or its configuration</li> <li>Convert AWorld Agent to framework-specific representation</li> <li>Load agent from config file (if string path provided)</li> <li>Ensure model and parameters are valid</li> </ul>"},{"location":"Training/Trainer/#check_reward-also-supervised-labelsscores","title":"<code>check_reward(...)</code> (also supervised labels/scores)","text":"<p>Responsibilities:</p> <ul> <li>Validate function signature and return type</li> <li>Convert reward config to framework-supported format</li> <li>Load reward function from file (if string path provided)</li> <li>Confirm callability</li> </ul>"},{"location":"Training/Trainer/#check_config","title":"<code>check_config(...)</code>","text":"<p>Responsibilities:</p> <ul> <li>Validate config against framework constraints</li> <li>Augment with defaults where missing</li> <li>Load config from file (if string path provided)</li> <li>Return enhanced configuration</li> </ul>"},{"location":"Training/Trainer/#custom-training-processor","title":"Custom Training Processor","text":"<p>AWorld imposes no restrictions on training paradigms. Developers can implement various strategies:</p> <ul> <li>Supervised Learning: Train on pre-collected labeled datasets</li> <li>Reinforcement Learning: Learn optimal policies through environment interaction</li> <li>Transfer Learning: Leverage pretrained models to accelerate new task adaptation</li> <li>Online Learning: Continuously update model parameters during task execution</li> </ul> <p>A custom trainer should typically support:</p> <ul> <li>Model parameter management</li> <li>Experience/data collection</li> <li>Training strategy execution</li> <li>Model update mechanisms</li> </ul>"},{"location":"Training/Trainer/#step-1-inherit-from-trainerprocessor","title":"Step 1: Inherit from <code>TrainerProcessor</code>","text":"<pre><code># train/adapter/your_framework/my_trainer.py\n\nfrom train.trainer.trainer_processor import TrainerProcessor\nfrom typing import Union, Callable, Any\nfrom datasets import Dataset\nfrom aworld.agents.llm_agent import Agent\nfrom aworld.logs.util import logger\n\nclass MyFrameworkTrainer(TrainerProcessor):\n    \"\"\"My custom training framework adapter.\"\"\"\n\n    def __init__(self, run_path: str):\n        super().__init__(run_path)\n        self.framework_config = None\n\n    def train(self):\n        logger.info(\"Starting training with MyFramework...\")\n        # Your training logic:\n        # - Load data\n        # - Initialize model\n        # - Training loop\n        # - Save checkpoints\n        logger.info(\"Training completed!\")\n\n    def check_agent(self, agent: Union[str, Agent]):\n        if isinstance(agent, str):\n            logger.info(f\"Loading agent from {agent}\")\n            # ... loading logic\n        else:\n            logger.info(\"Validating Agent object\")\n            # ... validation logic\n\n    def check_dataset(self, \n                      dataset: Union[str, Dataset] = None,\n                      test_dataset: Union[str, Dataset] = None):\n        if dataset:\n            if isinstance(dataset, str):\n                logger.info(f\"Loading dataset from {dataset}\")\n                # ... loading logic\n            else:\n                logger.info(\"Validating dataset format\")\n                # ... validation logic\n        if test_dataset:\n            # similar handling\n            pass\n\n    def check_reward(self, reward_func: Union[str, Callable[..., Any]] = None):\n        if reward_func:\n            if isinstance(reward_func, str):\n                logger.info(f\"Loading reward function from {reward_func}\")\n                # ... loading logic\n            elif callable(reward_func):\n                logger.info(\"Validating reward function\")\n                # ... validation logic\n            else:\n                raise ValueError(\"Reward func must be callable or file path\")\n\n    def check_config(self, config: Union[str, Any] = None):\n        if config is None:\n            config = self.get_default_config()\n        elif isinstance(config, str):\n            logger.info(f\"Loading config from {config}\")\n            # ... loading logic\n        self.framework_config = config\n        return config\n\n    @staticmethod\n    def get_default_config():\n        return {\n            'learning_rate': 1e-4,\n            'batch_size': 32,\n            'epochs': 10,\n            'warmup_steps': 1000,\n        }\n</code></pre>"},{"location":"Training/Trainer/#step-2-expose-the-trainer-in-module-__init__py","title":"Step 2: Expose the Trainer in Module <code>__init__.py</code>","text":"<pre><code># train/adapter/your_framework/__init__.py\n\nfrom .my_trainer import MyFrameworkTrainer\n\n__all__ = ['MyFrameworkTrainer']\n</code></pre>"},{"location":"Training/Trainer/#step-3-register-the-framework-with-agenttrainer","title":"Step 3: Register the Framework with <code>AgentTrainer</code>","text":"<p>Option A: Dynamic Registration (in user code)</p> <pre><code>from train.integration.my_framework import MyFrameworkTrainer\nfrom train.trainer.agent_trainer import AgentTrainer\n\nAgentTrainer.register_processor('my_framework', MyFrameworkTrainer)\n\ntrainer = AgentTrainer(\n    agent=my_agent,\n    train_engine_name='my_framework'\n)\n</code></pre> <p>Option B: Automatic Registration (recommended for libraries)</p> <pre><code># train/trainer/__init__.py\n\nfrom .agent_trainer import AgentTrainer\nfrom train.integration.my_framework import MyFrameworkTrainer\n\n# Auto-register when module is imported\nAgentTrainer.register_processor('my_framework', MyFrameworkTrainer)\n</code></pre>"},{"location":"Training/Trajectory/","title":"Trajectory","text":"<p>AWorld runtime captures every step across offline and online runs. Each task yields a complete trajectory\u2014every LLM call, action, and reward\u2014so you can synthesize training samples, audit performance, and iterate with confidence.</p>"},{"location":"Training/Trajectory/#complete-task-trajectories","title":"Complete Task Trajectories","text":"<p>Tasks unfold over many LLM calls. The framework captures every step, giving you a full trajectory.</p> <pre><code>import asyncio\nfrom aworld.runner import Runners\nfrom aworld.core.task import Task\nfrom aworld.logs.util import logger\nimport json\n\n# refer the section above for agent constrution \nsearcher = Agent(...)\n\nif __name__ == \"__main__\":\n    async def test_complete_trajectory():\n        task = Task(\n            input=\"Use google search tool to answer the question: the news about AI today.\",\n            agent=searcher\n        )\n\n        responses = await Runners.run_task(task)\n        resp = responses[task.id]\n        logger.info(f\"task answer: {resp.answer}\")\n        logger.info(f\"task trajectory: {json.dumps(resp.trajectory, ensure_ascii=False)}\")\n    asyncio.run(test_complete_trajectory())\n</code></pre>"},{"location":"Training/Trajectory/#single-step-introspection","title":"Single-Step Introspection","text":"<p>Need finer control? Call <code>step()</code> to inspect one action/response pair at a time. This lets you inject intermediate rewards during training, enabling richer, more flexible learning signals.</p> <pre><code>import os\nimport asyncio\nfrom aworld.runner import Runners\nfrom aworld.core.task import Task\nfrom aworld.logs.util import logger\nimport json\nfrom aworld.config import TaskConfig, TaskRunMode\n\n# refer the section above for agent constrution \nsearcher = Agent(...)\n\nif __name__ == \"__main__\":\n    async def test_single_step_introspection():\n        task = Task(\n            input=\"Use google search tool to answer the question: the news about AI today.\",\n            agent=searcher,\n            conf=TaskConfig(\n                resp_carry_context=True,\n                run_mode=TaskRunMode.INTERACTIVE\n            )\n        )\n\n        trajectory_log = os.path.join(os.path.dirname(__file__), \"trajectory_log.txt\")\n        is_finished = False\n        step = 1\n        while not is_finished:\n            with open(trajectory_log, \"a\", encoding=\"utf-8\") as traj_file:\n                is_finished, observation, response = await Runners.step(task)\n                traj_file.write(f\"Step {step}\\n\")\n                traj_file.write(json.dumps(response.trajectory, ensure_ascii=False, indent=2))\n                traj_file.write(\"\\n\\n\")\n                step += 1\n    asyncio.run(test_single_step_introspection())\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E4%BA%BA%E6%9C%BA%E5%8D%8F%E5%90%8C%EF%BC%88HITL%EF%BC%89/","title":"\u4eba\u673a\u534f\u540c\uff08HITL\uff09","text":"<p>\u4f5c\u4e3a\u4e00\u4e2a\u5148\u8fdb\u7684\u591a\u667a\u80fd\u4f53\u8fdb\u5316\u6846\u67b6\uff0cAWorld\u5728\u8bbe\u8ba1\u4e0a\u5145\u5206\u8003\u8651\u4e86\u7528\u6237\u53c2\u4e0e\u7684\u91cd\u8981\u6027\u3002</p> <p>\u4eba\u673a\u534f\u540c\uff08Human in the Loop\uff09\u529f\u80fd\u4f7f\u5f97\u7528\u6237\u53ef\u4ee5\u5728\u5173\u952e\u8282\u70b9\u4ecb\u5165AI\u51b3\u7b56\u8fc7\u7a0b\uff0c\u786e\u4fdd\u7cfb\u7edf\u7684\u5b89\u5168\u6027\u548c\u51c6\u786e\u6027\uff0c\u7279\u522b\u662f\u5728\u9762\u5bf9\u654f\u611f\u64cd\u4f5c\u6216\u9700\u8981\u7528\u6237\u4e13\u4e1a\u77e5\u8bc6\u7684\u60c5\u51b5\u3002</p> <ul> <li>\u63d0\u5347\u5b89\u5168\u6027\u3002\u901a\u8fc7\u5728\u5173\u952e\u64cd\u4f5c\u70b9\u5f15\u5165\u7528\u6237\u786e\u8ba4\uff0c\u53ef\u4ee5\u6709\u6548\u9632\u6b62\u6076\u610f\u64cd\u4f5c\u6216\u8bef\u64cd\u4f5c\u5e26\u6765\u7684\u98ce\u9669\uff0c\u7279\u522b\u662f\u5728\u6d89\u53ca\u8d44\u91d1\u4ea4\u6613\u3001\u654f\u611f\u6570\u636e\u8bbf\u95ee\u7b49\u573a\u666f\u4e2d\u3002</li> <li>\u589e\u5f3a\u53ef\u4fe1\u5ea6\u3002\u5bf9\u4e8e\u4e00\u4e9b\u9700\u8981\u4e13\u4e1a\u5224\u65ad\u7684\u573a\u666f\uff0c\u7528\u6237\u7684\u4ecb\u5165\u53ef\u4ee5\u63d0\u5347\u7cfb\u7edf\u51b3\u7b56\u7684\u53ef\u4fe1\u5ea6\uff0c\u786e\u4fdd\u91cd\u8981\u51b3\u7b56\u5f97\u5230\u9002\u5f53\u5ba1\u67e5\u3002</li> <li>\u6cd5\u89c4\u5408\u89c4\u3002\u5728\u91d1\u878d\u3001\u533b\u7597\u7b49\u53d7\u76d1\u7ba1\u884c\u4e1a\uff0c\u4eba\u673a\u534f\u540c\u673a\u5236\u53ef\u4ee5\u5e2e\u52a9\u6ee1\u8db3\u6cd5\u89c4\u5bf9\u4eba\u5de5\u5ba1\u6838\u7684\u8981\u6c42\u3002</li> </ul> <p>\u4eba\u673a\u534f\u540c\u7684\u8bbe\u8ba1\u4e00\u822c\u9075\u5faa\u51e0\u4e2a\u6838\u5fc3\u539f\u5219\uff1a</p> <ul> <li>\u6700\u5c0f\u5e72\u9884\uff1a\u7528\u6237\u53ea\u5728\u5fc5\u8981\u65f6\u4ecb\u5165\uff0c\u901a\u5e38\u662f\u9047\u5230\u7279\u5b9a\u6388\u6743\u969c\u788d\u65f6\uff0c\u800c\u4e0d\u662f\u5e38\u89c4\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u3002</li> <li>\u660e\u786e\u8fb9\u754c\uff1a\u4e25\u683c\u533a\u5206\u54ea\u4e9b\u64cd\u4f5c\u5fc5\u987b\u7531\u7528\u6237\u786e\u8ba4\u3002</li> <li>\u5b89\u5168\u4fdd\u969c\uff1a\u6d89\u53ca\u654f\u611f\u64cd\u4f5c\uff08\u5982\u767b\u5f55\u3001\u652f\u4ed8\u3001\u7ba1\u7406\u5458\u6743\u9650\u7b49\uff09\u65f6\u89e6\u53d1\u7528\u6237\u4ecb\u5165\u3002</li> </ul>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E4%BA%BA%E6%9C%BA%E5%8D%8F%E5%90%8C%EF%BC%88HITL%EF%BC%89/#aworld","title":"AWorld\u7684\u4eba\u673a\u534f\u4f5c","text":"<p>AWorld\u57fa\u4e8e\u5de5\u5177\u548c\u4e8b\u4ef6\u5b9e\u73b0\u4eba\u673a\u534f\u4f5c\uff0c\u793a\u4f8b\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E4%BA%BA%E6%9C%BA%E5%8D%8F%E5%90%8C%EF%BC%88HITL%EF%BC%89/#_1","title":"\u4eba\u673a\u4ea4\u4e92\u6d41\u7a0b","text":""},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E4%BA%BA%E6%9C%BA%E5%8D%8F%E5%90%8C%EF%BC%88HITL%EF%BC%89/#humantool","title":"HumanTool","text":"<p>HumanTool\u662f\u4e13\u7528\u4e8e\u4eba\u673a\u534f\u4f5c\u7684\u5185\u7f6e\u5de5\u5177\uff0c\u5f53\u4ea4\u4e92\u9700\u8981\u7528\u6237\u4ecb\u5165\u65f6\uff0c\u4f1a\u4f7f\u7528\u8be5\u5de5\u5177\uff0c\u7136\u540e\u53d1\u9001\u4e00\u4e2aHumanMessage\u7684\u4e8b\u4ef6\uff0c\u7136\u540e\u7b49\u5f85\u7528\u6237\u53d1\u51fa\u54cd\u5e94\uff0c\u8fc7\u7a0b\u4e2d\u4efb\u52a1\u4f1a\u6302\u8d77\u7b49\u5f85\u3002\u6536\u5230\u7528\u6237\u54cd\u5e94\u540e\uff0c\u7cfb\u7edf\u4f1a\u5c06\u5176\u4f5c\u4e3a\u5de5\u5177\u6267\u884c\u7ed3\u679c\u5904\u7406\uff0c\u5e76\u7ee7\u7eed\u540e\u7eed\u7684\u6d41\u7a0b\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E4%BA%BA%E6%9C%BA%E5%8D%8F%E5%90%8C%EF%BC%88HITL%EF%BC%89/#_2","title":"\u4e8b\u4ef6\u6d88\u606f","text":"<p>AWorld\u4f7f\u7528HumanMessage\u6765\u5904\u7406\u4eba\u673a\u4ea4\u4e92\uff0c\u6d88\u606f\u627f\u8f7d\u9700\u8981\u7528\u6237\u786e\u8ba4\u7684\u4fe1\u606f\u3002</p> <p>\u8fd9\u79cd\u8bbe\u8ba1\u4f7f\u7cfb\u7edf\u80fd\u591f\u5728\u4efb\u4f55\u9700\u8981\u7528\u6237\u4ecb\u5165\u7684\u5730\u65b9\u53d1\u9001\u76f8\u5e94\u6d88\u606f\uff0c\u5e76\u7b49\u5f85\u7528\u6237\u54cd\u5e94\u540e\u518d\u7ee7\u7eed\u6267\u884c\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E4%BA%BA%E6%9C%BA%E5%8D%8F%E5%90%8C%EF%BC%88HITL%EF%BC%89/#agent","title":"Agent\u96c6\u6210","text":"<p>\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u901a\u8fc7\u5728Agent\u4e2d\u6ce8\u518chuman\u5de5\u5177\u6765\u542f\u7528\u4eba\u673a\u534f\u540c\u529f\u80fd\u3002Agent\u81ea\u4e3b\u5224\u65ad\u9700\u8981\u7528\u6237\u4ecb\u5165\u65f6\uff0c\u4f1a\u6784\u9020\u76f8\u5e94\u7684\u5de5\u5177\u8c03\u7528\u8bf7\u6c42\u3002</p> <pre><code>from aworld.tools.human.human import HUMAN\nagent = Agent(\n    conf=agent_config,\n    name='human_test',\n    tool_names=[HUMAN]\n)\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E4%BA%BA%E6%9C%BA%E5%8D%8F%E5%90%8C%EF%BC%88HITL%EF%BC%89/#_3","title":"\u5b9a\u4e49\u89c4\u5219\u4ecb\u5165","text":"<p>\u8fd8\u53ef\u4ee5\u9884\u8bbe\u89c4\u5219\uff0c\u547d\u4e2d\u89c4\u5219\u540e\uff0c\u76f4\u63a5\u89e6\u53d1\u7528\u6237\u4ecb\u5165\u3002\u4f8b\u5982\uff1a</p> <p>\u5f53\u7ec8\u7aef\u547d\u4ee4\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u65f6\uff0c\u53d1\u9001\"\u5f53\u524d\u64cd\u4f5c\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u6388\u6743\u6267\u884c\u6b64\u547d\u4ee4\"\u7684\u63d0\u793a</p> <pre><code>from aworld.tools.human.human import HUMAN\nfrom aworld.utils.run_util import exec_tool\n\n# \u547d\u4e2d\u540e\u89e6\u53d1\ncontext = your_context or Context()\nexec_tool(tool_name=HUMAN, action_name=\"HUMAN_CONFIRM\", \n          params={\"confirm_content\": \"\u5f53\u524d\u64cd\u4f5c\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u6388\u6743\u6267\u884c\u6b64\u547d\u4ee4\"}, \n          agent_name=\"human\", context=context)\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E4%BA%BA%E6%9C%BA%E5%8D%8F%E5%90%8C%EF%BC%88HITL%EF%BC%89/#_4","title":"\u89e6\u53d1\u6761\u4ef6","text":"<p>\u4eba\u673a\u534f\u540c\u53ef\u4ee5\u5728\u4ee5\u4e0b\u60c5\u51b5\u4e0b\u89e6\u53d1\uff1a</p> <ul> <li>\u6d4f\u89c8\u5668\u64cd\u4f5c\u5de5\u5177\u9047\u5230\u767b\u5f55/\u8ba4\u8bc1/\u652f\u4ed8\u9875\u9762</li> <li>\u7ec8\u7aef\u5de5\u5177\u9700\u8981sudo/\u7ba1\u7406\u5458\u6743\u9650</li> <li>\u6587\u4ef6\u7cfb\u7edf\u5de5\u5177\u8bbf\u95ee\u53d7\u4fdd\u62a4\u76ee\u5f55</li> <li>\u4fe1\u606f\u6536\u96c6\u548c\u5206\u6790\u4efb\u52a1\uff0c\u9700\u8981\u8865\u5145\u7528\u6237\u7684\u4e13\u4e1a\u77e5\u8bc6</li> <li>\u5185\u5bb9\u68c0\u7d22\uff0c\u9700\u8981\u8865\u5145\u989d\u5916\u7684\u68c0\u7d22\u6761\u4ef6</li> <li>\u6570\u636e\u5904\u7406\u548c\u62a5\u544a\u751f\u6210\uff0c\u9700\u8981\u201c\u7b7e\u5b57\u201d\u751f\u6548</li> <li>\u51b3\u7b56\u5236\u5b9a\u6216\u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u9700\u8981\u505a\u5408\u89c4\u786e\u8ba4</li> <li>\u5bfb\u6c42\u64cd\u4f5c\u6279\u51c6</li> </ul>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E4%BA%BA%E6%9C%BA%E5%8D%8F%E5%90%8C%EF%BC%88HITL%EF%BC%89/#_5","title":"\u5c0f\u7ed3","text":"<p>AWorld\u7684\u4eba\u673a\u534f\u540c\u80fd\u529b\u901a\u8fc7\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u5de5\u5177\u7cfb\u7edf\u3001\u6d88\u606f\u4f20\u9012\u673a\u5236\u548c\u4f7f\u7528\u89c4\u8303\uff0c\u5b9e\u73b0\u4e86\u5728\u5fc5\u8981\u65f6\u523b\u5f15\u5165\u7528\u6237\u5224\u65ad\u7684\u673a\u5236\u3002\u63d0\u5347\u4e86\u7cfb\u7edf\u7684\u5b89\u5168\u6027\u548c\u53ef\u9760\u6027\uff0c\u4e5f\u4f53\u73b0\u4e86AI\u7cfb\u7edf\u5e94\u8be5\u662f\u53ef\u63a7\u8bbe\u8ba1\u7684\u7406\u5ff5\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0cAWorld\u6846\u67b6\u5728\u4fdd\u6301AI\u81ea\u4e3b\u6027\u7684\u540c\u65f6\uff0c\u786e\u4fdd\u4e86\u7528\u6237\u5728\u5173\u952e\u65f6\u523b\u7684\u63a7\u5236\u6743\uff0c\u4e3a\u6784\u5efa\u53ef\u4fe1\u8d56\u7684AI\u7cfb\u7edf\u63d0\u4f9b\u4e86\u575a\u5b9e\u57fa\u7840\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%B9%B6%E8%A1%8C%E4%BB%BB%E5%8A%A1%EF%BC%88Parallel%20Tasks%EF%BC%89/","title":"\u5e76\u884c\u4efb\u52a1\uff08Parallel Tasks\uff09","text":"<p>AWorld\u652f\u6301\u591a\u79cd\u4efb\u52a1\u5e76\u884c\u6267\u884c\uff0c\u800c\u4e14\u4e0d\u4ec5\u80fd\u5728\u672c\u5730\u591a\u8fdb\u7a0b\u5e76\u884c\uff0c\u8fd8\u80fd\u65e0\u7f1d\u96c6\u6210\u5206\u5e03\u5f0f\u8ba1\u7b97\u5f15\u64ce\u5982Ray\u548cSpark\uff0c\u4f7f\u5f97\u5927\u89c4\u6a21\u4efb\u52a1\u5e76\u884c\u5904\u7406\u53d8\u5f97\u7b80\u5355\u800c\u9ad8\u6548\u3002\u4e3b\u8981\u57fa\u4e8e\u4ee5\u4e0b\u51e0\u4e2a\u6838\u5fc3\u7406\u5ff5\uff1a</p> <ul> <li>\u7edf\u4e00\u62bd\u8c61\uff1a\u65e0\u8bba\u5e95\u5c42\u4f7f\u7528\u4f55\u79cd\u8ba1\u7b97\u5f15\u64ce\uff08\u672c\u5730\u3001Ray\u8fd8\u662fSpark\uff09\uff0c\u5bf9\u7528\u6237\u63d0\u4f9b\u7684API\u63a5\u53e3\u662f\u4e00\u81f4\u7684\u3002</li> <li>\u900f\u660e\u5207\u6362\uff1a\u7528\u6237\u53ef\u4ee5\u6839\u636e\u9700\u8981\u5728\u4e0d\u540c\u8ba1\u7b97\u5f15\u64ce\u4e4b\u95f4\u8f7b\u677e\u5207\u6362\uff0c\u65e0\u9700\u4fee\u6539\u4e1a\u52a1\u903b\u8f91\u3002</li> <li>\u9ad8\u53ef\u6269\u5c55\uff1a\u6846\u67b6\u8bbe\u8ba1\u652f\u6301\u4ece\u5c0f\u89c4\u6a21\u672c\u5730\u6d4b\u8bd5\u5230\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u751f\u4ea7\u73af\u5883\u7684\u5e73\u6ed1\u8fc7\u6e21\u3002</li> </ul> <p>AWorld\u901a\u8fc7\u7cbe\u5de7\u7684\u8bbe\u8ba1\u548c\u9ad8\u5ea6\u7684\u62bd\u8c61\uff0c\u5b9e\u73b0\u4e86\u5728\u591a\u79cd\u8ba1\u7b97\u5f15\u64ce\u4e0a\u7684\u7edf\u4e00\u5e76\u884c\u5904\u7406\uff0c\u901a\u8fc7\u4e00\u81f4\u7684API\u8f7b\u677e\u5b9e\u73b0\u4efb\u52a1\u5e76\u884c\u5316\uff0c\u63d0\u9ad8\u5f00\u53d1\u6548\u7387\u548c\u7cfb\u7edf\u6027\u80fd\uff0c\u4f7f\u591a\u4efb\u52a1\u7684\u6267\u884c\u6709\u5f88\u5927\u7684\u4f18\u52bf\uff1a</p> <ul> <li>\u63d0\u9ad8\u6267\u884c\u6548\u7387\u3002\u901a\u8fc7\u5e76\u884c\u6267\u884c\u591a\u4e2a\u4efb\u52a1\uff0c\u663e\u8457\u7f29\u77ed\u6574\u4f53\u6267\u884c\u65f6\u95f4\uff0c\u7279\u522b\u662f\u5728\u5904\u7406\u5927\u91cf\u72ec\u7acb\u4efb\u52a1\u65f6\u6548\u679c\u66f4\u4e3a\u660e\u663e\u3002</li> <li>\u7075\u6d3b\u7684\u90e8\u7f72\u9009\u9879\u3002\u7528\u6237\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u6267\u884c\u5f15\u64ce\uff0c\u4ece\u672c\u5730\u5f00\u53d1\u6d4b\u8bd5\u5230\u5927\u89c4\u6a21\u751f\u4ea7\u90e8\u7f72\u90fd\u53ef\u4ee5\u5e73\u6ed1\u8fc7\u6e21\u3002</li> <li>\u7b80\u5316\u5206\u5e03\u5f0f\u3002\u9690\u85cf\u4e86\u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u590d\u6742\u6027\uff0c\u8ba9\u5f00\u53d1\u8005\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u4e1a\u52a1\u903b\u8f91\u800c\u4e0d\u662f\u5e95\u5c42\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u7ec6\u8282\u3002</li> <li>\u5f3a\u5927\u7684\u6269\u5c55\u6027\u3002\u6a21\u5757\u5316\u63d2\u4ef6\u5316\u8bbe\u8ba1\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u6dfb\u52a0\u65b0\u7684\u8ba1\u7b97\u5f15\u64ce\u652f\u6301\uff0c\u6ee1\u8db3\u4e0d\u65ad\u53d8\u5316\u7684\u9700\u6c42\u3002</li> </ul>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%B9%B6%E8%A1%8C%E4%BB%BB%E5%8A%A1%EF%BC%88Parallel%20Tasks%EF%BC%89/#_1","title":"\u4efb\u52a1\u6267\u884c\u6d41\u7a0b","text":""},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%B9%B6%E8%A1%8C%E4%BB%BB%E5%8A%A1%EF%BC%88Parallel%20Tasks%EF%BC%89/#_2","title":"\u8fd0\u884c\u65f6\u5f15\u64ce","text":"<p>AWorld\u76ee\u524d\u652f\u6301\u4e09\u79cd\u5f15\u64ce\uff1a</p> <ul> <li>LocalRuntime\uff1a\u672c\u5730\u591a\u8fdb\u7a0b\u6267\u884c\u5f15\u64ce\uff0c\u65e0\u9700\u989d\u5916\u4f9d\u8d56\uff0c\u9002\u7528\u4e8e\u5f00\u53d1\u548c\u5c0f\u89c4\u6a21\u90e8\u7f72</li> <li>RayRuntime\uff1a\u57fa\u4e8eRay\u7684\u5206\u5e03\u5f0f\u6267\u884c\u5f15\u64ce\uff0c\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u5e76\u884c\u5904\u7406</li> <li>SparkRuntime\uff1a\u57fa\u4e8eApache Spark\u7684\u6267\u884c\u5f15\u64ce\uff0c\u9002\u7528\u4e8e\u5927\u6570\u636e\u5904\u7406\u573a\u666f</li> </ul>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%B9%B6%E8%A1%8C%E4%BB%BB%E5%8A%A1%EF%BC%88Parallel%20Tasks%EF%BC%89/#_3","title":"\u8fd0\u884c\u65f6\u914d\u7f6e","text":"<p>RunConfig\u662f\u5207\u6362\u8fd0\u884c\u65f6\u8ba1\u7b97\u7684\u5173\u952e\u3002\u8bbe\u7f6e\u76f8\u5173\u5c5e\u6027\uff0c\u4ee5\u5b9e\u73b0\u66f4\u9ad8\u6548\u7684\u8ba1\u7b97\u3002\u5982\u9009\u62e9\u4f7f\u7528\u54ea\u79cd\u8ba1\u7b97\u5f15\u64ce<code>engine_name</code>\uff0c\u4efb\u52a1\u662f\u5426\u6709\u4f9d\u8d56<code>sequence_dependent</code>\uff0c\u5bf9\u4e8e\u5206\u5e03\u5f0f\u5f15\u64ce\u662f\u5426\u4f7f\u7528\u672c\u5730\u6a21\u5f0f<code>in_local</code>\uff0c\u540c\u65f6\u652f\u6301\u81ea\u5b9a\u4e49\u7684RuntimeEngine\u5b9e\u73b0<code>cls</code>\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%B9%B6%E8%A1%8C%E4%BB%BB%E5%8A%A1%EF%BC%88Parallel%20Tasks%EF%BC%89/#_4","title":"\u7edf\u4e00\u5165\u53e3","text":"<p>Runners\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u5de5\u5177\u5316\u5165\u53e3\uff0c\u5185\u90e8\u4e5f\u63d0\u4f9b\u4e86exec_tasks\u7684\u5de5\u5177\u5316\u65b9\u6cd5\uff0c\u4fbf\u6377\u7684\u652f\u6301\u4efb\u52a1\u968f\u65f6\u63d0\u4ea4\u548c\u968f\u65f6\u8fd0\u884c\u3002</p> <pre><code>from aworld.core.task import Task\nfrom aworld.runner import Runners\nfrom aworld.config import RunConfig, EngineName\n\n# \u521b\u5efa\u4efb\u52a1\u5217\u8868\ntasks = [\n    Task(input=\"\u4ec0\u4e48\u662f\u673a\u5668\u5b66\u4e60?\", agent=my_agent, id=\"task1\"),\n    Task(input=\"\u89e3\u91ca\u795e\u7ecf\u7f51\u7edc\", agent=my_agent, id=\"task2\"),\n    Task(input=\"\u4ec0\u4e48\u662f\u6df1\u5ea6\u5b66\u4e60?\", agent=my_agent, id=\"task3\")\n]\n# \u4f7f\u7528Ray\u5f15\u64ce\u5e76\u884c\u6267\u884c\nrun_conf=RunConfig(\n    engine_name=EngineName.RAY,\n    worker_num=len(tasks)\n)\n\n# \u5de5\u5177\u5316\u5165\u53e3\nresults = Runners.sync_run_task(\n    task=tasks,\n    run_conf=run_conf\n)\n\nfrom aworld.utils.run_util import exec_tasks\n\n# \u5185\u90e8\u5de5\u5177\u5316\u65b9\u6cd5\nexec_tasks(tasks=tasks, run_conf=run_conf)\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%B9%B6%E8%A1%8C%E4%BB%BB%E5%8A%A1%EF%BC%88Parallel%20Tasks%EF%BC%89/#agent","title":"Agent\u5e76\u884c","text":"<p>\u4efb\u52a1\u7684\u7c92\u5ea6\u6bd4Agent\u7c97\uff0c\u5982\u679c\u5e0c\u671b\u5728Agent\u7ef4\u5ea6\u6307\u5b9a\u5e76\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528<code>ParallelizableAgent</code>\uff1a</p> <pre><code>sub_agents = [google_search, bing_search, wiki, ...]\nparallel_agent = ParallelizableAgent(name=f\"parallel_search\",\n                                     agents=sub_agents)\n</code></pre> <p>\u7528\u6237\u8fd8\u53ef\u4ee5\u81ea\u5b9a\u4e49\u7ed3\u679c\u805a\u5408\u51fd\u6570\u6765\u5904\u7406\u5e76\u884c\u4efb\u52a1\u7684\u7ed3\u679c\uff1a</p> <pre><code>def custom_aggregate_func(agent: ParallelizableAgent, results: Dict[str, Any]) -&gt; ActionModel:\n    # \u81ea\u5b9a\u4e49\u805a\u5408\u903b\u8f91\n    aggregated_result = \"...\u5904\u7406\u6240\u6709\u5e76\u884c\u7ed3\u679c...\"\n    return ActionModel(policy_info=aggregated_result)\n\nparallel_agent = ParallelizableAgent(\n    agents=sub_agents,\n    aggregate_func=custom_aggregate_func\n)\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/","title":"\u5feb\u901f\u5f00\u59cb\uff08Quick Start\uff09","text":"<p>AWorld \u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7b80\u5355\u7684 Agent \u5f00\u53d1\u5e93\uff0c\u5b83\u66f4\u50cf\u662f\u4e00\u4e2a\u5de5\u4e1a\u7ea7\u7684 Agent \u751f\u4ea7\u7ebf\u3002</p> <ul> <li>\u5bf9\u4e8e\u4f7f\u7528\u8005\uff1a\u5b83\u63d0\u4f9b\u4e86\u7cfb\u5217\u7684\u4fbf\u6377\u5de5\u5177\uff0c\u80fd\u591f\u4e00\u884c\u5b9a\u4e49Agent\u548c\u6784\u5efa\u591aAgent\u7684\u534f\u4f5c\u3002</li> <li>\u5bf9\u4e8e\u5f00\u53d1\u8005\uff1a\u5b83\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u539f\u5b50\u529f\u80fd\u548c\u53ef\u6269\u5c55\u63a5\u53e3\uff0c\u5e2e\u52a9\u6784\u5efa\u771f\u6b63\u7684\u751f\u4ea7\u5e94\u7528\u3002</li> <li>\u5bf9\u4e8e\u7814\u7a76\u5458\uff1a\u5b83\u63d0\u4f9b\u4e86\u4ece\u6570\u636e\u6536\u96c6\u5230 RL \u8bad\u7ec3\u7684\u5b8c\u6574 Pipeline\uff0c\u662f\u590d\u73b0 SOTA \u6548\u679c\u7684\u5229\u5668\u3002</li> </ul> <p>AWorld\u4e3a\u6784\u5efa\u3001\u90e8\u7f72\u548c\u8fdb\u5316\u590d\u6742\u7684\u591a\u667a\u80fd\u4f53\u7cfb\u7edf\u63d0\u4f9b\u4e86\u5b8c\u6574\u89e3\u51b3\u65b9\u6848\u3002\u5982\u679c\u60a8\u5e0c\u671b\u6784\u5efa\u80fd\u591f\u81ea\u6211\u8fdb\u5316\u3001\u5904\u7406\u590d\u6742\u957f\u7a0b\u4efb\u52a1\u7684\u667a\u80fd\u4f53\u7cfb\u7edf\uff0cAWorld \u662f\u76ee\u524d\u5f00\u6e90\u793e\u533a\u4e2d\u8f83\u597d\u7684\u9009\u62e9\u4e4b\u4e00\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#agent","title":"Agent","text":""},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#_1","title":"\u524d\u7f6e\u4f9d\u8d56","text":"<ul> <li>Python 3.11 \u6216\u66f4\u9ad8</li> <li>pip\u5b89\u88c5\u7ba1\u7406\u5668</li> <li>Git</li> </ul>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#_2","title":"\u6b65\u9aa4","text":""},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#1","title":"1. \u514b\u9686\u9879\u76ee","text":"<pre><code>git clone https://github.com/inclusionAI/AWorld.git\ncd AWorld\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#2","title":"2. \u5b89\u88c5","text":"<pre><code># Install in development mode\npip install -e .\n\n# Or install \npip install aworld\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#3","title":"3. \u914d\u7f6e\u73af\u5883\u53d8\u91cf","text":"<p>\u5efa\u8bae\u5728\u6839\u8def\u5f84\u521b\u5efa.env\u6587\u4ef6\uff0c\u5185\u5bb9\u793a\u4f8b\uff1a</p> <pre><code># LLM Configuration\nLLM_PROVIDER=openai\nLLM_MODEL_NAME=gpt-4\nLLM_API_KEY=your-api-key-here\nLLM_BASE_URL=https://api.openai.com/v1\nLLM_TEMPERATURE=0.7\n\n# Other Variables\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#4","title":"4. \u5b89\u88c5\u9a8c\u8bc1","text":"<pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.log.util import logger\n\nlogger.info(\"\u2705 AWorld installed successfully!\")\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#_3","title":"\u73af\u5883","text":""},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#_4","title":"\u524d\u7f6e\u4f9d\u8d56","text":"<ul> <li>Docker</li> <li>Docker Compose</li> </ul>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#_5","title":"\u6b65\u9aa4","text":""},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#1_1","title":"1. \u4f9d\u8d56\u9a8c\u8bc1","text":"<pre><code># Verify Docker versions\ndocker --version\ndocker compose --version\n\n# Confirm the Docker daemon is running\ndocker ps\ndocker compose ps\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#2_1","title":"2. \u914d\u7f6e","text":"<p>\u521b\u5efa.env\u6587\u4ef6\uff0c\u5982\u4ece\u9879\u76ee\u4e2d\u62f7\u8d1d\u540e\u4fee\u6539\uff1a</p> <pre><code>cp ./gaia-mcp-server/mcp_servers/.env_template ./gaia-mcp-server/mcp_servers/.env\n</code></pre> <p>\u5982\u679c\u4f7f\u7528gaia-mcp-server\uff0c\u9700\u8981GAIA\u6570\u636e\u96c6\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#3-mcp","title":"3. \u542f\u52a8MCP\u670d\u52a1","text":"<pre><code>sh run-local.sh\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#4-mcp","title":"4. \u8fde\u63a5MCP\u670d\u52a1","text":"<p>\u4f7f\u7528\u4ee5\u4e0b\u914d\u7f6e\u8fde\u63a5\u5df2\u542f\u52a8\u7684MCP\u670d\u52a1\uff1a</p> <pre><code>{\n    \"virtualpc-mcp-server\": {\n        \"type\": \"streamable-http\",\n        \"url\": \"http://localhost:8000/mcp\",\n        \"timeout\": 6000,\n        \"sse_read_timeout\": 6000,\n        \"client_session_timeout_seconds\": 6000\n    }\n}\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#_6","title":"\u8bad\u7ec3","text":""},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#_7","title":"\u524d\u7f6e\u4f9d\u8d56","text":"<ul> <li>aworld</li> <li>AWorld env</li> <li>\u7279\u5b9a\u7684\u8bad\u7ec3\u6846\u67b6</li> </ul>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#_8","title":"\u6b65\u9aa4","text":"<p>\u4ee5VeRL\u4e3a\u4f8b\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#1_2","title":"1. \u955c\u50cf","text":"<p>\u4f7f\u7528\u6307\u5b9a\u8bad\u7ec3\u6846\u67b6\u7684\u955c\u50cf\uff0c\u5982\uff1averl0.5-cu126-torch2.7.1-fa2.8.0\uff0c\u5730\u5740\uff1ahttps://github.com/volcengine/verl/tree/main/docker</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#2-agent","title":"2. \u5b9a\u4e49Agent","text":"<p>\u5b9a\u4e49\u60f3\u8981\u8bad\u7ec3\u7684Agent\uff1a</p> <pre><code># \u5b9a\u4e49agent\nagent = Agent(\n    name=\"train_agent\",\n    desc=\"train_agent\",\n    system_prompt=\"train agent system prompt\",\n    mcp_config=mcp_config,\n    mcp_servers=[your_server],\n    conf=agent_config\n)\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#3_1","title":"3. \u9009\u62e9\u6570\u636e\u96c6","text":"<p>\u4ece\u672c\u5730\u6587\u4ef6\u8def\u5f84\uff0c\u6216Huggingface Dateset\u4e2d\u6307\u5b9a\u8def\u5f84\u6216\u52a0\u8f7d\u6570\u636e\u96c6\uff08\u9700\u4e8c\u6b21\u52a0\u5de5\u573a\u666f\uff09\u3002\u5982\uff1a</p> <pre><code># \u5b9a\u4e49\u6570\u636e\u96c6\ntrain_dataset, test_dataset = \"/Users/your_name/dataset/train\", \"/Users/your_name/dataset/test\"\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#4_1","title":"4. \u8bad\u7ec3\u914d\u7f6e","text":"<p>\u57fa\u4e8e\u7279\u5b9a\u7684\u8bad\u7ec3\u6846\u67b6\uff0c\u81ea\u5b9a\u4e49\u914d\u7f6e\u9879\u3002</p> <p>\u6ce8\u610f\uff1a\u9700\u8981\u6839\u636e\u5177\u4f53\u7684\u4efb\u52a1\u76ee\u6807\uff0c\u5b9a\u4e49\u7528\u4e8e\u8bc4\u4f30\u667a\u80fd\u4f53\u884c\u4e3a\u7684\u5956\u52b1\u51fd\u6570\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u5728\u8bad\u7ec3\u914d\u7f6e\u3002</p> <pre><code># \u5b9a\u4e49\u8bad\u7ec3\u914d\u7f6e\ncustom_train_config = \"string or json\"\n# \u5b9a\u4e49reward\nreward_func = \"None or string\"\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Quick%20Start%EF%BC%89/#5","title":"5. \u8fd0\u884c","text":"<p>\u6784\u5efatrainer\u5b9e\u4f8b\u5e76\u542f\u52a8\u8bad\u7ec3\u3002</p> <p>\u6ce8\uff1a\u5982\u679creward_func\u662f\u4ee3\u7801\u5f15\u7528(\u5982gaia_reward\u51fd\u6570)\uff0c\u9700\u8981\u4f5c\u4e3aAgentTrainer\u7684\u53c2\u6570\u3002</p> <pre><code>from train.trainer.agent_trainer import AgentTrainer\n\ntrainer = AgentTrainer(agent=agent,\n                       config=custom_train_config,\n                       reward_func=reward_func,\n                       train_dataset=train_dataset,\n                       test_dataset=test_dataset)\ntrainer.train()\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%80%BB%E8%A7%88%20%28Overview%29/","title":"\u603b\u89c8 (Overview)","text":"<p>\u6b22\u8fce\u6765\u5230AWorld\u2014\u2014\u4e00\u4e2a\u53cb\u597d\u4fbf\u6377\u7684\u6784\u5efa\uff0c\u7f16\u6392\uff0c\u8bc4\u4f30\u548c\u8fdb\u5316AI Agent\u7684\u57fa\u7840\u6846\u67b6\u3002AWorld\u4e3a\u81ea\u6211\u8fdb\u5316\u7684AI Agent\u63d0\u4f9b\u4e86\u7cfb\u5217\u7684\u57fa\u7840\u548c\u9ad8\u7ea7\u7ec4\u4ef6\uff0c\u4ee5\u5904\u7406\u5404\u79cd\u7c7b\u578b\u7684\u4efb\u52a1\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%80%BB%E8%A7%88%20%28Overview%29/#aworld","title":"AWorld\u662f\u4ec0\u4e48","text":"<p>\u81f4\u529b\u4e8e\u7aef\u5230\u7aef\u7684Multi-Agent\u6846\u67b6\uff0c\u6838\u5fc3\u613f\u666f\u662f\u6253\u901a\u4ece\u201c\u667a\u80fd\u4f53\u6784\u5efa\u201d\u5230\u201c\u73af\u5883\u4ea4\u4e92\u201d\u518d\u5230\u201c\u81ea\u8fdb\u5316\u201d\u7684\u5b8c\u6574\u95ed\u73af\uff0c\u4f7f\u60a8\u80fd\u591f\u8f7b\u677e\uff1a</p> <ul> <li> <p>\ud83e\udd16 \u6784\u5efa\u667a\u80fd\u4ee3\u7406\u2014\u2014\u58f0\u660e\u5f0f\u521b\u5efa\u57fa\u4e8eLLM\u7684AI\u4ee3\u7406</p> </li> <li> <p>\ud83d\udd04 \u7f16\u6392\u591a\u4ee3\u7406\u534f\u4f5c\u2014\u2014\u4f7f\u7528\u4ea4\u63a5\u548c\u5de5\u4f5c\u6d41\u6784\u5efa\u590d\u6742\u7684\u591a\u4ee3\u7406\u7cfb\u7edf</p> </li> <li> <p>\ud83d\udcda \u83b7\u53d6\u5b8c\u6574\u8ffd\u8e2a\u2014\u2014\u8bb0\u5f55token\u7ea7\u522b\u7684\u8be6\u7ec6\u6267\u884c\u8f68\u8ff9</p> </li> <li> <p>\ud83c\udf0d \u4f7f\u7528\u591a\u5143\u73af\u5883\u2014\u2014\u63d0\u4f9b\u53ef\u6269\u5c55\u7684\u5de5\u5177\u73af\u5883\uff0c\u8fde\u63a5\u4e09\u65b9\u73af\u5883</p> </li> <li> <p>\ud83e\udde0 \u81ea\u6211\u6539\u8fdb\u2014\u2014\u4f7f\u4ee3\u7406\u80fd\u591f\u4ece\u7ecf\u9a8c\u4e2d\u5b66\u4e60\u5e76\u4f18\u5316\u81ea\u5df1</p> </li> </ul> <p>\u4e0e\u4f20\u7edf\u7684 Agent \u6846\u67b6\uff08\u5982 LangChain\u3001AutoGPT\uff0c ADK\uff09\u4e0d\u540c\uff0cAWorld \u76f8\u6bd4\u4fa7\u91cd\u4e8e Agentic Learning\uff08\u667a\u80fd\u4f53\u5b66\u4e60\uff09\uff0c\u5373\u5982\u4f55\u8ba9\u667a\u80fd\u4f53\u5728\u52a8\u6001\u73af\u5883\u4e2d\u901a\u8fc7\u53cd\u9988\uff08RL\uff09\u4e0d\u65ad\u63d0\u5347\u80fd\u529b\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u6267\u884c\u4efb\u52a1\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%80%BB%E8%A7%88%20%28Overview%29/#_1","title":"\u6838\u5fc3\u6982\u5ff5","text":"<ol> <li>Agent\uff1a\u57fa\u4e8e\u89c4\u5219\u6216\u6a21\u578b\u7684\u5b9e\u4f53\uff0c\u53ef\u4ee5\u8fdb\u884c\u63a8\u7406\u3001\u4f7f\u7528\u5de5\u5177\u5e76\u4e0e\u5176\u5b83\u667a\u80fd\u4f53\u534f\u4f5c\u3002</li> <li>Swarm\uff1a\u591a\u4e2a\u667a\u80fd\u4f53(Multi-Agent)\u534f\u4f5c\u53ca\u8303\u5f0f\u5b9a\u4e49\u548c\u6784\u5efa\u7684\u7edf\u4e00\u62d3\u6251\u6a21\u578b\u3002</li> <li>Tool\uff1a\u4e3a\u667a\u80fd\u4f53\u63d0\u4f9b\u8d85\u51faLLM\u80fd\u529b\u7684\u5b9e\u4f53\uff0c\u4f7fAgent\u80fd\u591f\u5b8c\u6210\u66f4\u591a\u66f4\u590d\u6742\u7684\u4efb\u52a1\u3002</li> <li>Sandbox\uff1a\u667a\u80fd\u4f53\u53ef\u4ee5\u5b89\u5168\u5730\u6267\u884c\u4ee3\u7801\u6216\u64cd\u4f5c\u5916\u90e8\u8f6f\u4ef6\u7684\u6c99\u7bb1\u73af\u5883\u3002</li> <li>Runner\uff1aAWorld \u7684\u8c03\u5ea6\u6267\u884c\u5f15\u64ce\uff0c\u8d1f\u8d23\u4efb\u52a1\u7684\u5206\u53d1\u3001\u72b6\u6001\u7684\u8f6e\u8f6c\u3001\u4e32\u5e76\u884c\u6267\u884c\u4ee5\u53ca\u4ea4\u4e92\u8f68\u8ff9\u7684\u8bb0\u5f55\u3002</li> <li>Context\uff1a\u4efb\u52a1\u6267\u884c\u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\uff0c\u4ee5\u652f\u6301\u72b6\u6001\u8ddf\u8e2a\u548c\u6062\u590d\u3002</li> <li>Memory\uff1a\u7528\u4e8e\u5b58\u50a8\u548c\u68c0\u7d22\u667a\u80fd\u4f53\u5728\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u4fe1\u606f\uff0c\u652f\u6301\u77ed\u671f\u548c\u957f\u671f\u8bb0\u5fc6\u7ba1\u7406\u3002</li> <li>Environment\uff1a\u63d0\u4f9b\u667a\u80fd\u4f53\u53ef\u4ee5\u4e0e\u4e4b\u4ea4\u4e92\u7684\u5de5\u5177\u548c\u8d44\u6e90API\u7684\u73af\u5883\u3002</li> <li>Trainer\uff1a\u7528\u4e8e\u8bad\u7ec3\u548c\u4f18\u5316\u4ee3\u7406\u884c\u4e3a\u7684\u6a21\u5757\uff0c\u901a\u5e38\u5305\u62ec\u5f3a\u5316\u5b66\u4e60\u6216\u5176\u4ed6\u673a\u5668\u5b66\u4e60\u65b9\u6cd5\u3002</li> <li>Evaluation\uff1a\u8bc4\u6d4b\u667a\u80fd\u4f53\u76f8\u5173\u80fd\u529b\u6307\u6807\u7684\u8bc4\u4f30\u6846\u67b6\u3002</li> <li>Tracer\uff1a\u7528\u4e8e\u8ffd\u8e2a\u4ee3\u7406\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u8be6\u7ec6\u6b65\u9aa4\u548c\u72b6\u6001\u53d8\u5316\uff0c\u4ee5\u4fbf\u8c03\u8bd5\u548c\u5206\u6790\u3002</li> <li>Output\uff1a\u7ba1\u7406\u7cfb\u7edf\u8f93\u51fa\u7ed3\u679c\uff0c\u5305\u62ec\u65e5\u5fd7\u3001\u62a5\u544a\u548c\u53ef\u89c6\u5316\u6570\u636e\u3002</li> </ol> <p>\u5728\u4e00\u4e9b\u6838\u5fc3\u6982\u5ff5\u4e0b\uff0c\u8fd8\u4f1a\u6709\u4e00\u4e9b\u5b50\u6982\u5ff5\uff0c\u6bd4\u5982</p> <ul> <li>Agent\u4f1a\u4f7f\u7528\u6a21\u578b(Models)\u548cMCP\u5de5\u5177\u5b8c\u6210\u4efb\u52a1\uff0c</li> <li>Tool\u6709\u591a\u4e2a\u6267\u884c\u52a8\u4f5c(Action)\uff0c</li> <li>Runner\u57fa\u4e8e\u4e8b\u4ef6(Event)\u673a\u5236\u63d0\u4f9b\u4e86\u4efb\u52a1(Task)\u7684\u7f16\u6392\u6267\u884c(Handler)\u548c\u56de\u8c03(Callback)\uff0c\u5728\u94fe\u8def\u4e2d\u53ef\u4ee5\u6ce8\u5165\u94a9\u5b50(Hook)\u3002</li> </ul>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%80%BB%E8%A7%88%20%28Overview%29/#_2","title":"\u67b6\u6784","text":"<p>AWorld \u7684\u5178\u578b\u8fd0\u884c\u67b6\u6784\u662f\u4e00\u4e2a\u53cd\u9988\u63a7\u5236\u56de\u8def\uff1a</p> <ul> <li>\u611f\u77e5\uff1a\u5c06 Environment \u7684\u5f53\u524d\u72b6\u6001\uff08Observation\uff09\u4f20\u9012\u7ed9 Agent\u3002 </li> <li>\u51b3\u7b56\uff1a\u6784\u5efa\u7684 Agent \u7ed3\u5408\u6a21\u578b\uff0c\u89c4\u5219\u548c\u4e0a\u4e0b\u6587\uff0c\u751f\u6210\u4e0b\u4e00\u6b65\u52a8\u4f5c\uff08Action\uff09\u3002</li> <li>\u6267\u884c\uff1aEnvironment \u6267\u884c\u6307\u5b9a\u7684 Action\uff0c\u4ea7\u751f\u65b0\u7684 Observation \u548c \u53cd\u9988\uff08Reward\uff09\u3002</li> <li>\u7ecf\u9a8c\uff1a\u901a\u8fc7 Agent \u4e0e\u73af\u5883\u4ea4\u4e92\uff0c\u6536\u96c6\u6210\u529f\u6216\u5931\u8d25\u7684\u8f68\u8ff9\u6570\u636e\uff08Trajectory\uff09\u3002</li> <li>\u5b66\u4e60\uff1a\u8bb0\u5f55\u8f68\u8ff9\u6570\u636e\uff08Trajectory\uff09\uff0c\u7528\u4e8e\u540e\u7eed\u7684 RL \u8bad\u7ec3\u6216 In-context Learning \u4f18\u5316\uff0c\u5b9e\u73b0\u81ea\u6211\u8fdb\u5316\u3002</li> </ul> <p></p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%80%BB%E8%A7%88%20%28Overview%29/#_3","title":"\u5173\u952e\u7279\u6027","text":"<p>AWorld \u5728\u529f\u80fd\u8bbe\u8ba1\u4e0a\u517c\u987e\u4e86\u7075\u6d3b\u6027\u4e0e\u751f\u4ea7\u7ea7\u7684\u9ad8\u6027\u80fd\u9700\u6c42\uff0c\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u7279\u6027\u7528\u4ee5\u66f4\u597d\u5730\u652f\u6301 Agent \u5e94\u7528\u7a0b\u5e8f\u548c\u4ea7\u54c1\uff1a</p> <ol> <li> <p>\u7b80\u5355\u7075\u6d3b\u4e14\u5f3a\u5927\u7684\u591a\u667a\u80fd\u4f53\u534f\u4f5c</p> <p>\u4ee5\u7edf\u4e00\u7684\u56fe\u8bed\u6cd5\u6784\u5efa\u4e2d\u5fc3\u5316\u548c\u53bb\u4e2d\u5fc3\u5316\u7684\u591a\u667a\u80fd\u4f53\u534f\u4f5c\u548c\u534f\u4f5c\u8303\u5f0f\uff0c\u5141\u8bb8 Multi-agent \u7684\u7ec4\u5408\u3001\u5d4c\u5957\u3002\u652f\u6301 Workflow\u3001Handoff\u3001Team \u7b49\u6a21\u5f0f\uff0c\u7528\u4ee5\u6784\u5efa\u590d\u6742\u7684\u534f\u4f5c\u7cfb\u7edf\u3002</p> </li> <li> <p>\u4e30\u5bcc\u7684\u5de5\u5177\u4f7f\u7528\u6a21\u5f0f</p> <p>\u652f\u6301\u591a\u79cd\u5de5\u5177\u96c6\u6210\u65b9\u5f0f\uff1a</p> <ul> <li>\u672c\u5730\u5de5\u5177</li> <li>MCP \u5de5\u5177</li> <li>Agent \u4f5c\u4e3a\u5de5\u5177 (Agent as a Tool)</li> <li>\u7f16\u7a0b\u5f0f\u5de5\u5177\u8c03\u7528 (Programmatic Tool Calling, PTC)</li> <li>\u591a\u6837\u5316\u7684\u8fd0\u884c\u65f6</li> </ul> <p>\u652f\u6301\u591a\u79cd\u8fd0\u884c\u65f6\u540e\u7aef\uff0c\u5305\u62ec\u672c\u5730\u3001Spark\u3001Ray\u7b49\uff0c\u901a\u8fc7\u7edf\u4e00\u63a5\u53e3\u5b9e\u73b0\u65e0\u7f1d\u5207\u6362\uff0c\u65e0\u9700\u66f4\u6539\u4efb\u52a1\u5b9a\u4e49\u5373\u53ef\u5728\u4e0d\u540c\u73af\u5883\u4e2d\u8fd0\u884c\u3002</p> </li> <li> <p>\u591a\u7c7bLLM\u652f\u6301</p> <p>\u652f\u6301\u5404\u79cd\u4e3b\u6d41\u7684\u5927\u8bed\u8a00\u6a21\u578b\u63d0\u4f9b\u5546\uff0c\u5982 OpenAI\u3001Anthropic\u3001Qwen \u7b49\uff0c\u53ef\u4ee5\u901a\u8fc7\u7edf\u4e00\u63a5\u53e3\u8f7b\u677e\u5207\u6362\u548c\u914d\u7f6e\u4e0d\u540c\u7684\u6a21\u578b\u3002</p> </li> <li> <p>\u4e8b\u4ef6\u9a71\u52a8\u67b6\u6784</p> <p>\u91c7\u7528\u4e8b\u4ef6\u9a71\u52a8\u7684\u6267\u884c\u6a21\u578b\uff0c\u901a\u8fc7\u4e13\u95e8\u7684\u5904\u7406\u5668\u57fa\u4e8e\u7c7b\u522b\u5904\u7406\u4e8b\u4ef6\uff0c\u652f\u6301\u6a21\u5757\u5316\u3001\u53ef\u6269\u5c55\u6027\u548c\u6267\u884c\u6b65\u9aa4\u7684\u5e76\u53d1\u5904\u7406\u3002</p> </li> <li> <p>\u4e0a\u4e0b\u6587\u7ba1\u7406</p> <p>\u7edf\u4e00\u7ba1\u7406\u4efb\u52a1\u3001\u4e8b\u4ef6\u3001\u591a\u8f6e\u4f1a\u8bdd\u7684\u4e0a\u4e0b\u6587\uff0c\u5e76\u63d0\u4f9b\u538b\u7f29\u3001\u8fc7\u6ee4\u7b49\u529f\u80fd\uff0c\u786e\u4fdd\u9ad8\u6548\u7684\u72b6\u6001\u8ddf\u8e2a\u548c\u6062\u590d\u3002</p> </li> <li> <p>\u8f68\u8ff9\u6784\u5efa</p> <p>\u8fd0\u884c\u65f6\u6355\u83b7\u6bcf\u4e2a\u4efb\u52a1\u7684\u5b8c\u6574\u8f68\u8ff9\uff0c\u5305\u62ec\u6bcf\u4e2a LLM \u8c03\u7528\u3001\u52a8\u4f5c\u548c\u5956\u52b1\uff0c\u53ef\u7528\u4e8e\u5408\u6210\u8bad\u7ec3\u6837\u672c\u3001\u8bc4\u4f30\u6027\u80fd\u548c\u8fed\u4ee3\u6539\u8fdb\u3002</p> </li> <li> <p>\u73af\u5883\u652f\u6301</p> <p>\u63d0\u4f9b Agent \u53ef\u611f\u77e5\u3001\u4ea4\u4e92\u5e76\u4ece\u4e2d\u5b66\u4e60\u6216\u6267\u884c\u4efb\u52a1\u7684\u5916\u90e8\u4e16\u754c\u6216\u6a21\u62df\u7cfb\u7edf\uff0c\u652f\u6301\u590d\u6742\u7684\u5728\u7ebf\u73af\u5883\u8bbf\u95ee\u3002</p> </li> <li> <p>\u6570\u636e\u751f\u6210</p> <p>\u5185\u7f6e\u6570\u636e\u751f\u6210\u529f\u80fd\uff0c\u652f\u6301\u4ece Agent \u6267\u884c\u8f68\u8ff9\u4e2d\u751f\u6210\u9ad8\u8d28\u91cf\u7684\u8bad\u7ec3\u6570\u636e\uff0c\u7528\u4e8e\u6a21\u578b\u8bad\u7ec3\u548c\u4f18\u5316\u3002</p> </li> <li> <p>\u81ea\u8fdb\u5316\u80fd\u529b</p> <p>\u652f\u6301\u57fa\u4e8e\u5143\u5b66\u4e60\u7684\u81ea\u6211\u8fdb\u5316\u673a\u5236\uff0c\u53ef\u4ee5\u4f18\u5316\u6574\u4e2a Agent \u7cfb\u7edf\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u6a21\u578b\u6743\u91cd\u3002</p> </li> <li> <p>\u8bc4\u4f30\u80fd\u529b</p> <p>\u63d0\u4f9b\u5b8c\u6574\u7684\u8bc4\u4f30\u6846\u67b6\uff0c\u7528\u4e8e\u8bc4\u6d4b Agent \u7684\u5404\u79cd\u80fd\u529b\uff0c\u652f\u6301\u591a\u79cd\u57fa\u51c6\u6d4b\u8bd5\u548c\u81ea\u5b9a\u4e49\u8bc4\u4f30\u6307\u6807\u3002</p> </li> <li> <p>\u670d\u52a1\u5316\u80fd\u529b</p> <p>\u652f\u6301\u5c06 Agent \u548c\u76f8\u5173\u7ec4\u4ef6\u90e8\u7f72\u4e3a\u670d\u52a1\uff0c\u63d0\u4f9b API \u63a5\u53e3\u4f9b\u5176\u4ed6\u7cfb\u7edf\u8c03\u7528\u3002</p> </li> <li> <p>\u53ef\u89c6\u5316\u652f\u6301</p> <p>\u6846\u67b6\u63d0\u4f9b\u4e86\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u4ea4\u4e92\u5173\u952e\u4fe1\u606f\u7684\u8bb0\u5f55\u548c\u6301\u4e45\u5316\uff0c\u7528\u4e8e UI \u5c55\u793a\u548c\u5206\u6790\u3002</p> </li> <li> <p>\u53ef\u89c2\u6d4b\u6027</p> <p>\u5185\u7f6e Trace \u6846\u67b6\uff0c\u53ef\u8ffd\u8e2a\u667a\u80fd\u4f53\u3001\u5de5\u5177\u8c03\u7528\u3001\u591a\u667a\u80fd\u4f53\u4ea4\u4e92\u7b49\u4fe1\u606f\uff0c\u4fbf\u4e8e\u8c03\u8bd5\u548c\u76d1\u63a7\u3002</p> </li> <li> <p>\u9ad8\u5ea6\u53ef\u6269\u5c55</p> <p>\u6a21\u5757\u5316\u8bbe\u8ba1\uff0c\u652f\u6301\u5728\u5404\u4e2a\u5c42\u9762\u8fdb\u884c\u6269\u5c55\uff0c\u5305\u62ec Agent\u3001\u5de5\u5177\u3001\u5185\u5b58\u3001\u6267\u884c\u5668\u7b49\u7ec4\u4ef6\u3002</p> </li> <li> <p>\u591a\u6837\u5316\u4f7f\u7528\u6a21\u5f0f</p> <p>AWorld \u63d0\u4f9b SDK\u3001CLI\u3001Web UI \u4e09\u79cd\u4f7f\u7528\u6a21\u5f0f\uff0c\u6ee1\u8db3\u4e0d\u540c\u7c7b\u578b\u7528\u6237\u7684\u9700\u6c42\u3002</p> </li> </ol> <p>\u8fd9\u4e9b\u7279\u6027\u4f7f\u5f97 AWorld \u6210\u4e3a\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u4e14\u7075\u6d3b\u7684 Agent \u81ea\u8fdb\u5316\u6846\u67b6\uff0c\u9002\u7528\u4e8e\u4ece\u7b80\u5355\u7684\u5355 Agent \u5e94\u7528\u5230\u590d\u6742\u591a Agent \u534f\u4f5c\u7cfb\u7edf\u7684\u5404\u79cd\u573a\u666f\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%20%28Core%20Capabilities%29/","title":"\u6838\u5fc3\u80fd\u529b (Core Capabilities)","text":"<p>AWorld \u63d0\u4f9bAgent\u76f8\u5173\u975e\u5e38\u4e30\u5bcc\u7684\u80fd\u529b\uff0c\u4ece\u5b8f\u89c2\u67b6\u6784\u4e0a\u6709\u56db\u4e2a\u6838\u5fc3\u80fd\u529b\u3002</p>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%20%28Core%20Capabilities%29/#_1","title":"\u7075\u6d3b\u7684\u591a\u667a\u80fd\u4f53\u7f16\u6392","text":"<p>\u4f5c\u4e3aAWorld\u6700\u7a81\u51fa\u7684\u7279\u70b9\u4e4b\u4e00\uff0c\u6846\u67b6\u5185\u7f6e\u4e86\u57fa\u7840\u7684\u591a\u667a\u80fd\u4f53\u534f\u4f5c\u673a\u5236\uff0c\u80fd\u591f\u652f\u6301\u7075\u6d3b\u7684\u591a\u667a\u80fd\u4f53\u7cfb\u7edf(MAS)\u62d3\u6251\u7f16\u6392\uff0c\u53ef\u4ee5\u6784\u5efa\u5404\u79cd\u667a\u80fd\u4f53\u534f\u4f5c\u6a21\u5f0f\u3002</p> <p>\u6838\u5fc3\u7279\u6027\uff1a</p> <ul> <li>\u652f\u6301\u591a\u79cd\u534f\u4f5c\u6a21\u5f0f\uff1aWorkflow\u3001Handoff\u3001Team\u7b49</li> <li>\u652f\u6301\u6784\u5efaDAG\u548cDCG\u7c7b\u578b\u7684\u667a\u80fd\u4f53\u534f\u4f5c\u62d3\u6251</li> <li>\u652f\u6301\u62d3\u6251\u7684\u65e0\u9650\u5d4c\u5957</li> <li>\u652f\u6301\u661f\u578b\u3001\u6811\u578b\u3001\u7f51\u72b6\u3001\u73af\u72b6\u7b49\u591a\u79cd\u62d3\u6251\u7ed3\u6784</li> </ul> <pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.config import AgentConfig\nfrom aworld.core.agent.swarm import Swarm\n\nagent_config = AgentConfig(\n    llm_config=ModelConfig(\n        llm_model_name=\"gpt-4\",\n        llm_api_key=\"your-api-key\",\n        llm_base_url='available url'\n    ),\n)\n# \u521b\u5efa\u667a\u80fd\u4f53\nresearcher = Agent(name=\"\u7814\u7a76\u5458\", conf=agent_config, system_prompt=\"\u4f60\u662f\u4e00\u4e2a\u4e13\u4e1a\u7684\u7814\u7a76\u5458...\")\nwriter = Agent(name=\"\u4f5c\u5bb6\", conf=agent_config, system_prompt=\"\u4f60\u662f\u4e00\u4e2a\u4e13\u4e1a\u7684\u5185\u5bb9\u521b\u4f5c\u8005...\")\n\n# \u6784\u5efa\u534f\u4f5c\u62d3\u6251\nswarm = Swarm(\n    researcher, writer\n)\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%20%28Core%20Capabilities%29/#_2","title":"\u4e30\u5bcc\u7684\u73af\u5883\u6c99\u7bb1","text":"<p>AWorld\u63d0\u4f9b\u4e86\u6807\u51c6\u5316\u7684\u5de5\u5177\u62bd\u8c61\u5c42\uff0c\u80fd\u591f\u5c06\u590d\u6742\u7684\u73b0\u5b9e\u4e16\u754c\u73af\u5883\u8f6c\u5316\u4e3a Agent \u53ef\u7406\u89e3\u7684 Gym \u98ce\u683c\u6216 API \u98ce\u683c\u73af\u5883\uff0c\u652f\u6301\u672c\u5730\u5de5\u5177\u548c\u8fdc\u7a0b\u5de5\u5177\uff0c\u652f\u6301MCP(Model Context Protocol)\u6807\u51c6\u534f\u8bae\u5b9e\u73b0\u7684\u5de5\u5177\u96c6\u6210\u3002</p> <p>\u6838\u5fc3\u7279\u6027\uff1a</p> <ul> <li>\u7edf\u4e00\u7684\u5de5\u5177\u63cf\u8ff0\u548c\u63a5\u53e3</li> <li>\u5de5\u5177\u6267\u884c\u7684\u73af\u5883\u6c99\u7bb1\u9694\u79bb</li> <li>\u5185\u7f6e\u9519\u8bef\u5904\u7406\u548c\u8d85\u65f6\u63a7\u5236\u673a\u5236</li> <li>\u4e0eMCP\u670d\u52a1\u5668\u65e0\u7f1d\u96c6\u6210</li> </ul> <pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.config import AgentConfig, ModelConfig\n\n# \u914d\u7f6eMCP\u5de5\u5177\nmcp_servers=[\"simple-calculator\"],\nmcp_config={\n    \"mcpServers\": {\n        \"simple-calculator\": {\n            \"type\": \"sse\",\n            \"url\": \"http://127.0.0.1:55555/calculator/sse\",\n            \"timeout\": 5,\n            \"sse_read_timeout\": 300\n        }\n    }\n}\n\nagent_config = AgentConfig(\n    llm_config=ModelConfig(\n        llm_model_name=\"gpt-4\",\n        llm_api_key=\"your-api-key\",\n        llm_base_url='available url'\n    ),\n)\nagent = Agent(\n    name=\"\u5de5\u5177\u667a\u80fd\u4f53\", \n    conf=agent_config, \n    mcp_servers=mcp_servers, \n    mcp_config=mcp_config\n)\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%20%28Core%20Capabilities%29/#_3","title":"\u95ed\u73af\u7684\u81ea\u8fdb\u5316\u8bad\u7ec3","text":"<p>\u8fd9\u662f AWorld \u6700\u5177\u7279\u8272\u7684\u80fd\u529b\u3002AWorld\u4e0d\u4ec5\u652f\u6301\u6784\u5efa\u548c\u8fd0\u884c\u667a\u80fd\u4f53\uff0c\u8fd8\u6536\u96c6\u9ad8\u8d28\u91cf\u8f68\u8ff9\u7528\u4e8e\u8bad\u7ec3\uff0c\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u8bad\u7ec3\u548c\u8fdb\u5316\u80fd\u529b\u3002</p> <p>\u6838\u5fc3\u7279\u6027\uff1a</p> <ul> <li>\u6846\u67b6\u65e0\u5173\u7684\u8bbe\u8ba1</li> <li>\u4e0e\u4e09\u65b9RL\u8bad\u7ec3\u6846\u67b6\u96c6\u6210(VeRL, AReaL)</li> <li>\u5de5\u5177\u73af\u5883\u652f\u6301</li> <li>\u4ee3\u7801\u5f0f\u4e00\u952e\u542f\u52a8\u8bad\u7ec3</li> </ul> <pre><code>from train.trainer.agent_trainer import AgentTrainer\n\n# \u5b9a\u4e49\u6570\u636e\u96c6\ntrain_dataset, test_dataset = \"None or string or code reference\"\n# \u5b9a\u4e49agent\nagent = Agent(...)\n# \u5b9a\u4e49\u8bad\u7ec3\u914d\u7f6e\ncustom_train_config = \"string or json\"\n# \u5b9a\u4e49reward\nreward_func = \"None or string or code reference\"\n# \u6784\u5efatrainer\u5b9e\u4f8b\u5e76\u542f\u52a8\u8bad\u7ec3\ntrainer = AgentTrainer(agent=agent,\n                       config=custom_train_config,\n                       reward_func=reward_func,\n                       train_dataset=train_dataset,\n                       test_dataset=test_dataset)\ntrainer.train()\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%20%28Core%20Capabilities%29/#_4","title":"\u5b8c\u5907\u7684\u53ef\u89c2\u6d4b\u8ffd\u8e2a","text":"<p>AWorld\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u8ffd\u8e2a\u6846\u67b6\uff0c\u652f\u6301\u5206\u5e03\u5f0f\u8ffd\u8e2a\u3001\u4e0a\u4e0b\u6587\u4f20\u64ad\u548cSpan\u7ba1\u7406\uff0c\u53ef\u8ffd\u8e2a\u591a\u6b65\u63a8\u7406\u4e2d\u7684\u6bcf\u4e00\u6b65 Tool Call \u548c Token \u6d88\u8017\u3002</p> <p>\u6838\u5fc3\u7279\u6027\uff1a</p> <ul> <li>\u5206\u5e03\u5f0f\u8ffd\u8e2a\u652f\u6301</li> <li>\u4e0e\u4e3b\u6d41\u6846\u67b6\u548c\u534f\u8bae\u96c6\u6210</li> <li>\u667a\u80fd\u4f53\u3001\u5de5\u5177\u548c\u4efb\u52a1\u6267\u884c\u76d1\u63a7</li> <li>\u6027\u80fd\u5206\u6790\u548c\u74f6\u9888\u8bc6\u522b</li> </ul> <pre><code>import aworld.trace as trace\nfrom aworld.trace.config import ObservabilityConfig\n\n# \u542f\u52a8\u8ddf\u8e2a\uff0c\u5728\u4efb\u52a1\u542f\u52a8\u4e4b\u524d\u8c03\u7528\ntrace.configure(ObservabilityConfig(trace_server_enabled=True))\n\n...\n\n# asyncio\u4efb\u52a1\u76d1\u63a7\nasyncio_monitor = AsyncioMonitor(detect_duration_second=1, shot_file_name=False)\nasyncio_monitor.start()\n\n# \u6267\u884c\u4efb\u52a1\nexecute_your_task()\n\nasyncio_monitor.stop()\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%20%28Core%20Capabilities%29/#_5","title":"\u5176\u4ed6\u5173\u952e\u80fd\u529b","text":""},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%20%28Core%20Capabilities%29/#_6","title":"\u4efb\u52a1\u8fd0\u884c\u65f6","text":"<p>AWorld\u63d0\u4f9b\u4e86\u7075\u6d3b\u5f3a\u5927\u7684\u7684\u4efb\u52a1\u8fd0\u884c\u65f6\u80fd\u529b\uff0c\u901a\u8fc7\u4e0d\u540c\u7c7b\u578b\u7684Runner\u652f\u6301\u591a\u6837\u5316\u7684\u6267\u884c\u6a21\u5f0f\u3002</p> <p>\u6838\u5fc3\u7279\u6027\uff1a</p> <ul> <li>\u4e8b\u4ef6\u9a71\u52a8\u7684\u4efb\u52a1\u5904\u7406</li> <li>\u53ef\u6269\u5c55\u7684\u8fd0\u884c\u65f6(runner, handler, callback\u548chooks)\u67b6\u6784</li> <li>\u652f\u6301\u4e0d\u540c\u7684\u8ba1\u7b97\u8fd0\u884c\u65f6\u5f15\u64ce\u6267\u884c</li> <li>\u5b8c\u6574\u7684\u6267\u884c\u8f68\u8ff9\u8ddf\u8e2a</li> </ul> <pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.config import AgentConfig, RunConfig, EngineName\nfrom aworld.runner import Runners\n\n# \u521b\u5efa\u667a\u80fd\u4f53\nagent = Agent(\n    name=\"\u5206\u6790\u5e08\",\n    conf=AgentConfig(\n        llm_model_name=\"gpt-4\",\n        llm_api_key=\"your-api-key\",\n        llm_base_url='available url'\n    )\n    system_prompt=\"\u4f60\u662f\u4e00\u4e2a\u4e13\u4e1a\u7684AI\u8d8b\u52bf\u5206\u6790\u5e08...\"\n)\n\n# \u540c\u6b65\u6267\u884c\u4efb\u52a1\nresult = Runners.sync_run(\n    input=\"\u5206\u6790\u6700\u65b0\u7684AI\u53d1\u5c55\u8d8b\u52bf\",\n    agent=agent,\n    run_conf=RunConfig(\n        # \u5f15\u64ce\u540d\n        engine_name=EngineName.LOCAL,\n        worker_num=len(tasks),\n        reuse_process=True\n    )\n)\n\nprint(f\"\u5206\u6790\u7ed3\u679c: {result.answer}, \u8f68\u8ff9: {result.trajectory}\")\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%20%28Core%20Capabilities%29/#_7","title":"\u4e0a\u4e0b\u6587\u7ba1\u7406","text":"<p>AWorld\u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u7cfb\u7edf\u4e3a\u667a\u80fd\u4f53\u63d0\u4f9b\u4e86\u5168\u9762\u7684\u72b6\u6001\u8ddf\u8e2a\u3001\u914d\u7f6e\u7ba1\u7406\u548c\u63d0\u793a\u8bcd\u4f18\u5316\u529f\u80fd\u3002</p> <p>\u6838\u5fc3\u7279\u6027\uff1a</p> <ul> <li>\u5b8c\u6574\u7684\u72b6\u6001\u8ddf\u8e2a\u548c\u6062\u590d\u673a\u5236</li> <li>\u667a\u80fd\u63d0\u793a\u8bcd\u7ba1\u7406\u548c\u4f18\u5316</li> <li>\u4efb\u52a1\u7a7f\u900f\u548c\u9694\u79bb</li> <li>\u591a\u5c42\u4efb\u52a1\u72b6\u6001\u7ba1\u7406</li> </ul> <pre><code>from aworld.core.context.base import Context\nfrom aworld.core.task import Task\n\n# \u521b\u5efa\u4e0a\u4e0b\u6587\ncontext = Context()\ncontext.set_task(Task(input=\"\u5206\u6790\u6700\u65b0\u7684AI\u53d1\u5c55\u8d8b\u52bf\"))\ncontext.post_init()\n\n# \u57fa\u4e8e\u4efb\u52a1ID\u505a\u9694\u79bb\ncontext.task_id\n\n# \u5408\u5e76\u4efb\u52a1\u7684\u4e0a\u4e0b\u6587\ncontext.merge_context(other_context)\n# \u5408\u5e76\u5b50\u4efb\u52a1\u7684\u4e0a\u4e0b\u6587\ncontext.merge_sub_context(sub_task_context)\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%20%28Core%20Capabilities%29/#_8","title":"\u8bb0\u5fc6\u80fd\u529b","text":"<p>AWorld\u5185\u7f6e\u4e86\u53ef\u6269\u5c55\u7684\u8bb0\u5fc6\u7cfb\u7edf\uff0c\u652f\u6301\u77ed\u671f\u548c\u957f\u671f\u8bb0\u5fc6\u3001\u6458\u8981\u3001\u68c0\u7d22\u3001\u5d4c\u5165\u7b49\u529f\u80fd\u3002</p> <p>\u6838\u5fc3\u7279\u6027\uff1a</p> <ul> <li>\u77ed\u671f\u8bb0\u5fc6\uff1a\u5feb\u901f\u8bbf\u95ee\u6700\u8fd1\u4ea4\u4e92\u5185\u5bb9</li> <li>\u957f\u671f\u8bb0\u5fc6\uff1a\u6301\u4e45\u5316\u5b58\u50a8\u5173\u952e\u4fe1\u606f</li> <li>\u7075\u6d3b\u7684\u540e\u7aef\u652f\u6301\uff1a\u652f\u6301\u591a\u79cd\u5411\u91cf\u6570\u636e\u5e93</li> <li>\u81ea\u52a8\u6458\u8981\u7b56\u7565\uff1a\u4f18\u5316\u6027\u80fd\u548c\u4e0a\u4e0b\u6587\u957f\u5ea6</li> </ul> <pre><code>from aworld.config import AgentMemoryConfig\nfrom aworld.memory.main import MemoryFactory\nfrom aworld.memory.models import MemoryHumanMessage, MessageMetadata\n\n# \u521b\u5efa\u5b9e\u4f8b\nMemoryFactory.init()\nmemory = MemoryFactory.instance()\nmetadata = MessageMetadata(\n    user_id=\"zues\",\n    session_id=\"session#foo\",\n    task_id=\"zues:session#foo:task#1\",\n    agent_id=\"super_agent\",\n    agent_name=\"super_agent\"\n)\n\n# \u6dfb\u52a0\u8bb0\u5fc6\nawait memory.add(\n    MemoryHumanMessage(content=\"what is memory\", metadata=metadata), \n    agent_memory_config=AgentMemoryConfig()\n)\n</code></pre>"},{"location":"docs_zh/%E5%BC%80%E5%A7%8B/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%20%28Core%20Capabilities%29/#_9","title":"\u591a\u79cd\u6a21\u578b\u652f\u6301","text":"<p>AWorld\u7684Models\u6a21\u5757\u4e3a\u5f00\u53d1\u8005\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f3a\u5927\u800c\u7075\u6d3b\u7684LLM\u63a5\u53e3\uff0c\u53ef\u4ee5\u8f7b\u677e\u96c6\u6210\u5404\u79cd\u5927\u578b\u8bed\u8a00\u6a21\u578b\u670d\u52a1\uff0c\u5e76\u5728\u4e0d\u540c\u63d0\u4f9b\u5546\u4e4b\u95f4\u65e0\u7f1d\u5207\u6362\u3002</p> <p>\u6838\u5fc3\u7279\u6027\uff1a</p> <ul> <li>\u7edf\u4e00\u7684API</li> <li>\u5de5\u5177\u5316\u8c03\u7528</li> <li>\u652f\u6301\u540c\u5f02\u6b65\u548c\u6d41\u5f0f</li> <li>\u53ef\u81ea\u5b9a\u4e49\u6269\u5c55</li> </ul> <pre><code>from aworld.config import ModelConfig\nfrom aworld.models.llm import get_llm_model, call_llm_model, acall_llm_model, acall_llm_model_stream\n\nllm = get_llm_model(ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n))\n\nquery = \"What is an agent?\"\nmessages = [\n    {\"role\": \"system\", \"content\": \"You are a helpful assistant.\"},\n    {\"role\": \"user\", \"content\": query},\n]\n# \u540c\u6b65\nprint(call_llm_model(llm, messages))\n\n# \u5f02\u6b65\n# print(await acall_llm_model(llm, messages))\n\n# \u6d41\n# async for chunk in acall_llm_model_stream(llm, messages):\n#     print(chunk)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/","title":"\u4e0a\u4e0b\u6587\uff08Context\uff09","text":"<p>\u5927\u6a21\u578b\u7684\u6027\u80fd\u74f6\u9888\u4e0d\u5728\u4e8e\u53c2\u6570\u91cf\uff0c\u800c\u5728\u4e8e\u5176\u611f\u77e5\u5230\u7684\u201c\u4e0a\u4e0b\u6587\u8d28\u91cf\u201d\u3002\u5c3d\u7ba1\u4e0a\u4e0b\u6587\u7a97\u53e3\u5728\u4e0d\u65ad\u6269\u5927\uff0c\u4f46\u7814\u7a76\u53d1\u73b0\u5b58\u5728\u201c\u4e0a\u4e0b\u6587\u8150\u8680 (Context Rot)\u201d\u73b0\u8c61\uff1a\u968f\u7740 Token \u6570\u91cf\u589e\u52a0\uff0c\u6a21\u578b\u51c6\u786e\u53ec\u56de\u4fe1\u606f\u7684\u80fd\u529b\u4f1a\u4e0b\u964d\u3002\u4e0a\u4e0b\u6587\u5de5\u7a0b\u662f Agent \u7684\u201c\u6570\u5b57\u5927\u8111\u201d\u4e0e\u73b0\u5b9e\u4e16\u754c\u4e4b\u95f4\u7684\u8fde\u63a5\u5668\uff0c\u662f Prompt Engineering \u7684\u81ea\u7136\u6f14\u8fdb \u2014\u2014 \u4ece\u5355\u7eaf\u7684\u6307\u4ee4\u7f16\u5199\u8f6c\u5411\u5bf9 LLM \u63a8\u7406\u8fc7\u7a0b\u4e2d\u6700\u4f18 Token \u96c6\u5408\u7684\u52a8\u6001\u7b56\u5212\u4e0e\u7ef4\u62a4\u3002 </p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#1","title":"1. \u6838\u5fc3\u6311\u6218\uff1a\u4e3a\u4ec0\u4e48\u9700\u8981\u4e0a\u4e0b\u6587\u5de5\u7a0b\uff1f","text":"<p>\u5728\u957f\u5e8f\u5217\u548c\u590d\u6742 Agent \u4efb\u52a1\u4e2d\uff0c\u5355\u7eaf\u589e\u52a0\u7a97\u53e3\u5927\u5c0f\u5e76\u4e0d\u80fd\u89e3\u51b3\u6240\u6709\u95ee\u9898\uff0c\u53cd\u800c\u5e26\u6765\u4e86\u4ee5\u4e0b\u6311\u6218\uff1a</p> <ol> <li>\u4e0a\u4e0b\u6587\u8150\u8680 (Context Rot): LLM \u5b58\u5728\u201c\u6ce8\u610f\u529b\u9884\u7b97\u201d\u3002\u7531\u4e8e Transformer \u67b6\u6784\u7684\u5c40\u9650\uff0c\u8fc7\u957f\u7684\u4e0a\u4e0b\u6587\u4f1a\u5bfc\u81f4\u6a21\u578b\u5728\u4e2d\u95f4\u90e8\u5206\u7684\u4fe1\u606f\u63d0\u53d6\u80fd\u529b\u663e\u8457\u4e0b\u964d\uff08Lost in the middle\uff09\u3002</li> <li>\u4fe1\u606f\u71b5\u7206\u70b8 (Noise &amp; Entropy): \u5927\u91cf\u7684\u5de5\u5177\u539f\u59cb\u8f93\u51fa\u3001\u5197\u4f59\u65e5\u5fd7\u6df9\u6ca1\u4e86\u5173\u952e\u6307\u4ee4\u3002</li> <li>\u72b6\u6001\u5e7b\u89c9 (State Hallucination): \u957f\u671f\u8bb0\u5fc6\u4e2d\u7684\u9648\u65e7\u4fe1\u606f\u4e0e\u5b9e\u65f6 Workspace \u4e2d\u7684\u6700\u65b0\u72b6\u6001\u53d1\u751f\u51b2\u7a81\uff0c\u5bfc\u81f4\u51b3\u7b56\u504f\u5dee\u3002</li> <li>RAG \u8bed\u4e49\u4e22\u5931: \u4f20\u7edf\u7684\u6587\u6863\u5206\u5757\uff08Chunking\uff09\u7834\u574f\u4e86\u4e0a\u4e0b\u6587\u7684\u5b8c\u6574\u6027\uff0c\u5bfc\u81f4\u68c0\u7d22\u51fa\u7684\u7247\u6bb5\u7f3a\u4e4f\u89e3\u91ca\u6027\u3002</li> </ol>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#2-context-anatomy","title":"2. \u4e0a\u4e0b\u6587\u7684\u7ec4\u6210 (Context Anatomy)","text":"<p>AWorld \u5c06\u4e0a\u4e0b\u6587\u8d1f\u8f7d\u62c6\u89e3\u4e3a\u4e09\u5927\u6838\u5fc3\u7ec4\u4ef6\uff0c\u5b9e\u73b0\u7cbe\u7ec6\u5316\u7ba1\u7406\uff1a</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#21-guidance","title":"2.1 \u6307\u5bfc\u63a8\u7406\u7684\u4e0a\u4e0b\u6587 (Guidance)","text":"<p>\u5b9a\u4e49 Agent \u7684\u57fa\u672c\u63a8\u7406\u6a21\u5f0f and \u884c\u4e3a\u8fb9\u754c\uff1a</p> <ul> <li>\u7cfb\u7edf\u6307\u4ee4 (System Instructions): \u89d2\u8272\u3001\u80fd\u529b\u4e0e\u7ea6\u675f\u3002</li> <li>\u5de5\u5177\u5b9a\u4e49 (Tool Definitions): API \u67b6\u6784\u63cf\u8ff0\uff08\u652f\u6301 MCP \u52a8\u6001\u52a0\u8f7d\uff09\u3002</li> <li>\u5c11\u6837\u672c\u793a\u4f8b (Few-Shot): \u5f15\u5bfc\u6a21\u578b\u9075\u5faa\u7279\u5b9a\u601d\u8003\u94fe\u8def\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#22-evidential","title":"2.2 \u4e8b\u5b9e\u4e0e\u8bc1\u636e\u6570\u636e (Evidential)","text":"<p>Agent \u63a8\u7406\u7684\u5b9e\u8d28\u6027\u4f9d\u636e\uff1a</p> <ul> <li>\u957f\u671f\u8bb0\u5fc6 (Long-Term): \u7528\u6237\u504f\u597d\u3001\u4e8b\u5b9e\u77e5\u8bc6\u3001\u8de8\u4f1a\u8bdd\u7ecf\u9a8c\u3002</li> <li>\u5916\u90e8\u77e5\u8bc6 (External): \u901a\u8fc7 RAG \u68c0\u7d22\u5230\u7684\u6587\u6863\u7247\u6bb5\u3002</li> <li>\u5de5\u5177/\u5b50 Agent \u8f93\u51fa: \u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u4e2d\u95f4\u7ed3\u679c\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#23-immediate","title":"2.3 \u5373\u65f6\u5bf9\u8bdd\u4fe1\u606f (Immediate)","text":"<p>\u5c06 Agent \u7f6e\u4e8e\u5f53\u524d\u4ea4\u4e92\u6d41\u4e2d\uff1a</p> <ul> <li>\u5bf9\u8bdd\u5386\u53f2 (History): \u7ef4\u6301\u8fde\u8d2f\u6027\u7684\u56de\u5408\u8bb0\u5f55\u3002</li> <li>\u8349\u7a3f\u677f (Scratchpad): \u8bb0\u5f55\u4e2d\u95f4\u63a8\u7406\u8fc7\u7a0b\u3002</li> <li>\u7528\u6237\u63d0\u793a (User Prompt): \u5f53\u524d\u9700\u8981\u89e3\u51b3\u7684\u5177\u4f53\u67e5\u8be2\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#3-amnicontext","title":"3. \u6838\u5fc3\u67b6\u6784\uff1aAmniContext","text":"<p>AWorld \u57fa\u4e8e AmniContext \u6846\u67b6\uff0c\u901a\u8fc7\u4e3b\u52a8\u63a7\u5236\u800c\u975e\u88ab\u7ea7\u5806\u53e0\u6765\u5bf9\u6297\u4e0a\u4e0b\u6587\u8150\u5316\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#31-a-m-n-i","title":"3.1 \u8bbe\u8ba1\u54f2\u5b66 (A-M-N-I)","text":"<ul> <li>A (Ant): \u627f\u8f7d\u8682\u8681\u96c6\u56e2\u5728\u5206\u5e03\u5f0f\u67b6\u6784\u4e0e\u5927\u89c4\u6a21\u534f\u4f5c\u65b9\u9762\u7684\u5de5\u7a0b\u6c89\u6dc0\u3002</li> <li>M (Mind): \u6a21\u62df\u4eba\u7c7b\u7684\u5de5\u4f5c\u8bb0\u5fc6\u4e0e\u957f\u77ed\u671f\u8bb0\u5fc6\u4ea4\u4e92\u3002</li> <li>N (Neuro): \u6a21\u4eff\u795e\u7ecf\u7f51\u7edc\u7684\u4fe1\u606f\u7d22\u5f15\u4e0e\u5173\u8054\u3002</li> <li>I (Intelligence): \u9a71\u52a8\u9ad8\u8d28\u91cf\u7684\u667a\u80fd\u51b3\u7b56\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#32","title":"3.2 \u5c42\u6b21\u5316\u7ed3\u6784\u4e0e\u8bb0\u5fc6\u6a21\u578b","text":"<p>\u4e0a\u4e0b\u6587\u652f\u6301 \u6811\u72b6\u5206\u7ea7\u5f15\u7528\uff0c\u901a\u8fc7\u5411\u4e0a\u56de\u6eaf\u673a\u5236\u5b9e\u73b0\u4fe1\u606f\u5171\u4eab\u4e0e\u9694\u79bb\uff1a</p> \u8bb0\u5fc6\u5c42\u7ea7 \u5b58\u50a8\u4f4d\u7f6e \u4f5c\u7528 Working Memory \u5185\u5b58 / TaskState \u5b9e\u65f6\u51b3\u7b56\uff0c\u5b58\u50a8\u5f53\u524d\u6b65\u9aa4\u7684 KV \u6570\u636e Short Memory Checkpoint / Memory \u7ef4\u6301\u4efb\u52a1\u8fde\u7eed\u6027\uff0c\u5305\u542b\u5bf9\u8bdd\u5386\u53f2\u4e0e\u8f68\u8ff9 Long Memory \u5411\u91cf\u5e93 / UserProfile \u8de8\u4f1a\u8bdd\u4e2a\u6027\u5316\uff0c\u5b58\u50a8\u7528\u6237\u753b\u50cf\u4e0e\u4e8b\u5b9e\u77e5\u8bc6"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#4-basic-usage","title":"4. \u57fa\u672c\u7528\u6cd5 (Basic Usage)","text":"<p>\u57fa\u672c\u7528\u6cd5\u6db5\u76d6\u4e86\u6784\u5efa\u6807\u51c6\u667a\u80fd\u4f53\u4efb\u52a1\u6240\u9700\u7684\u6838\u5fc3\u64cd\u4f5c\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#41","title":"4.1 \u521d\u59cb\u5316\u4e0e\u521b\u5efa","text":"<p>\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u9700\u8981\u521d\u59cb\u5316\u4e2d\u95f4\u4ef6\u4ee5\u542f\u7528\u8bb0\u5fc6\u548c\u68c0\u7d22\u529f\u80fd\u3002</p> <pre><code>from aworld.core.context.amni import ApplicationContext, TaskInput, init_middlewares\nfrom aworld.core.context.amni.config import AmniConfigFactory, AmniConfigLevel\n\n# 1. \u521d\u59cb\u5316\u4e2d\u95f4\u4ef6 (\u542f\u7528 SQLite \u8bb0\u5fc6\u540e\u7aef\u4e0e\u68c0\u7d22\u5668)\ninit_middlewares()\n\n# 2. \u521b\u5efa\u4efb\u52a1\u8f93\u5165\ntask_input = TaskInput(\n    user_id=\"user_001\",\n    session_id=\"session_001\",\n    task_id=\"task_001\",\n    task_content=\"\u5206\u6790 2024 \u5e74 AI \u8d8b\u52bf\"\n)\n\n# 3. \u521b\u5efa\u914d\u7f6e (PILOT/COPILOT/NAVIGATOR)\n# PILOT \u7b49\u7ea7\u63d0\u4f9b\u57fa\u7840\u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\nconfig = AmniConfigFactory.create(level=AmniConfigLevel.PILOT)\n\n# 4. \u4ece\u8f93\u5165\u521b\u5efa\u4e0a\u4e0b\u6587 (\u5f02\u6b65)\ncontext = await ApplicationContext.from_input(task_input, context_config=config)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#42-prompt-neurons-assembly","title":"4.2 \u795e\u7ecf\u5143\u7406\u5ff5\u4e0e Prompt \u7ec4\u88c5 (Neurons &amp; Assembly)","text":"<p>AWorld \u7684\u6838\u5fc3\u7406\u5ff5\u662f\uff1a\u628a Prompt \u4e2d\u7684\u6bcf\u4e00\u5757\u7ed3\u6784\u5316\u4fe1\u606f\u90fd\u89c6\u4e3a\u4e00\u4e2a\u201c\u795e\u7ecf\u5143 (Neuron)\u201d\u3002\u4e0a\u4e0b\u6587\u4e0d\u518d\u662f\u6742\u4e71\u65e0\u7ae0\u7684\u6587\u672c\u5806\u780c\uff0c\u800c\u662f\u7531\u591a\u4e2a\u5177\u5907\u611f\u77e5\u80fd\u529b\u7684\u795e\u7ecf\u5143\u52a8\u6001\u7ec4\u88c5\u800c\u6210\u7684\u201c\u6570\u5b57\u5927\u8111\u201d\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#1-op-neuron","title":"1. \u4e0a\u4e0b\u6587\u52a0\u5de5\u6d41\u6c34\u7ebf\uff1aOp -&gt; Neuron","text":"<p>\u4fe1\u606f\u7684\u6d41\u52a8\u9075\u5faa \u201c\u52a0\u5de5 (Op) -&gt; \u8868\u8fbe (Neuron)\u201d \u7684\u7ba1\u9053\u6a21\u578b\uff1a</p> <ul> <li>Context Op (\u64cd\u4f5c): \u8d1f\u8d23\u4ece\u539f\u59cb\u8f93\u5165\uff08\u5982\u5de5\u5177\u6267\u884c\u7ed3\u679c\u3001\u5bf9\u8bdd\u5386\u53f2\uff09\u4e2d\u63d0\u53d6\u3001\u6e05\u6d17\u548c\u7ed3\u6784\u5316\u4fe1\u606f\u3002</li> <li>Neuron (\u795e\u7ecf\u5143): \u8d1f\u8d23\u5c06\u52a0\u5de5\u540e\u7684\u4fe1\u606f\u4ee5\u6700\u4f18\u7684\u683c\u5f0f\uff08\u5982 XML\uff09\u5728 Prompt \u4e2d\u5448\u73b0\u7ed9\u6a21\u578b\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#2","title":"2. \u53d8\u91cf\u5b58\u53d6\u4e0e\u81ea\u52a8\u7ec4\u88c5","text":"<p>\u4e0a\u4e0b\u6587\u63d0\u4f9b\u7b80\u5355\u7684 KV \u63a5\u53e3\uff0c\u5e76\u652f\u6301\u5728 Prompt \u6a21\u677f\u4e2d\u901a\u8fc7 <code>{{xxx}}</code> \u8bed\u6cd5\u52a8\u6001\u5f15\u7528\u3002</p> <pre><code># \u5b58\u50a8\u8fd0\u884c\u65f6\u53d8\u91cf (Working Memory)\ncontext.put(\"focus_area\", \"LLM Context Window\")\n\n# \u83b7\u53d6\u53d8\u91cf (\u652f\u6301\u81ea\u52a8\u5411\u4e0a\u56de\u6eaf\u7236\u7ea7\u4e0a\u4e0b\u6587)\narea = context.get(\"focus_area\")\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#3-customization","title":"3. \u7528\u6237\u81ea\u5b9a\u4e49\u80fd\u529b (Customization)","text":"<p>\u5f00\u53d1\u8005\u53ef\u4ee5\u6839\u636e\u7279\u5b9a\u4e1a\u52a1\u573a\u666f\uff0c\u8f7b\u677e\u6269\u5c55\u81ea\u5b9a\u4e49\u7684\u795e\u7ecf\u5143\u548c\u5904\u7406\u64cd\u4f5c\u3002</p> <p>\u81ea\u5b9a\u4e49\u795e\u7ecf\u5143\u793a\u4f8b\uff1a</p> <pre><code>from aworld.core.context.amni.prompt.neurons import Neuron, neuron_factory\n\n@neuron_factory.register(name=\"user_preference\", desc=\"\u81ea\u5b9a\u4e49\u7528\u6237\u504f\u597d\u795e\u7ecf\u5143\")\nclass UserPreferenceNeuron(Neuron):\n    async def format(self, context: ApplicationContext, **kwargs) -&gt; str:\n        pref = context.get(\"user_pref\")\n        return f\"&lt;user_pref&gt;{pref}&lt;/user_pref&gt;\"\n</code></pre> <p>\u81ea\u5b9a\u4e49\u52a0\u5de5\u64cd\u4f5c (Op) \u793a\u4f8b\uff1a</p> <pre><code>from aworld.core.context.amni.processor.op import BaseOp, memory_op\n\n@memory_op(\"extract_pref\")\nclass ExtractPreferenceOp(BaseOp):\n    async def run(self, context: ApplicationContext):\n        # \u903b\u8f91\uff1a\u4ece\u5bf9\u8bdd\u4e2d\u5206\u6790\u5e76\u63d0\u53d6\u504f\u597d\uff0c\u5b58\u5165 KV \u5b58\u50a8\n        context.put(\"user_pref\", \"High Precision\")\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#4-prompt","title":"4. Prompt \u7ec4\u88c5\u8fdb\u9636\u793a\u4f8b","text":"<p><code>PromptService</code> \u652f\u6301\u5f15\u7528\u5185\u7f6e\u4e0e\u81ea\u5b9a\u4e49\u7684\u5404\u7c7b\u795e\u7ecf\u5143\uff1a</p> <pre><code>template = \"\"\"\n# \u4efb\u52a1\u4e0e\u73af\u5883\n\u76ee\u6807: {{task_input}}\n\u6d3b\u8dc3\u5de5\u4f5c\u76ee\u5f55: {{working_dir}}\n\n# \u8ba4\u77e5\u795e\u7ecf\u5143\n\u5173\u952e\u4e8b\u5b9e: {{facts}}\n\u7528\u6237\u504f\u597d: {{user_preference}}  # \u5f15\u7528\u81ea\u5b9a\u4e49\u795e\u7ecf\u5143\n\n# \u5386\u53f2\u56de\u6eaf\n\u6839\u4efb\u52a1\u76ee\u6807: {{root.task_input}}\n\"\"\"\n\n# \u6267\u884c\u683c\u5f0f\u5316\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u8c03\u7528\u5bf9\u5e94\u795e\u7ecf\u5143\u7684 format \u65b9\u6cd5\nprompt = await context.prompt_service.async_format(template)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#43-knowledge-usage","title":"4.3 \u77e5\u8bc6\u7ba1\u7406\u4e0e\u4f7f\u7528 (Knowledge Usage)","text":"<p>Knowledge \u6307\u5b58\u50a8\u5728 Workspace \u4e2d\u7684\u975e\u7ed3\u6784\u5316\u6216\u534a\u7ed3\u6784\u5316\u6570\u636e\uff08Artifacts\uff09\uff0c\u53ef\u901a\u8fc7\u4e0a\u4e0b\u6587\u8fdb\u884c\u7d22\u5f15\u548c\u5f15\u7528\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#_1","title":"\u6dfb\u52a0\u77e5\u8bc6","text":"<pre><code>from aworld.output import Artifact\n\n# 1. \u521b\u5efa\u5de5\u4ef6 (\u4f8b\u5982\u4e00\u4e2a\u7814\u7a76\u62a5\u544a)\nartifact = Artifact(\n    id=\"report_001\",\n    content=\"AWorld \u4f7f\u7528\u5206\u5e03\u5f0f\u4e0a\u4e0b\u6587\u7ba1\u7406...\",\n    metadata={\"type\": \"text\", \"source\": \"research\"}\n)\n\n# 2. \u5c06\u77e5\u8bc6\u6dfb\u52a0\u5230\u4e0a\u4e0b\u6587 (\u81ea\u52a8\u8fdb\u884c\u7d22\u5f15)\nawait context.add_knowledge(artifact)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#prompt","title":"\u5728 Prompt \u4e2d\u5f15\u7528\u77e5\u8bc6","text":"<p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u7279\u5b9a\u7684\u8def\u5f84\u8bed\u6cd5\u76f4\u63a5\u5728 Prompt \u4e2d\u6ce8\u5165\u77e5\u8bc6\u5185\u5bb9\uff1a</p> <pre><code># \u5f15\u7528\u5b8c\u6574\u5185\u5bb9\nprompt_with_content = await context.prompt_service.async_format(\n    \"\u53c2\u8003\u62a5\u544a\u5185\u5bb9\uff1a{{knowledge/report_001/content}}\"\n)\n\n# \u5f15\u7528\u81ea\u52a8\u751f\u6210\u7684\u6458\u8981 (\u9700\u5f00\u542f\u76f8\u5e94\u914d\u7f6e)\nprompt_with_summary = await context.prompt_service.async_format(\n    \"\u62a5\u544a\u6458\u8981\uff1a{{knowledge/report_001/summary}}\"\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#5-advanced-usage","title":"5. \u9ad8\u7ea7\u7528\u6cd5 (Advanced Usage)","text":"<p>\u9ad8\u7ea7\u7528\u6cd5\u9002\u7528\u4e8e\u591a\u667a\u80fd\u4f53\u534f\u4f5c\u3001\u8d85\u957f\u4efb\u52a1\u4ee5\u53ca\u81ea\u52a8\u5316\u8ba4\u77e5\u52a0\u5de5\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#51-context-offloading","title":"5.1 \u4e0a\u4e0b\u6587\u5378\u8f7d (Context Offloading)","text":"<p>\u9488\u5bf9\u5de8\u91cf\u5de5\u5177\u8f93\u51fa\uff08\u5982\u6d77\u91cf\u7f51\u9875\u5185\u5bb9\uff09\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u6216\u624b\u52a8\u5c06\u5176\u4ece\u4e0a\u4e0b\u6587\u5378\u8f7d\u5230 Workspace\u3002</p> <pre><code># 1. \u81ea\u52a8\u5378\u8f7d\u914d\u7f6e (\u5728 COPILOT/NAVIGATOR \u7b49\u7ea7\u9ed8\u8ba4\u5f00\u542f)\nconfig = AmniConfigFactory.create(\n    level=AmniConfigLevel.COPILOT,\n    tool_result_offload=True,\n    tool_result_length_threshold=30000  # \u8d85\u8fc7 30k \u5b57\u7b26\u81ea\u52a8\u5378\u8f7d\n)\n\n# 2. \u624b\u52a8\u6267\u884c\u5378\u8f7d\nawait context.offload_by_workspace(artifacts)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#52-hierarchical-tasks-planning","title":"5.2 \u4efb\u52a1\u6811\u4e0e\u89c4\u5212\u6a21\u5f0f (Hierarchical Tasks &amp; Planning)","text":"<p>AmniContext \u7684\u6838\u5fc3\u4f18\u52bf\u5728\u4e8e\u5bf9 Planning \u6a21\u5f0f \u7684\u539f\u751f\u652f\u6301\u3002\u5b83\u901a\u8fc7\u6811\u72b6\u4efb\u52a1\u7ed3\u6784\uff08Task Tree\uff09\uff0c\u5c06\u590d\u6742\u7684\u5b8f\u89c2\u76ee\u6807\u62c6\u89e3\u4e3a\u53ef\u6267\u884c\u7684\u5fae\u89c2\u539f\u5b50\u4efb\u52a1\uff0c\u5e76\u81ea\u52a8\u7ba1\u7406\u5176\u95f4\u7684\u4e0a\u4e0b\u6587\u6d41\u52a8\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#_2","title":"\u6838\u5fc3\u80fd\u529b\uff1a\u591a\u4efb\u52a1\u5206\u89e3\u4e0e\u5e76\u884c","text":"<ul> <li>\u9012\u5f52\u62c6\u89e3 (Recursive Decomposition): Agent \u53ef\u4ee5\u6839\u636e\u4e3b\u4efb\u52a1\u76ee\u6807\u52a8\u6001\u751f\u6210 N \u4e2a\u5b50\u4efb\u52a1\uff0c\u6bcf\u4e2a\u5b50\u4efb\u52a1\u62e5\u6709\u72ec\u7acb\u7684 <code>SubContext</code>\u3002</li> <li>\u4e0a\u4e0b\u6587\u7ee7\u627f (Inheritance): \u5b50\u4e0a\u4e0b\u6587\u81ea\u52a8\u7ee7\u627f\u7236\u7ea7\u7684 <code>kv_store</code> \u548c\u73af\u5883\u914d\u7f6e\uff0c\u786e\u4fdd\u5b50\u4efb\u52a1\u5728\u6267\u884c\u65f6\u5177\u5907\u5168\u5c40\u89c6\u91ce\uff08Contextual Awareness\uff09\u3002</li> <li>\u72b6\u6001\u805a\u5408 (Consolidation): \u5f53\u5b50\u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u901a\u8fc7 <code>merge_sub_context</code> \u5c06\u7ed3\u679c\u3001\u4e8b\u5b9e\u548c\u4ea7\u751f\u7684 Token \u6d88\u8017\u5f02\u6b65\u5408\u5e76\u56de\u4e3b\u4e0a\u4e0b\u6587\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#_3","title":"\u793a\u4f8b\uff1a\u89c4\u5212\u6a21\u5f0f\u4e0b\u7684\u4efb\u52a1\u751f\u547d\u5468\u671f","text":"<pre><code># 1. \u6784\u5efa\u5b50\u4e0a\u4e0b\u6587 (\u7531 Planner Agent \u89e6\u53d1)\n# \u7cfb\u7edf\u4f1a\u81ea\u52a8\u5efa\u7acb\u7236\u5b50\u8282\u70b9\u7684\u5f15\u7528\u5173\u7cfb\uff0c\u5e76\u514b\u9686\u5fc5\u8981\u7684\u8fd0\u884c\u73af\u5883\nsub_context = await context.build_sub_context(\n    sub_task_content=\"\u8c03\u7814\u957f\u6587\u672c\u6a21\u578b\u6280\u672f\u7ec6\u8282\",\n    sub_task_id=\"sub_task_001\",\n    task_type=\"normal\" # \u652f\u6301 normal \u6216 background (\u540e\u53f0\u5f02\u6b65)\n)\n\n# 2. \u7cbe\u51c6\u4e0a\u4e0b\u6587\u9694\u79bb\u4e0e\u56de\u6eaf\n# \u5b50\u4efb\u52a1\u53ea\u5173\u6ce8\u81ea\u5df1\u7684 input\uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7 {{parent.xxx}} \u83b7\u53d6\u4e3b\u4efb\u52a1\u7684\u80cc\u666f\nparent_goal = await sub_context.prompt_service.async_format(\"{{parent.task_input}}\")\n\n# 3. \u4efb\u52a1\u6267\u884c\u4e0e\u72b6\u6001\u5408\u5e76\n# \u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u5b50\u4efb\u52a1\u4ea7\u751f\u7684 Facts\u3001KV \u53d8\u91cf\u4f1a\u81ea\u52a8\u66f4\u65b0\u5230\u7236\u4efb\u52a1\u4e2d\ncontext.merge_sub_context(sub_context)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#_4","title":"\u5e76\u884c\u6267\u884c\u652f\u6491","text":"<p>\u5728\u5206\u5e03\u5f0f\u573a\u666f\u4e0b\uff0cAmniContext \u652f\u6301\u591a\u4e2a\u5b50\u4efb\u52a1\u5728\u4e0d\u540c\u7684\u6267\u884c\u5f15\u64ce\u4e2d\u5e76\u884c\u8fd0\u884c\u3002\u6bcf\u4e2a\u8282\u70b9\u901a\u8fc7 <code>snapshot</code> \u548c <code>restore</code> \u4fdd\u6301\u4e0a\u4e0b\u6587\u7684\u4e00\u81f4\u6027\uff0c\u6700\u7ec8\u5728\u6839\u8282\u70b9\u5b9e\u73b0\u5168\u5c40\u72b6\u6001\u7684\u7ec8\u6001\u805a\u5408\u3002\u8fd9\u4f7f\u5f97 AWorld \u80fd\u591f\u9ad8\u6548\u5904\u7406\u590d\u6742\u7684\u7814\u7a76\u8c03\u7814\u3001\u4ee3\u7801\u5e93\u91cd\u6784\u7b49\u9700\u8981\u5927\u89c4\u6a21\u5206\u5de5\u7684\u4efb\u52a1\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#53-agent-isolation","title":"5.3 \u591a\u667a\u80fd\u4f53\u9694\u79bb (Agent Isolation)","text":"<p>\u4e3a\u6bcf\u4e2a Agent \u5efa\u7acb\u72ec\u7acb\u7684\u79c1\u6709\u72b6\u6001\u7a7a\u95f4\uff0c\u9632\u6b62\u53d8\u91cf\u6c61\u67d3\u3002</p> <pre><code># 1. \u521d\u59cb\u5316 Agent \u79c1\u6709\u72b6\u6001\nawait context.build_agents_state([web_agent, analyst_agent])\n\n# 2. \u5728\u6307\u5b9a\u547d\u540d\u7a7a\u95f4\u5b58\u53d6\ncontext.put(\"search_history\", [\"link1\", \"link2\"], namespace=web_agent.id())\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#54-freedom-space","title":"5.4 \u73af\u5883\u96c6\u6210\u4e0e\u81ea\u7531\u7a7a\u95f4 (Freedom Space)","text":"<p><code>FreedomSpaceService</code> \u4e3a Agent \u63d0\u4f9b\u4e86\u4e00\u4e2a\u9694\u79bb\u7684\u201c\u81ea\u7531\u7a7a\u95f4\u201d\uff08\u5de5\u4f5c\u76ee\u5f55\uff09\uff0c\u5176\u6838\u5fc3\u80fd\u529b\u662f\u5b9e\u73b0\u6301\u4e45\u5316\u5b58\u50a8\u4e0e\u6267\u884c\u73af\u5883\uff08Sandbox/Docker\uff09\u4e4b\u95f4\u7684\u6587\u4ef6\u7cfb\u7edf\u5171\u4eab\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#_5","title":"\u6838\u5fc3\u7279\u6027","text":"<ul> <li>\u6587\u4ef6\u7cfb\u7edf\u6620\u5c04: Agent \u5728\u81ea\u7531\u7a7a\u95f4\u4e2d\u64cd\u4f5c\u7684\u6587\u4ef6\u4f1a\u81ea\u52a8\u6620\u5c04\u5230\u6267\u884c\u73af\u5883\u4e2d\u7684 <code>env_mount_path</code>\u3002</li> <li>\u900f\u660e\u5b58\u53d6: Agent \u7f16\u5199\u7684\u4ee3\u7801\u6216\u751f\u6210\u7684\u5de5\u4ef6\uff0c\u5728\u7269\u7406\u5b58\u50a8\u5c42\uff08\u672c\u5730/OSS\uff09\u4e0e\u903b\u8f91\u6267\u884c\u5c42\uff08Docker\uff09\u4e4b\u95f4\u662f\u900f\u660e\u540c\u6b65\u7684\u3002</li> <li>\u6301\u4e45\u5316\u4fdd\u8bc1: \u5373\u4f7f\u6267\u884c\u73af\u5883\u9500\u6bc1\uff0c\u81ea\u7531\u7a7a\u95f4\u4e2d\u7684\u6570\u636e\u4f9d\u7136\u4fdd\u7559\u5728 Workspace \u4e2d\uff0c\u652f\u6301\u8de8\u4efb\u52a1\u6062\u590d\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#_6","title":"\u793a\u4f8b\uff1a\u914d\u7f6e\u4e0e\u4f7f\u7528","text":"<pre><code># 1. \u914d\u7f6e\u73af\u5883\u5171\u4eab\u53c2\u6570\nconfig = AmniConfigFactory.create(level=AmniConfigLevel.COPILOT)\nconfig.env_config.env_type = \"remote\" # \u542f\u7528\u8fdc\u7a0b/\u6c99\u76d2\u6a21\u5f0f\nconfig.env_config.env_mount_path = \"/workspace\" # \u6267\u884c\u73af\u5883\u5185\u7684\u6302\u8f7d\u70b9\n\n# 2. \u5411\u81ea\u7531\u7a7a\u95f4\u6dfb\u52a0\u6587\u4ef6\u5e76\u83b7\u53d6\u73af\u5883\u8def\u5f84\nsuccess, env_abs_path, content = await context.freedom_space_service.add_file(\n    filename=\"data_process.py\",\n    content=\"import os\\nprint(os.getcwd())\",\n    mime_type=\"text/x-python\"\n)\n# env_abs_path \u5c06\u8fd4\u56de \"/workspace/data_process.py\"\n\n# 3. \u5728\u4ee3\u7801\u6267\u884c\u5668\u4e2d\u4f7f\u7528\n# Agent \u53ef\u4ee5\u76f4\u63a5\u5728 sandbox \u4e2d\u6267\u884c\u8be5\u8def\u5f84\u4e0b\u7684\u6587\u4ef6\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#_7","title":"\u8def\u5f84\u53d8\u91cf\u5f15\u7528","text":"<p>\u5728 Prompt \u6a21\u677f\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u53d8\u91cf\u7cbe\u51c6\u5f15\u7528\u73af\u5883\u4fe1\u606f\uff08\u8bf7\u786e\u4fdd\u53d8\u91cf\u540d\u4e0e\u4ee3\u7801\u5b9e\u73b0\u4e00\u81f4\uff09\uff1a</p> <ul> <li><code>{{working_dir_env_mounted_path}}</code>: \u83b7\u53d6\u81ea\u7531\u7a7a\u95f4\u5728\u6267\u884c\u73af\u5883\u4e2d\u7684\u7edd\u5bf9\u6302\u8f7d\u8def\u5f84\u3002</li> <li><code>{{working_dir}}</code>: \u8fd4\u56de\u81ea\u7531\u7a7a\u95f4\u4e2d\u6240\u6709\u5df2\u6302\u8f7d\u6587\u4ef6\u7684\u683c\u5f0f\u5316\u5217\u8868\uff08XML \u683c\u5f0f\uff0c\u5305\u542b\u6587\u4ef6\u540d\u4e0e\u7edd\u5bf9\u8def\u5f84\uff09\u3002</li> <li><code>{{current_working_directory}}</code>: \u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u7684\u64cd\u4f5c\u7cfb\u7edf\u8fd0\u884c\u76ee\u5f55\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#55-autonomous-cognition","title":"5.5 \u81ea\u52a8\u5316\u8ba4\u77e5\u52a0\u5de5 (Autonomous Cognition)","text":"<p>\u5728 <code>NAVIGATOR</code> \u7b49\u7ea7\u4e0b\uff0c\u7cfb\u7edf\u5c06\u5168\u9762\u5f00\u542f\u57fa\u4e8e\u201c\u8ba4\u77e5\u95ed\u73af\u201d\u7684\u81ea\u52a8\u9a7e\u9a76\u6a21\u5f0f\uff0c\u5b9e\u73b0 System Prompt \u81ea\u52a8\u589e\u5f3a \u4e0e \u5de5\u5177\u52a8\u6001\u6ce8\u5165\uff1a</p> <ul> <li>System Prompt Augment (\u81ea\u52a8\u62fc\u63a5): \u7cfb\u7edf\u4f1a\u6839\u636e\u914d\u7f6e\u7684 <code>neuron_names</code>\uff08\u5982 <code>task</code>, <code>working_dir</code>, <code>skills</code>, <code>basic</code>\uff09\uff0c\u81ea\u52a8\u5c06\u5f53\u524d\u4efb\u52a1\u72b6\u6001\u3001\u5de5\u4f5c\u76ee\u5f55\u6587\u4ef6\u6e05\u5355\u3001\u73af\u5883\u57fa\u7840\u4fe1\u606f\u7b49\u201c\u795e\u7ecf\u5143\u201d\u62fc\u63a5\u81f3 Agent \u7684 System Prompt \u4e2d\u3002Agent \u65e0\u9700\u663e\u5f0f\u611f\u77e5\u8fd9\u4e9b\u53d8\u91cf\uff0c\u542f\u52a8\u5373\u53ef\u83b7\u5f97\u5168\u91cf\u8bed\u5883\u3002</li> <li>Dynamic Tool Injection (\u5de5\u5177\u52a8\u6001\u6ce8\u5165): \u901a\u8fc7 <code>skills</code> \u795e\u7ecf\u5143\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u4e3a Agent \u6ce8\u5165\u53ef\u9009\u5de5\u5177\uff08Skills\uff09\u7684\u6e05\u5355\u4e0e\u4f7f\u7528\u6307\u5357\u3002<ul> <li>\u6e10\u8fdb\u5f0f\u62ab\u9732: \u521d\u59cb\u4ec5\u6ce8\u5165\u5de5\u5177\u6458\u8981\uff0cAgent \u51b3\u5b9a\u9700\u8981\u67d0\u9879\u6280\u80fd\u65f6\uff0c\u901a\u8fc7 <code>active_skill</code> \u52a8\u6001\u52a0\u8f7d\u5b8c\u6574\u7684\u5de5\u5177 Schema \u4e0e\u8bf4\u660e\u3002</li> <li>\u81ea\u52a8\u5f15\u5bfc: \u81ea\u52a8\u62fc\u63a5 <code>&lt;skills_guide&gt;</code>\uff0c\u544a\u77e5 Agent \u5982\u4f55\u7ba1\u7406\u81ea\u5df1\u7684\u6280\u80fd\u6808\uff08Activate/Offload\uff09\u3002</li> </ul> </li> <li>Automated Reasoning Orchestrator: \u5f00\u542f\u81ea\u4e3b\u63a8\u7406\u7f16\u6392\u3002\u7cfb\u7edf\u6839\u636e\u76ee\u6807\u81ea\u52a8\u9a71\u52a8\u63a8\u7406\u5f15\u64ce\u8fdb\u884c\u7b56\u7565\u5236\u5b9a\u4e0e\u4efb\u52a1\u903b\u8f91\u6d41\u5206\u89e3\u3002\u5f00\u542f\u6b64\u9879\u540e\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u4e3a Agent \u6ce8\u5165 <code>context_planning</code> \u5de5\u5177\uff0c\u4f7f\u5176\u5177\u5907\u81ea\u4e3b\u7ba1\u7406\u4efb\u52a1\u6811\u7684\u80fd\u529b\u3002</li> <li>Automated Cognitive Ingestion: \u5f00\u542f\u81ea\u52a8\u8ba4\u77e5\u6444\u53d6\u3002\u667a\u80fd\u4f53\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u81ea\u52a8\u6444\u53d6\u788e\u7247\u5316\u4fe1\u606f\u5e76\u5c06\u5176\u8f6c\u5316\u4e3a\u7ed3\u6784\u5316\u7684\u8ba4\u77e5\u8d44\u4ea7\u3002\u5f00\u542f\u6b64\u9879\u540e\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u6ce8\u5165 <code>context_knowledge</code> \u5de5\u5177\uff0c\u5e76\u540c\u6b65\u52a0\u8f7d <code>todo</code>\uff08\u4efb\u52a1\u6e05\u5355\uff09\u4e0e <code>action_info</code>\uff08\u6267\u884c\u5386\u53f2\uff09\u795e\u7ecf\u5143\uff0c\u5b9e\u73b0\u5bf9\u6267\u884c\u8fc7\u7a0b\u7684\u5b9e\u65f6\u611f\u77e5\u4e0e\u6c89\u6dc0\u3002</li> <li>Automated Memory Recursive: \u5f00\u542f\u9012\u5f52\u7ecf\u9a8c\u5faa\u73af\u3002\u901a\u8fc7\u6301\u7eed\u56de\u987e\u8fc7\u53bb\u5e76\u4fee\u6b63\u5f53\u524d\u884c\u4e3a\uff0c\u5b9e\u73b0\u95ed\u73af\u8bb0\u5fc6\u68c0\u7d22\u4e0e\u5b58\u50a8\u3002</li> <li>Automated Memory Recall: \u5f00\u542f\u81ea\u52a8\u8bb0\u5fc6\u53ec\u56de\u3002\u7cfb\u7edf\u4e3b\u52a8\u611f\u77e5\u5e76\u53ec\u56de\u76f8\u5173\u7684\u5386\u53f2\u7ecf\u9a8c\uff0c\u8f85\u52a9\u51b3\u7b56\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#6-scenario-based-strategies","title":"6. \u573a\u666f\u5316\u4e0a\u4e0b\u6587\u7b56\u7565\u9009\u62e9 (Scenario-based Strategies)","text":"<p>\u5728\u4e0d\u540c\u7684\u4e1a\u52a1\u573a\u666f\u4e0b\uff0c\u76f2\u76ee\u5806\u53e0\u4e0a\u4e0b\u6587\u53ea\u4f1a\u5bfc\u81f4\u4fe1\u606f\u71b5\u7206\u70b8\u3002\u5e94\u6839\u636e\u4efb\u52a1\u590d\u6742\u5ea6\u7075\u6d3b\u9009\u62e9\u7b56\u7565\uff1a</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#61-simple-chat","title":"6.1 \u573a\u666f\u4e00\uff1a\u7b80\u5355\u5bf9\u8bdd\u4e0e\u5355\u6b21\u95ee\u7b54 (Simple Chat)","text":"<ul> <li>\u7279\u5f81: \u4efb\u52a1\u76ee\u6807\u660e\u786e\uff0c\u4e0d\u4f9d\u8d56\u590d\u6742\u7684\u5916\u90e8\u6587\u4ef6\u6216\u957f\u5386\u53f2\u3002</li> <li>\u63a8\u8350\u7b56\u7565:<ul> <li>\u914d\u7f6e\u7ea7\u522b: <code>AmniConfigLevel.PILOT</code></li> <li>\u6838\u5fc3\u795e\u7ecf\u5143: <code>basic</code> + <code>task</code></li> <li>\u7b56\u7565\u7ec6\u8282: \u4fdd\u6301\u8f83\u4f4e\u7684 <code>history_rounds</code> (\u5982 5-10)\uff0c\u65e0\u9700\u5f00\u542f\u81ea\u52a8\u6458\u8981\u6216\u5378\u8f7d\u3002</li> </ul> </li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#62-complex-researchrag","title":"6.2 \u573a\u666f\u4e8c\uff1a\u590d\u6742\u7814\u7a76\u4e0e\u4fe1\u606f\u68c0\u7d22 (Complex Research/RAG)","text":"<ul> <li>\u7279\u5f81: \u9700\u8981\u9605\u8bfb\u5927\u91cf\u6587\u6863\u3001\u7f51\u9875\uff0c\u68c0\u7d22\u53ec\u56de\u7387\u662f\u5173\u952e\u3002</li> <li>\u63a8\u8350\u7b56\u7565:<ul> <li>\u914d\u7f6e\u7ea7\u522b: <code>AmniConfigLevel.COPILOT</code></li> <li>\u6838\u5fc3\u795e\u7ecf\u5143: <code>knowledge</code> + <code>summaries</code></li> <li>\u96c6\u6210\u5b9e\u8df5: \u5f3a\u5236\u5f00\u542f Contextual Retrieval\uff08\u4e3a\u6bcf\u4e2a Chunk \u8865\u5168\u4e0a\u4e0b\u6587\uff09\uff0c\u5e76\u5229\u7528 Prompt Caching \u7f13\u5b58\u5927\u578b\u53c2\u8003\u8d44\u6599\u3002</li> <li>\u88c1\u526a\u5efa\u8bae: \u9488\u5bf9\u68c0\u7d22\u7ed3\u679c\u4f7f\u7528\u57fa\u4e8e\u76f8\u5173\u6027\u7684 <code>Pruning</code> \u7b56\u7565\uff0c\u4ec5\u4fdd\u7559\u9ad8\u5206\u7247\u6bb5\u3002</li> </ul> </li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#63-planning-execution","title":"6.3 \u573a\u666f\u4e09\uff1a\u89c4\u5212\u5bc6\u96c6\u578b\u4efb\u52a1 (Planning &amp; Execution)","text":"<ul> <li>\u7279\u5f81: \u4efb\u52a1\u94fe\u8def\u957f\uff0c\u5305\u542b\u591a\u4e2a\u5b50\u4efb\u52a1\uff0c\u9700\u8981\u9891\u7e41\u8c03\u7528\u5de5\u5177\u5e76\u611f\u77e5\u4efb\u52a1\u6811\u3002</li> <li>\u63a8\u8350\u7b56\u7565:<ul> <li>\u914d\u7f6e\u7ea7\u522b: <code>AmniConfigLevel.NAVIGATOR</code></li> <li>\u6838\u5fc3\u795e\u7ecf\u5143: <code>task</code> + <code>todo</code> + <code>action_info</code></li> <li>\u81ea\u52a8\u5316\u80fd\u529b: \u5f00\u542f <code>automated_reasoning_orchestrator</code>\uff0c\u8ba9 Agent \u81ea\u4e3b\u7ba1\u7406\u4efb\u52a1\u72b6\u6001\u3002</li> <li>\u72b6\u6001\u7ba1\u7406: \u5728\u6bcf\u4e2a\u5b50\u4efb\u52a1\u8282\u70b9\u5f3a\u5236\u6267\u884c <code>context.snapshot()</code>\uff0c\u9632\u6b62\u7ea7\u8054\u5931\u8d25\u5bfc\u81f4\u7684\u4e0a\u4e0b\u6587\u4e22\u5931\u3002</li> </ul> </li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#64-code-sandbox","title":"6.4 \u573a\u666f\u56db\uff1a\u4ee3\u7801\u6267\u884c\u4e0e\u6c99\u76d2\u534f\u4f5c (Code Sandbox)","text":"<ul> <li>\u7279\u5f81: \u4f9d\u8d56\u672c\u5730/\u8fdc\u7a0b\u6587\u4ef6\u7cfb\u7edf\uff0c\u9700\u8981\u9891\u7e41\u8bfb\u5199\u5de5\u4ef6\u3002</li> <li>\u63a8\u8350\u7b56\u7565:<ul> <li>\u914d\u7f6e\u7ea7\u522b: <code>AmniConfigLevel.COPILOT</code> / <code>NAVIGATOR</code></li> <li>\u6838\u5fc3\u795e\u7ecf\u5143: <code>working_dir</code> + <code>skills</code></li> <li>\u73af\u5883\u96c6\u6210: \u914d\u7f6e <code>env_mount_path</code> \u5b9e\u73b0\u6587\u4ef6\u5171\u4eab\u3002</li> <li>\u5378\u8f7d\u7b56\u7565: \u9488\u5bf9\u6d77\u91cf\u7f16\u8bd1\u65e5\u5fd7\u6216\u6570\u636e\u8f93\u51fa\uff0c\u5f3a\u5236\u5f00\u542f <code>tool_result_offload</code>\uff0c\u9632\u6b62 Token \u6ea2\u51fa\u3002</li> </ul> </li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88Context%EF%BC%89/#7-summary-checklist","title":"7. \u6700\u4f73\u5b9e\u8df5\u6307\u5357 (Summary Checklist)","text":"<ol> <li>\u6ce8\u610f\u529b\u9884\u7b97\u7ba1\u7406: \u59cb\u7ec8\u9075\u5faa\u201c\u6700\u5c0f\u5fc5\u8981\u539f\u5219\u201d\u3002\u6838\u5fc3\u6307\u4ee4\u5efa\u8bae\u901a\u8fc7 <code>{{agent_instruction}}</code> \u663e\u5f0f\u653e\u5728 User Prompt \u9644\u8fd1\uff08Recency Bias \u5229\u7528\uff09\u3002</li> <li>\u547d\u540d\u7a7a\u95f4\u9694\u79bb: \u5728\u591a Agent \u534f\u4f5c\u65f6\uff0c\u52a1\u5fc5\u4f7f\u7528 <code>namespace</code> \u53c2\u6570\u8c03\u7528 <code>put/get</code>\uff0c\u9632\u6b62\u4e0d\u540c Agent \u95f4\u7684\u201c\u8bb0\u5fc6\u6c61\u67d3\u201d\u3002</li> <li>\u7ed3\u6784\u5316\u52a0\u5de5\u6d41: \u4f18\u5148\u5c06\u539f\u59cb\u6570\u636e\u5b58\u50a8\u4e3a Artifacts\uff0c\u5229\u7528 <code>Context Op</code> \u8fdb\u884c\u9012\u5f52\u6458\u8981\uff0c\u4fdd\u6301\u4e0a\u4e0b\u6587\u7684\u9ad8\u4fe1\u566a\u6bd4\u3002</li> </ol>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/","title":"\u6784\u5efaAgent\uff08Build Agent\uff09","text":"<p>AWorld\u4e2d\u53ef\u4ee5\u901a\u8fc7\u5b9a\u4e49\u65b9\u4fbf\u7684\u6784\u5efaAgent\uff0c\u4f7f\u7528\u6700\u5e38\u89c1\u7684llm_agent\u4f5c\u4e3a\u793a\u4f8b\uff0c\u63d0\u4f9bAgent\u7684\u4e00\u4e9b\u80fd\u529b\u7ec6\u8282\uff1a</p> <ol> <li>\u5982\u4f55\u5feb\u901f\u6784\u5efa\u4e00\u4e2aAgent</li> <li>\u5982\u4f55\u5b9a\u5236\u4e00\u4e2aAgent</li> </ol>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#agent","title":"Agent\u6784\u5efa","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#agent_1","title":"\u58f0\u660e\u4e00\u4e2aAgent","text":"<pre><code>from aworld.agents.llm_agent import Agent\n\n# \u8bbe\u7f6eAgent\u540d\nagent = Agent(name=\"my_agent\")\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#llm","title":"LLM\u914d\u7f6e","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#1","title":"\u65b9\u6cd5 1: \u4f7f\u7528\u73af\u5883\u53d8\u91cf","text":"<pre><code>import os\n\n## \u7528\u4e8eLLM\u7684\u73af\u5883\u53d8\u91cf\nos.environ[\"LLM_PROVIDER\"] = \"openai\"  # Choose from: openai, anthropic, azure_openai\nos.environ[\"LLM_MODEL_NAME\"] = \"gpt-4\"\nos.environ[\"LLM_API_KEY\"] = \"your-api-key\"\nos.environ[\"LLM_BASE_URL\"] = \"https://api.openai.com/v1\"  # Optional for OpenAI\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#2-agentconfig","title":"\u65b9\u6cd5 2: \u4f7f\u7528AgentConfig","text":"<pre><code>import os\nfrom aworld.agents.llm_agent import Agent\nfrom aworld.config.conf import AgentConfig\n\nagent_config = AgentConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\nagent = Agent(name=\"my_agent\", conf=agent_config)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#3-modelconfig","title":"\u65b9\u6cd5 3: \u4f7f\u7528ModelConfig","text":"<p>\u5982\u679c\u6709\u591a\u4e2aAgent\u4f7f\u7528\u76f8\u540c\u7684LLM\u670d\u52a1\uff0c\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684ModelConfig\u5b9e\u4f8b\uff1a</p> <pre><code>import os\nfrom aworld.agents.llm_agent import Agent\nfrom aworld.config.conf import AgentConfig, ModelConfig\n\n# Create a shared model configuration\nmodel_config = ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\n# Use the shared model config in agent configuration\nagent_config = AgentConfig(\n    llm_config=model_config,\n)\n\nagent = Agent(name=\"my_agent\", conf=agent_config)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#prompts","title":"Prompts\u8bbe\u7f6e","text":"<pre><code>from aworld.agents.llm_agent import Agent\nimport os\nfrom aworld.config.conf import AgentConfig, ModelConfig\n\nmodel_config = ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\nagent_config = AgentConfig(\n    llm_config=model_config,\n)\n\n# \u8bbe\u7f6esystem prompt\nsystem_prompt = \"\"\"You are a helpful AI assistant that can assist users with various tasks.\nYou should be polite, accurate, and provide clear explanations.\"\"\"\n\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    system_prompt=system_prompt\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#_1","title":"\u5de5\u5177\u8bbe\u7f6e","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#_2","title":"\u672c\u5730\u5de5\u5177","text":"<pre><code>from aworld.agents.llm_agent import Agent\nimport os\nfrom aworld.config.conf import AgentConfig, ModelConfig\nfrom aworld.core.tool.func_to_tool import be_tool\n\nmodel_config = ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\nagent_config = AgentConfig(\n    llm_config=model_config,\n)\n\nsystem_prompt = \"\"\"You are a helpful agent with access to various tools.\"\"\"\n\n\n# \u4f7f\u7528 @be_tool \u5b9a\u4e49\n\n@be_tool(tool_name='greeting_tool', tool_desc=\"A simple greeting tool that returns a hello message\")\ndef greeting_tool() -&gt; str:\n    return \"Hello, world!\"\n\n\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    system_prompt=system_prompt,\n    tool_names=['greeting_tool']\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#mcp-model-context-protocol","title":"MCP (Model Context Protocol)","text":"<pre><code>from aworld.agents.llm_agent import Agent\nimport os\nfrom aworld.config.conf import AgentConfig, ModelConfig\n\nmodel_config = ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\nagent_config = AgentConfig(\n    llm_config=model_config,\n)\n\nsystem_prompt = \"\"\"You are a helpful agent with access to file system operations.\"\"\"\n\n# \u914d\u7f6e MCP \u670d\u52a1\n\nmcp_config = {\n    \"mcpServers\": {\n        \"GorillaFileSystem\": {\n            \"type\": \"stdio\",\n            \"command\": \"python\",\n            \"args\": [\"examples/BFCL/mcp_tools/gorilla_file_system.py\"],\n        },\n    }\n}\n\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    system_prompt=system_prompt,\n    mcp_servers=list(mcp_config.get(\"mcpServers\", {}).keys()),\n    mcp_config=mcp_config\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAAgent%EF%BC%88Build%20Agent%EF%BC%89/#agent-as-tool","title":"Agent as Tool","text":"<pre><code>from aworld.agents.llm_agent import Agent\nimport os\nfrom aworld.config.conf import AgentConfig, ModelConfig\n\nmodel_config = ModelConfig(\n    llm_provider=os.getenv(\"LLM_PROVIDER\", \"openai\"),\n    llm_model_name=os.getenv(\"LLM_MODEL_NAME\"),\n    llm_base_url=os.getenv(\"LLM_BASE_URL\"),\n    llm_api_key=os.getenv(\"LLM_API_KEY\"),\n)\n\nagent_config = AgentConfig(\n    llm_config=model_config,\n)\n\nsystem_prompt = \"\"\"You are a helpful agent that can delegate tasks to other specialized agents.\"\"\"\n\n# \u521b\u5efa\u5de5\u5177agent\ntool_agent = Agent(name=\"tool_agent\", conf=agent_config)\n\n# \u521b\u5efa\u4e3bagent\uff0c\u5176\u5c06tool_agent\u4f5c\u4e3a\u5de5\u5177\u4f7f\u7528\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    system_prompt=system_prompt,\n    agent_names=['tool_agent']\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAWorkflow%EF%BC%88Build%20Workflow%EF%BC%89/","title":"\u6784\u5efaWorkflow\uff08Build Workflow\uff09","text":"<p>AWorld\u4f7f\u7528\u7ecf\u5178\u7684\u56fe\u8bed\u6cd5\u6765\u63cf\u8ff0AWorld\u4e2d\u7684\u5de5\u4f5c\u6d41\u3002\u4ee5\u4e0b\u662f\u6784\u5efa\u4ee3\u7406\u5de5\u4f5c\u6d41\u7684\u57fa\u672c\u573a\u666f\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAWorkflow%EF%BC%88Build%20Workflow%EF%BC%89/#agent-workflow","title":"Agent Workflow","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAWorkflow%EF%BC%88Build%20Workflow%EF%BC%89/#_1","title":"\u987a\u5e8f","text":"<pre><code>\"\"\"\nSequential Agent Pipeline: agent1 \u2192 agent2 \u2192 agent3\n\nExecutes agents in sequence where each agent's output becomes \nthe next agent's input, enabling multi-step collaborative processing.\n\"\"\"\n\nswarm = Swarm([(agent1, agent2), (agent2, agent3)], root_agent=[agent1])\nresult: TaskResponse = Runners.run(input=question, swarm=swarm)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAWorkflow%EF%BC%88Build%20Workflow%EF%BC%89/#_2","title":"\u5e76\u884c","text":"<pre><code>\"\"\"\nParallel Agent Execution with Barrier Synchronization\n\n    Input \u2500\u2500\u252c\u2500\u2192 agent1 \u2500\u2500\u2510\n            \u2502            \u251c\u2500\u2500\u2192 agent3 (barrier wait)\n            \u2514\u2500\u2192 agent2 \u2500\u2500\u2518\n\n- agent1 and agent2 execute in parallel\n- agent3 acts as a barrier, waiting for both agents\n- agent3 processes combined outputs from agent1 and agent2\n\"\"\"\n\nswarm = Swarm([(agent1, agent3), (agent2, agent3)], root_agent=[agent1, agent2])\nresult: TaskResponse = Runners.run(input=question, swarm=swarm)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAWorkflow%EF%BC%88Build%20Workflow%EF%BC%89/#_3","title":"\u5e76\u884c\u591a\u8def\u5f84","text":"<pre><code>\"\"\"\nParallel Multi-Path Agent Execution\n\n    Input \u2500\u2500\u2192 agent1 \u2500\u2500\u252c\u2500\u2500\u2192 agent2 \u2500\u2500\u2510\n                       \u2502             \u2502\n                       \u2514\u2500\u2500\u2192 agent3 \u2190\u2500\u2518 (barrier wait for agent1 &amp; agent2)\n\n- Single input enters only through agent1\n- agent1 distributes to both agent2 and agent3\n- agent2 processes and feeds agent3\n- agent3 waits for both agent1 and agent2 completion\n- agent3 synthesizes outputs from both agent1 and agent2\n\"\"\"\n\nswarm = Swarm([(agent1, agent2), (agent1, agent3), (agent2, agent3)], root_agent=[agent1])\nresult: TaskResponse = Runners.run(input=question, swarm=swarm)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BAWorkflow%EF%BC%88Build%20Workflow%EF%BC%89/#workflow","title":"\u9762\u5411\u4efb\u52a1\u7684Workflow","text":"<p>\u5728\u5206\u5e03\u5f0f\u6216\u5176\u4ed6\u6613\u4e8e\u51fa\u73b0\u8026\u5408\u7684\u573a\u666f\u4e2d\uff0c\u8fdb\u4e00\u6b65\u652f\u6301\u4e86\u9762\u5411\u4efb\u52a1\u7684Workflow\uff0c\u4ee5\u9694\u79bb\u4ee3\u7406\u8fd0\u884c\u65f6\u548c\u73af\u5883\uff0c\u5728\u9700\u8981\u5de5\u5177\u9694\u79bb\u7684\u5206\u5e03\u5f0f\u6216\u5176\u4ed6\u573a\u666f\u4e2d\u7279\u522b\u6709\u7528\u3002 </p> <pre><code>task1 = Task(input=\"my question\", agent=agent1)\ntask2 = Task(agent=agent2)\ntask3 = Task(agent=agent3)\ntasks = [task1, task2, task3]\n\nresult: Dict[str, TaskResponse] = Runners.run_task(tasks, RunConfig(sequence_dependent=True))\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BA%E5%A4%9AAgent%28Build%20MAS%29/","title":"\u6784\u5efa\u591aAgent(Build MAS)","text":"<p>\u5728AWorld\u6846\u67b6\u4e2d\uff0c\u7c7b\u4f3cWorkFlow Construction\uff0cMAS\u6784\u5efa\u7684\u57fa\u7840\u5143\u7d20\u662fAgent\u3002\u901a\u8fc7\u5f15\u5165Swarm\u8fd9\u4e00\u6982\u5ff5\uff0c\u7528\u6237\u53ef\u4ee5\u7b80\u5355\u3001\u5feb\u901f\u3001\u9ad8\u6548\u7684\u6784\u5efa\u590d\u6742\u7684\u591aAgent\u7cfb\u7edf(Multi-Agent System, MAS)\u3002\u603b\u7ed3\uff1a</p> <ol> <li>WorkFlow in AWorld\uff1a\u9759\u6001\u9884\u5148\u8bbe\u5b9a\u7684\u6267\u884c\u6d41\u7a0b</li> <li>MAS in AWorld\uff1a\u52a8\u6001\u5b9e\u65f6\u51b3\u7b56\u7684\u6267\u884c\u6d41\u7a0b</li> </ol> <p>\u8fd9\u6837\u7684\u8bbe\u8ba1\uff0c\u786e\u4fdd\u4e86\u6846\u67b6\u5e95\u5c42\u80fd\u529b\u7684\u7edf\u4e00\uff08\u5373 Agent\uff0c Graph based Topology\uff09\uff0c\u540c\u65f6\u517c\u987e\u4e86\u53ef\u6269\u5c55\u6027\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BA%E5%A4%9AAgent%28Build%20MAS%29/#aworld-mas","title":"\u4e3a\u4ec0\u4e48\u4f7f\u7528AWorld \u6784\u5efaMAS","text":"<ul> <li>\u4fbf\u6377\u3002\u4ee5\u6784\u56fe\u7684\u65b9\u5f0f\uff0c\u4e00\u884c\u7ec4\u5efamulti-agent\u62d3\u6251\u3002</li> <li>\u9ad8\u6548\u3002\u65e0\u4f9d\u8d56\u7684agent\u548c\u5de5\u5177\u81ea\u52a8\u5e76\u884c\u6267\u884c\u3002</li> <li>\u7075\u6d3b\u3002\u4e0d\u4ec5\u53ef\u4ee5\u968f\u65f6\u8c03\u6574\u7b56\u7565\uff0c\u8fd8\u53ef\u4ee5\u4efb\u610f\u7ec4\u5408\u4e0d\u540c\u7c7b\u578b\u7684swarm\u3002</li> <li>\u901a\u7528\u3002\u63d0\u4f9b\u4e00\u822c\u6027\u7684Workflow\u548cHandoff\u673a\u5236\uff0c\u4ee5\u652f\u6301\u5404\u79cd\u534f\u4f5c\u8303\u5f0f\u3002</li> <li>\u6613\u6269\u5c55\u3002\u53ef\u4ee5\u901a\u8fc7\u5b9a\u4e49\u81ea\u5df1\u7684Swarm\u7c7b\u578b\u5b9e\u73b0\uff0c\u5e76\u901a\u8fc7build_cls\u8bbe\u7f6e\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BA%E5%A4%9AAgent%28Build%20MAS%29/#mas","title":"\u6784\u5efaMAS","text":"<p>\u7c7b\u4f3cWorkflow\uff0c\u901a\u8fc7topology\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u7684\u5b9a\u4e49Agents\u4e4b\u95f4\u7684\u901a\u4fe1\u7f51\u7edc\u3002\u4e0d\u4e00\u6837\u7684\u662f\uff0c\u901a\u8fc7build_type=GraphBuildType.HANDOFF\u6211\u4eec\u5141\u8bb8Agents\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb\u53ef\u4ee5\u52a8\u6001\u51b3\u7b56\u3002\u5373\uff1a</p> <ul> <li>agent1\u53ef\u4ee5\u9009\u62e9\u6027\u7684\u51b3\u5b9a\u8c03\u7528agent2\u548cagent3\uff1b\u8c03\u7528\u6b21\u6570\u4e5f\u662f\u52a8\u6001\u7684\uff0c\u4e00\u6b21\u6216\u8005\u591a\u6b21</li> <li>agent2\u53ef\u4ee5\u9009\u62e9\u6027\u7684\u51b3\u5b9a\u8c03\u7528agent3\uff1b\u8c03\u7528\u6b21\u6570\u4e5f\u662f\u52a8\u6001\u7684\uff0c\u4e00\u6b21\u6216\u8005\u591a\u6b21</li> </ul> <pre><code>from aworld.config.conf import AgentConfig\nfrom aworld.agents.llm_agent import Agent\nfrom aworld.core.agent.swarm import Swarm\nfrom aworld.runner import Runners\n\n\nagent_conf = AgentConfig(...)\nagent1 = Agent(name=\"agent1\", conf=agent_conf)\nagent2 = Agent(name=\"agent2\", conf=agent_conf)\nagent3 = Agent(name=\"agent3\", conf=agent_conf)\nswarm = Swarm(topology=[(agent1, agent2), (agent2, agent3), (agent1, agent3)], \n              build_type=GraphBuildType.HANDOFF)\n\nRunners.run(input=\"your question\", swarm=swarm)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BA%E5%A4%9AAgent%28Build%20MAS%29/#agent","title":"\u6307\u5b9a\u5165\u53e3Agent","text":"<p>\u56e0\u4e3aMAS\u5b9a\u4e49\u7684\u65f6\u5019\u672c\u8d28\u662f\u4e00\u4e2aGraph\uff0c\u4e0d\u540c\u7684Agent\u90fd\u53ef\u4ee5\u63a5\u53d7\u5916\u90e8\u7684\u8f93\u5165\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7root_agent\u53c2\u6570\u6307\u5b9a\u63a5\u53d7query\u7684Agent\u3002</p> <pre><code>swarm = Swarm(topology=[(agent1, agent2), (agent2, agent3), (agent1, agent3)], \n              build_type=GraphBuildType.HANDOFF, root_agent=agent1)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BA%E5%A4%9AAgent%28Build%20MAS%29/#_1","title":"\u66f4\u52a0\u7b80\u4fbf\u7684\u62d3\u6251\u7ed3\u6784\u8868\u8fbe","text":"<pre><code>                \u250c\u2500\u2500\u2500\u2500\u2500\u2500 agent1 \u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u250c\u2500\u2500 agent2              agent3\n  \u250c\u2500\u2500\u2500agent4\u2500\u2500\u2500\u2500\u2510                  \u250c\u2518\nagent6        agent7             agent5\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2514\u2500\u2500\u2500\u2500\u2500\u2500agent8\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <pre><code>swarm = Swarm(topology=[\n    (agent1, agent2), (agent2, agent3), (agent2, agent4), \n    (agent3, agent5), (agent4, agent6), (agent4, agent7), \n    (agent6, agent8), (agent7, agent8), (agent5, agent8)\n], build_type=GraphBuildType.HANDOFF, root_agent=agent1)\n</code></pre> <p>\u4e0a\u9762\u662f\u6807\u51c6\u7684\u6784\u5efa\u65b9\u5f0f\uff0c\u4f46\u76f8\u5bf9\u7e41\u7410\uff0c\u56e0\u6b64\u5b9a\u4e49\u4e86\u5e76\u884c[]\u548c\u4e32\u884c()\u8bed\u4e49\uff0c\u5206\u522b\u8868\u793a\u5e76\u884c\u548c\u4e32\u884c\u3002</p> <pre><code># Workflow-specific syntax simplification construction\nswarm = Swarm(topology=[agent1, [(agent2, (agent4, [agent6, agent7])), (agent3, agent5)], agent8],\n              build_type=GraphBuildType.HANDOFF, \n              root_agent=agent1)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BA%E5%A4%9AAgent%28Build%20MAS%29/#dynamic-routing","title":"Dynamic Routing","text":"<p>\u5f53def policy()\u51b3\u7b56\u4e0b\u4e00\u6b65\u8981\u8c03\u7528\u7684\u667a\u80fd\u4f53\u65f6\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\uff0cAgent\u9700\u8981\u6839\u636e\u4e00\u5b9a\u7684\u4e1a\u52a1\u89c4\u5219\u505a\u5b9a\u5236\u5316\u7684\u8def\u7531\uff0c\u4f60\u53ef\u5728\u5bf9\u5e94\u7684Agent\u590d\u5199handler\u5373\u53ef\u3002</p> <pre><code># your_handler_name consistency must be maintained\nagent = Agent(..., event_handler_name=\"your_handler_name\")\n</code></pre> <pre><code>@HandlerFactory.register(name=\"your_handler_name\")\nclass YourHandler(DefaultHandler):\n    def is_valid_message(self, message: Message):\n        if message.category != \"your_handler_name\":\n            return False\n        return True\n\n    async def _do_handle(self, message: Message) -&gt; AsyncGenerator[Message, None]:\n        if not self.is_valid_message(message):\n            return\n\n        # the type of data is generally ActionModel\uff0calso can be comtumized\n        data = message.payload\n        if \"clause1\" in data:\n            pass\n        elif \"clause2\" in data:\n            pass\n</code></pre> <p>\u5728AWorld\u4e2d\u53ef\u4ee5\u53c2\u8003DefaultTaskHandler\u7684\u5b9e\u73b0\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BA%E5%A4%9AAgent%28Build%20MAS%29/#routingreactplan-execute","title":"\u590d\u5199Routing\u7684\u4e24\u4e2a\u4f8b\u5b50\uff1aReAct\u548cPlan-Execute","text":"<p>\u62d3\u6251\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>            \u250c\u2500\u2500\u2500\u2500\u2500\u2500 agent1 \u2500\u2500\u2500\u2500\u2500\u2500\u2510\n           agent2              agent3\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BA%E5%A4%9AAgent%28Build%20MAS%29/#react","title":"ReAct","text":"<pre><code>@HandlerFactory.register(name=f'react')\nclass PlanHandler(AgentHandler):\n    def is_valid_message(self, message: Message):\n        if message.category != 'react':\n            return False\n        return True\n\n    async def _do_handle(self, message: Message) -&gt; AsyncGenerator[Message, None]:\n        yield message\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BA%E5%A4%9AAgent%28Build%20MAS%29/#plan-execute","title":"Plan-Execute","text":"<p>\u5bf9\u6bd4ReAct\uff0cagent2\u548cagent3\u53ef\u4ee5\u540c\u65f6\u5e76\u884c\u6267\u884c</p> <pre><code>@HandlerFactory.register(name=f'plan_execute')\nclass PlanHandler(AgentHandler):\n    def is_valid_message(self, message: Message):\n        if message.category != 'plan_execute':\n            return False\n        return True\n\n    async def _do_handle(self, message: Message) -&gt; AsyncGenerator[Message, None]:\n        logger.info(f\"PlanHandler|handle|taskid={self.task_id}|is_sub_task={message.context._task.is_sub_task}\")\n        content = message.payload\n\n        # parse model plan\n        plan = parse_plan(content[0].policy_info)\n        logger.info(f\"PlanHandler|plan|{plan}\")\n\n        # execute steps\n        output, context = execution_steps(plan.steps)\n\n        # send event message, notify the next processing agent\n        new_plan_input = Observation(content=output)\n        yield AgentMessage(session_id=message.session_id,\n                           payload=new_plan_input,\n                           sender=self.name(),\n                           receiver=self.swarm.communicate_agent.id(),\n                           headers={'context': context})\n</code></pre> <p>\u66f4\u591a\u7ec6\u8282\u53ef\u4ee5\u53c2\u8003examples.</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E6%9E%84%E5%BB%BA%E5%A4%9AAgent%28Build%20MAS%29/#masworkflow","title":"MAS\u548cWorkflow\u7684\u7ec4\u5408\u4e0e\u9012\u5f52","text":"<p>\u76f8\u540c\u6216\u4e0d\u540c\u7c7b\u578b\u7684Swarm\u53ef\u4ee5\u6df1\u5c42\u5d4c\u5957\uff0c\u63d0\u4f9b\u591a\u5c42\u7ea7\u4e0d\u540c\u4ea4\u4e92\u673a\u5236\u7684Swarm\uff0c\u4ee5\u652f\u6301\u590d\u6742\u7684multi-agent\u4ea4\u4e92\u3002\u5982\u505a\u4e00\u4e2a\u65c5\u6e38\u884c\u7a0b\u89c4\u5212\uff0c\u4f7f\u7528Workflow + Team\u7684\u7ed3\u5408\uff0cWorkflow\u63d0\u4f9b\u786e\u5b9a\u6027\u7684\u6d41\u7a0b\uff0cTeam\u505a\u591a\u6e90\u4fe1\u606f\u7684\u68c0\u7d22\u548c\u6574\u5408\u3002</p> <pre><code>from aworld.config.conf import AgentConfig\nfrom aworld.agents.llm_agent import Agent\nfrom aworld.core.agent.swarm import Swarm\n\n# five agents\nrewrite = Agent(name=\"rewrite\", conf=agent_conf)\nplan = Agent(name=\"plan\", conf=agent_conf)\nsearch = Agent(name=\"search\", conf=agent_conf)\nsummary = Agent(name=\"summary\", conf=agent_conf)\nreport = Agent(name=\"report\", conf=agent_conf)\n\n# construct a MAS\nmas = Swarm(topology=[(plan, search), (plan, summary)], \n            build_type=GraphBuildType.HANDOFF, root_agent=plan)\n\n# construct a combination of a workflow with the mas team\ncombination = Swarm([(rewrite, mas), (mas, report)], root_agent=[rewrite])\n</code></pre> <p>\u5373\u9996\u5148\u5bf9\u7528\u6237\u7684\u8f93\u5165\u505arewrite\uff0c\u7136\u540e\u901a\u8fc7TeamSwarm\u5f97\u5230\u7efc\u5408\u7ed3\u679c\uff0c\u6700\u7ec8\u7531report Agent\u8f93\u51fa\u7ed3\u679c\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/","title":"\u81ea\u5b9a\u4e49Agent\uff08Custom Agent\uff09","text":"<p>AWorld\u63d0\u4f9b\u6700\u57fa\u7840\u7684Agent\u63a5\u53e3\uff0c\u4f7fAgent\u7684\u80fd\u529b\u6709\u65e0\u9650\u7684\u53ef\u80fd\u3002\u76ee\u524d\u6700\u5e38\u7528\u7684\u662fLLMAgent\uff0c\u4f46\u6ca1\u6709\u9650\u5236\u5176\u4ed6\u7c7b\u578bAgent\uff0c\u5982\u4f7f\u7528\u89c4\u5219\uff0c\u4f20\u7edf\u6a21\u578b\u4f5c\u4e3a\u5176\u51b3\u7b56\u5185\u6838\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#llmagent","title":"LLMAgent\u6a21\u5757\u5b9a\u5236","text":"<p>LLM Agent\u6700\u5178\u578b\u7684\u80fd\u529b\u662f\u4f7f\u7528LLM\u6765\u51b3\u7b56\u884c\u4e3a\uff0c\u5728AWorld\u4e2d\u62bd\u8c61\u4e3a5\u6b65\uff1a</p> <ol> <li>Agent\u521d\u59cb\u5316\uff0c</li> <li>\u6784\u9020LLM\u8f93\u5165\uff0c</li> <li>\u8c03\u7528LLM\uff0c</li> <li>\u89e3\u6790LLM\u8f93\u51fa\uff0c</li> <li>\u751f\u6210Agent\u54cd\u5e94\u3002</li> </ol>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#agent","title":"\u81ea\u5b9a\u4e49 Agent \u8f93\u5165","text":"<p>\u91cd\u5199 <code>init_observation()</code> \u51fd\u6570\uff0c\u4ee5\u81ea\u5b9a\u4e49\u4ee3\u7406\u5904\u7406\u521d\u59cb\u89c2\u6d4b\u7684\u65b9\u5f0f\uff1a</p> <pre><code>async def init_observation(self, observation: Observation) -&gt; Observation:\n    # \u60a8\u53ef\u4ee5\u4ece\u5176\u4ed6\u4ee3\u7406\u6216\u7b2c\u4e09\u65b9\u5b58\u50a8\u6dfb\u52a0\u6269\u5c55\u4fe1\u606f\uff0c\u5982\u7528\u4e0a\u4e0b\u6587\u4e30\u5bcc\u89c2\u5bdf\n    observation.metadata = {\"timestamp\": time.time(), \"source\": \"custom\"}\n    return observation\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#model","title":"\u81ea\u5b9a\u4e49 Model \u8f93\u5165","text":"<p>\u91cd\u5199 <code>async_messages_transform()</code> \u51fd\u6570\uff0c \u5728\u53d1\u9001\u5230\u6a21\u578b\u4e4b\u524d\u81ea\u5b9a\u4e49messages\u7684\u5185\u5bb9\uff1a</p> <pre><code>async def async_messages_transform(self,\n                                   image_urls: List[str] = None,\n                                   observation: Observation = None,\n                                   message: Message = None,\n                                   **kwargs) -&gt; List[Dict[str, Any]]:\n    messages = []\n\n    # Add system context\n    if hasattr(self, 'system_prompt'):\n        messages.append({\"role\": \"system\", \"content\": self.system_prompt})\n\n    # Add user message\n    if message and message.content:\n        messages.append({\"role\": \"user\", \"content\": message.content})\n\n    # Add images if present\n    if image_urls:\n        for img_url in image_urls:\n            messages.append({\n                \"role\": \"user\",\n                \"content\": [{\"type\": \"image_url\", \"image_url\": {\"url\": img_url}}]\n            })\n\n    return messages\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#model_1","title":"\u81ea\u5b9a\u4e49 Model \u8c03\u7528","text":"<p>\u91cd\u5199 <code>invoke_model()</code> \u51fd\u6570\uff0c\u4ee5\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u6a21\u578b\u8c03\u7528\u548c\u5904\u7406\u903b\u8f91:</p> <pre><code>async def invoke_model(self,\n                       messages: List[Dict[str, str]] = [],\n                       message: Message = None,\n                       **kwargs) -&gt; ModelResponse:\n    \"\"\"Custom model invocation logic.\n       You can use neural networks, rule-based systems, or any other business logic.\n    \"\"\"\n\n      # Example: Use a custom model or business logic\n      if self.use_custom_logic:\n          # Your custom logic here\n          response_content = self.custom_model.predict(messages)\n      else:\n          # Use the default LLM\n          response_content = await self.llm_client.chat_completion(messages)\n\n      return ModelResponse(\n          id=f\"response_{int(time.time())}\",\n          model=self.model_name,\n          content=response_content,\n          tool_calls=None  # Set if tool calls are present\n      )\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#model_2","title":"\u81ea\u5b9a\u4e49 Model \u8f93\u51fa","text":"<p>\u521b\u5efa <code>ModelOutputParser</code> \u5b50\u7c7b\uff0c\u5e76\u5728\u6784\u5efaAgent\u65f6\uff0c\u5c06\u5176\u8d4b\u503c\u7ed9 <code>model_output_parser</code>\u53c2\u6570 :</p> <pre><code>from aworld.models.model_output_parser import ModelOutputParser\n\n\nclass CustomOutputParser(ModelOutputParser[ModelResponse, AgentResult]):\n    async def parse(self, resp: ModelResponse, **kwargs) -&gt; AgentResult:\n        \"\"\"Custom parsing logic based on your model's API response format.\"\"\"\n\n         # \u4eceModelResponse\u83b7\u53d6\u76f8\u5173\u4fe1\u606f\n         content = resp.content\n         tool_calls = resp.tool_calls\n\n         # Create your custom AgentResult\n         result = AgentResult(\n             content=content,\n             tool_calls=tool_calls,\n             metadata={\"parsed_at\": time.time()}\n         )\n\n         return result\n\n\n# \u4f7f\u7528\u81ea\u5b9a\u4e49parser\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    model_output_parser=CustomOutputParser()\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#agent_1","title":"\u81ea\u5b9a\u4e49 Agent \u54cd\u5e94","text":"<p>\u91cd\u5199 <code>async_post_run()</code> \u51fd\u6570\uff0c\u4ee5\u81ea\u5b9a\u4e49\u5982\u4f55\u6784\u5efa\u6700\u7ec8\u7684\u54cd\u5e94\u6d88\u606f\uff1a</p> <pre><code>from aworld.core.message import Message\n\nclass CustomMessage(Message):\n      def __init__(self, content: str, custom_field: str = None):\n            super().__init__(content=content)\n            self.custom_field = custom_field\n\nasync def async_post_run(self,\n                        policy_result: List[ActionModel],\n                        policy_input: Observation,\n                        message: Message = None) -&gt; Message:\n      \"\"\"\n      Customize the agent's response after processing.\n      \"\"\"\n\n      # Process the policy result and create a custom response\n      response_content = f\"Processed {len(policy_result)} actions\"\n      custom_field = \"custom_value\"\n\n       return CustomMessage(\n           content=response_content,\n           custom_field=custom_field\n       )\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#agent_2","title":"\u81ea\u5b9a\u4e49 Agent \u51b3\u7b56","text":"<p>\u4ee5\u4e0a\u5747\u4e3aAgent\u51b3\u7b56\u7684\u4e00\u90e8\u5206\uff0c\u5982\u679c\u60f3\u8981\u91cd\u65b0\u5b9e\u73b0Agent\u7684\u51b3\u7b56\u6d41\u7a0b\uff0c\u53ef\u4ee5\u91cd\u5199 <code>async_policy()</code> \u51fd\u6570\u3002</p> <pre><code>async def async_policy(self, observation: Observation, info: Dict[str, Any] = {}, message: Message = None,\n                           **kwargs) -&gt; List[ActionModel]:\n    self._finished = False\n    # \u6784\u9020\u6a21\u578b\u8f93\u5165\n    messages = await self.build_llm_input(observation, info, message)\n    # \u8c03\u7528\u6a21\u578b\n    llm_response = await self.invoke_model(messages, message=message, **kwargs)\n    # \u89e3\u6790\u7ed3\u679c\n    agent_result = await self.model_output_parser.parse(llm_response,\n                                                        agent_id=self.id(),\n                                                        use_tools_in_prompt=self.use_tools_in_prompt)\n\n    self._finished = True\n    return agent_result.actions\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#agent_3","title":"\u81ea\u5b9a\u4e49 Agent \u4e8b\u4ef6\u5904\u7406","text":"<p>\u5982\u679c\u6846\u67b6\u4ecd\u4e0d\u652f\u6301\u60a8\u60f3\u8981\u7684\u54cd\u5e94\u7ed3\u6784\uff0c\u6216\u8005\u6709\u7279\u6b8a\u7684\u903b\u8f91\u5904\u7406 (\u5982\u57fa\u4e8eAgent\u54cd\u5e94\u89e6\u53d1\u4e0b\u6e38\u591a\u4e2aAgent)\uff0c\u60a8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u4e8b\u4ef6\u5904\u7406\u5668\uff1a</p> <pre><code>from aworld.runners import HandlerFactory\nfrom aworld.runners.default_handler import DefaultHandler\n\n# \u81ea\u5b9a\u4e49 handler \u540d\ncustom_name = \"custom_handler\"\n\n\n@HandlerFactory.register(name=custom_name)\nclass CustomHandler(DefaultHandler):\n    def is_valid_message(self, message: Message):\n        \"\"\"Check if this handler should process the message.\"\"\"\n        return message.category == custom_name\n\n\nasync def _do_handle(self, message: Message) -&gt; AsyncGenerator[Message, None]:\n    \"\"\"Custom message processing logic.\"\"\"\n    if not self.is_valid_message(message):\n        return\n\n    # Implement your custom message processing logic here\n    processed_message = self.process_custom_message(message)\n    yield processed_message\n\n\n# \u4f7f\u7528\u81ea\u5b9a\u4e49 handler\nagent = Agent(\n    name=\"my_agent\",\n    conf=agent_config,\n    event_handler_name=custom_name\n)\n</code></pre> <p>\u91cd\u8981\u63d0\u793a: <code>custom_name</code> \u53d8\u91cf\u503c\u5728\u6ce8\u518c\u548c\u4ee3\u7406\u914d\u7f6e\u4e2d\u5fc5\u987b\u4fdd\u6301\u4e00\u81f4\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#agent_4","title":"Agent\u5b9a\u5236","text":"<p>\u7528\u6237\u53ef\u4ee5\u5b9e\u73b0\u4e00\u5957\u81ea\u5df1\u8bbe\u8ba1\u7684Agent\uff0c\u53ea\u9700\u8981\u7b26\u5408\u63a5\u53e3\u89c4\u8303\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#_1","title":"\u5b9a\u5236\u6574\u4f53\u6d41\u7a0b","text":"<p>\u91cd\u5199<code>run</code>\u6216 <code>async_run</code>\u51fd\u6570\u3002</p> <pre><code># \u5f02\u6b65\nasync def async_run(self, message: Message, **kwargs) -&gt; Message:\n    return Message(...)\n\n# \u540c\u6b65\ndef run(self, message: Message, **kwargs) -&gt; Message:\n    return Message(...)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%87%AA%E5%AE%9A%E4%B9%89Agent%EF%BC%88Custom%20Agent%EF%BC%89/#_2","title":"\u5b9a\u5236\u51b3\u7b56\u6d41\u7a0b","text":"<p>\u91cd\u5199<code>policy</code>\u6216 <code>async_policy</code>\u51fd\u6570\u3002\u5176\u4e2dINPUT\u548cOUTPUT\u5efa\u8bae\u4f7f\u7528 <code>Observation</code>\u548c<code>List[ActionModel]</code>\uff0c\u8fd9\u6837\u80fd\u4ee5\u6700\u5c0f\u7684\u4ee3\u4ef7\u505a\u5b9a\u5236\u3002</p> <pre><code># \u5f02\u6b65\nasync def async_policy(\n    self, observation: INPUT, info: Dict[str, Any] = None, **kwargs\n) -&gt; OUTPUT:\n    pass\n\n# \u540c\u6b65\ndef policy(\n    self, observation: INPUT, info: Dict[str, Any] = None, **kwargs\n) -&gt; OUTPUT:\n    pass\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/","title":"\u8bb0\u5fc6\uff08Memory\uff09","text":"<p>AWorld Memory \u662f\u4e00\u4e2a\u4e13\u4e3a\u591a\u667a\u80fd\u4f53\u7cfb\u7edf\u8bbe\u8ba1\u7684\u7edf\u4e00\u8bb0\u5fc6\u7ba1\u7406\u6846\u67b6\u3002\u5b83\u65e8\u5728\u5e2e\u52a9\u667a\u80fd\u4f53\u5b58\u50a8\u3001\u68c0\u7d22\u548c\u5904\u7406\u4fe1\u606f\uff0c\u4ece\u800c\u5b9e\u73b0\u8de8\u4f1a\u8bdd\u7684\u6301\u7eed\u5b66\u4e60\u3001\u4e2a\u6027\u5316\u4ea4\u4e92\u548c\u7ecf\u9a8c\u8fdb\u5316\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#1","title":"1. \u6838\u5fc3\u6982\u5ff5","text":"<p>AWorld \u5c06\u8bb0\u5fc6\u5212\u5206\u4e3a\u4e24\u4e2a\u4e3b\u8981\u7ef4\u5ea6\uff1a\u77ed\u671f\u8bb0\u5fc6 (Short-Term Memory) \u548c \u957f\u671f\u8bb0\u5fc6 (Long-Term Memory)\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#11-short-term-memory","title":"1.1 \u77ed\u671f\u8bb0\u5fc6 (Short-Term Memory)","text":"<p>\u7528\u4e8e\u5b58\u50a8\u667a\u80fd\u4f53\u5728\u5f53\u524d\u4efb\u52a1\u6216\u4f1a\u8bdd\u4e2d\u7684\u5373\u65f6\u4ea4\u4e92\u8bb0\u5f55\u3002</p> <ul> <li>\u5b58\u50a8\u5bf9\u8c61: <code>MemoryHumanMessage</code> (\u7528\u6237\u8f93\u5165), <code>MemoryAIMessage</code> (AI \u56de\u590d), <code>MemoryToolMessage</code> (\u5de5\u5177\u8c03\u7528\u7ed3\u679c), <code>MemorySystemMessage</code> (\u7cfb\u7edf\u6307\u4ee4)\u3002</li> <li>\u5b58\u50a8\u5f15\u64ce: \u652f\u6301\u591a\u79cd\u540e\u7aef\uff0c\u9ed8\u8ba4\u4e3a <code>InMemoryMemoryStore</code>\uff0c\u751f\u4ea7\u73af\u5883\u63a8\u8350\u4f7f\u7528 <code>PostgresMemoryStore</code>\u3002</li> <li>\u4e0a\u4e0b\u6587\u7ba1\u7406: \u4e3a\u4e86\u9632\u6b62\u4e0a\u4e0b\u6587\u6ea2\u51fa\uff0c\u63d0\u4f9b\u591a\u79cd\u81ea\u52a8\u538b\u7f29\u7b56\u7565\uff1a<ul> <li>\u88c1\u526a\u7b56\u7565 (Trimming): \u4ec5\u4fdd\u7559\u6700\u8fd1\u7684 N \u8f6e\u5bf9\u8bdd\u3002</li> <li>\u56fa\u5b9a\u6b65\u957f\u6458\u8981 (Fixed Step Summary): \u6bcf N \u6761\u6d88\u606f\u751f\u6210\u4e00\u6b21\u6458\u8981\uff0c\u5e76\u79fb\u9664\u5df2\u88ab\u6458\u8981\u7684\u6d88\u606f\u3002</li> <li>\u957f\u5ea6\u89e6\u53d1\u6458\u8981 (Length-based Summary): \u5f53\u6d88\u606f\u603b\u957f\u5ea6\u8d85\u8fc7\u9608\u503c\u65f6\u89e6\u53d1\u6458\u8981\u3002</li> <li>\u5355\u8f6e\u6458\u8981 (Single Round Summary): \u5bf9\u8fc7\u957f\u7684\u5355\u6761\u6d88\u606f\u8fdb\u884c\u5373\u65f6\u538b\u7f29\u3002</li> </ul> </li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#12-long-term-memory","title":"1.2 \u957f\u671f\u8bb0\u5fc6 (Long-Term Memory)","text":"<p>\u7528\u4e8e\u5b58\u50a8\u5177\u6709\u6301\u4e45\u4ef7\u503c\u7684\u4fe1\u606f\uff0c\u652f\u6301\u8de8\u4f1a\u8bdd\u68c0\u7d22\u3002</p> <ul> <li>UserProfile (\u7528\u6237\u753b\u50cf):<ul> <li>\u7ed3\u6784\u5316\u5b58\u50a8\u7528\u6237\u7684\u504f\u597d\u3001\u804c\u4e1a\u3001\u6280\u672f\u6808\u3001\u6c9f\u901a\u98ce\u683c\u7b49\u3002</li> <li>\u793a\u4f8b: <code>key=\"preferences.technical\", value={\"preferred_languages\": [\"Python\"]}</code>\u3002</li> </ul> </li> <li>AgentExperience (\u667a\u80fd\u4f53\u7ecf\u9a8c):<ul> <li>\u8bb0\u5f55\u667a\u80fd\u4f53\u5728\u89e3\u51b3\u590d\u6742\u95ee\u9898\u65f6\u7684\u6210\u529f\u8def\u5f84\u548c\u6280\u80fd\u3002</li> <li>\u7ed3\u6784: <code>skill</code> (\u6280\u80fd\u540d\u79f0), <code>actions</code> (\u52a8\u4f5c\u5e8f\u5217), <code>outcome</code> (\u6267\u884c\u7ed3\u679c)\u3002</li> </ul> </li> <li>Fact (\u4e8b\u5b9e\u6c89\u6dc0):<ul> <li>\u4ece\u5bf9\u8bdd\u4e2d\u63d0\u53d6\u7684\u5177\u4f53\u4e8b\u5b9e\u4fe1\u606f\uff08\u5982\uff1a\u7528\u6237\u4f4f\u5728\u4e0a\u6d77\uff09\u3002</li> </ul> </li> <li>ConversationSummary (\u5386\u53f2\u4f1a\u8bdd\u603b\u7ed3):<ul> <li>\u5bf9\u5df2\u5b8c\u6210\u4f1a\u8bdd\u7684\u9ad8\u5c42\u7ea7\u603b\u7ed3\uff0c\u4f5c\u4e3a\u672a\u6765\u4ea4\u4e92\u7684\u80cc\u666f\u53c2\u8003\u3002</li> </ul> </li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#2","title":"2. \u5feb\u901f\u5f00\u59cb","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#21-memory","title":"2.1 \u521d\u59cb\u5316 Memory \u73af\u5883","text":"<p>\u63a8\u8350\u4f7f\u7528 <code>MemoryFactory</code> \u8fdb\u884c\u5168\u5c40\u521d\u59cb\u5316\u3002</p> <pre><code>from aworld.memory.main import MemoryFactory\nfrom aworld.core.memory import MemoryConfig, MemoryLLMConfig\n\n# \u521d\u59cb\u5316 Memory \u5de5\u5382\nMemoryFactory.init(\n    config=MemoryConfig(\n        provider=\"aworld\", # \u6838\u5fc3\u5f15\u64ce\n        llm_config=MemoryLLMConfig(\n            provider=\"openai\",\n            model_name=\"gpt-4o\",\n            api_key=\"your_api_key\"\n        )\n    )\n)\n\n# \u83b7\u53d6\u5b9e\u4f8b\nmemory = MemoryFactory.instance()\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#22","title":"2.2 \u5728\u667a\u80fd\u4f53\u4e2d\u4f7f\u7528\u8bb0\u5fc6","text":"<p>\u901a\u8fc7 <code>AgentMemoryConfig</code> \u6df1\u5ea6\u5b9a\u5236\u6bcf\u4e2a Agent \u7684\u8bb0\u5fc6\u884c\u4e3a\u3002</p> <pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.core.memory import AgentMemoryConfig, LongTermConfig\n\n# 1. \u914d\u7f6e\u8bb0\u5fc6\u884c\u4e3a\nmemory_config = AgentMemoryConfig(\n    enable_summary=True,        # \u542f\u7528\u81ea\u52a8\u6458\u8981\n    trim_rounds=20,             # \u4fdd\u7559\u6700\u8fd120\u8f6e\n    enable_long_term=True,      # \u542f\u7528\u957f\u671f\u8bb0\u5fc6\n    long_term_config=LongTermConfig.create_simple_config(\n        enable_user_profiles=True,\n        enable_agent_experiences=True\n    )\n)\n\n# 2. \u521b\u5efa\u667a\u80fd\u4f53\nagent = Agent(\n    name=\"MemoryAgent\",\n    agent_memory_config=memory_config,\n    # ... \u5176\u4ed6\u914d\u7f6e\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#3","title":"3. \u57fa\u672c\u64cd\u4f5c","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#31-crud","title":"3.1 \u6838\u5fc3\u64cd\u4f5c\u63a5\u53e3 (CRUD)","text":"<p>\u901a\u8fc7 <code>MemoryFactory.instance()</code> \u62ff\u5230\u5b9e\u4f8b\u540e\uff0c\u53ef\u4ee5\u8fdb\u884c\u4ee5\u4e0b\u6838\u5fc3\u64cd\u4f5c\uff1a</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#1-add","title":"1. \u6dfb\u52a0\u8bb0\u5f55 (<code>add</code>)","text":"<p>\u7528\u4e8e\u5c06\u65b0\u7684\u6d88\u606f\u6216\u8bb0\u5fc6\u9879\u5b58\u5165\u7cfb\u7edf\u3002\u5728 AWorld \u4e2d\uff0c\u6dfb\u52a0\u8bb0\u5f55\u901a\u5e38\u4f1a\u89e6\u53d1\u540e\u7eed\u7684\u81ea\u52a8\u6458\u8981\u6216\u957f\u671f\u8bb0\u5fc6\u63d0\u53d6\u903b\u8f91\u3002</p> <pre><code>from aworld.memory.models import MemoryHumanMessage, MessageMetadata\n\n# \u51c6\u5907\u5143\u6570\u636e\nmetadata = MessageMetadata(\n    user_id=\"u_001\",\n    session_id=\"s_123\",\n    agent_id=\"a_999\",\n    task_id=\"t_456\"\n)\n\n# \u521b\u5efa\u6d88\u606f\u5bf9\u8c61\nmessage = MemoryHumanMessage(content=\"\u4f60\u597d\", metadata=metadata)\n\n# \u6dfb\u52a0\u8bb0\u5fc6\n# agent_memory_config \u53ef\u9009\uff0c\u7528\u4e8e\u89e6\u53d1\u8be5 Agent \u7279\u6709\u7684\u6458\u8981\u7b56\u7565\nawait memory.add(\n    message, \n    agent_memory_config=context.get_config().get_agent_memory_config(namespace=\"a_999\")\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#2-delete","title":"2. \u5220\u9664\u8bb0\u5f55 (<code>delete</code>)","text":"<p>\u6839\u636e ID \u5220\u9664\u6307\u5b9a\u7684\u8bb0\u5fc6\u9879\uff08\u901a\u5e38\u4e3a\u903b\u8f91\u5220\u9664\uff09\u3002</p> <pre><code># \u6839\u636e memory_id \u5220\u9664\nawait memory.delete(\"mem_uuid_12345\")\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#3-get_last_n","title":"3. \u83b7\u53d6\u6700\u8fd1\u5386\u53f2 (<code>get_last_n</code>)","text":"<p>\u8fd9\u662f\u6700\u5e38\u7528\u7684\u63a5\u53e3\uff0c\u7528\u4e8e\u5728\u6784\u5efa LLM Prompt \u65f6\u83b7\u53d6\u6700\u8fd1\u7684\u5bf9\u8bdd\u4e0a\u4e0b\u6587\u3002\u5b83\u4f1a\u81ea\u52a8\u5904\u7406 <code>init</code> (\u7cfb\u7edf/\u521d\u59cb\u4fe1\u606f)\u3001<code>message</code> (\u5bf9\u8bdd) \u548c <code>summary</code> (\u6458\u8981) \u7684\u5408\u5e76\u3002</p> <pre><code># \u83b7\u53d6\u6700\u8fd1 10 \u8f6e\u5386\u53f2\n# filters \u5fc5\u987b\u5305\u542b agent_id, session_id, task_id \u4ee5\u786e\u4fdd\u9694\u79bb\nfilters = {\n    \"agent_id\": \"a_999\",\n    \"session_id\": \"s_123\",\n    \"task_id\": \"t_456\"\n}\n\nhistories = memory.get_last_n(\n    last_rounds=10, \n    filters=filters,\n    agent_memory_config=agent_memory_config # \u4f20\u5165\u914d\u7f6e\u4ee5\u652f\u6301\u66f4\u590d\u6742\u7684\u5408\u5e76\u903b\u8f91\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#4-get_all","title":"4. \u83b7\u53d6\u6240\u6709\u8bb0\u5f55 (<code>get_all</code>)","text":"<p>\u6839\u636e\u8fc7\u6ee4\u5668\u83b7\u53d6\u5339\u914d\u7684\u6240\u6709\u8bb0\u5fc6\u9879\u3002</p> <pre><code># \u83b7\u53d6\u5f53\u524d\u4efb\u52a1\u4e0b\u7684\u6240\u6709\u6d88\u606f\u8bb0\u5f55\nall_messages = memory.get_all(filters={\n    \"task_id\": \"t_456\",\n    \"memory_type\": \"message\"\n})\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#32","title":"3.2 \u8bb0\u5fc6\u9694\u79bb\u7ea7\u522b\u4e0e\u68c0\u7d22\u8fc7\u6ee4\u5668","text":"<p>\u5728\u901a\u8fc7 <code>MemoryFactory.instance()</code> \u62ff\u5230\u5b9e\u4f8b\u540e\uff0c\u6700\u91cd\u8981\u7684\u4e00\u6b65\u662f\u786e\u5b9a\u8bb0\u5fc6\u7684\u9694\u79bb\u7ea7\u522b (History Scope)\u3002\u8fd9\u51b3\u5b9a\u4e86\u667a\u80fd\u4f53\u80fd\u591f\u201c\u56de\u60f3\u8d77\u201d\u591a\u5927\u8303\u56f4\u7684\u5386\u53f2\u4fe1\u606f\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#1-history-scope","title":"1. \u9694\u79bb\u7ea7\u522b (History Scope)","text":"<p>\u5728 <code>AgentMemoryConfig</code> \u4e2d\u901a\u8fc7 <code>history_scope</code> \u53c2\u6570\u914d\u7f6e\uff0c\u652f\u6301\u4ee5\u4e0b\u4e09\u79cd\u7ea7\u522b\uff1a</p> \u7ea7\u522b \u53c2\u6570\u503c \u8bf4\u660e \u9002\u7528\u573a\u666f \u4efb\u52a1\u7ea7 (\u9ed8\u8ba4) <code>task</code> \u4ec5\u68c0\u7d22\u5f53\u524d <code>task_id</code> \u4e0b\u7684\u6d88\u606f\u3002 \u72ec\u7acb\u7684\u4efb\u52a1\u6267\u884c\uff0c\u4e0d\u9700\u8981\u5386\u53f2\u80cc\u666f\u3002 \u4f1a\u8bdd\u7ea7 <code>session</code> \u68c0\u7d22\u76f8\u540c <code>session_id</code> \u4e0b\u7684\u6240\u6709\u6d88\u606f\uff08\u53ef\u80fd\u8de8\u591a\u4e2a Task\uff09\u3002 \u8fde\u7eed\u7684\u591a\u8f6e\u5bf9\u8bdd\uff0c\u7531\u591a\u4e2a\u5b50\u4efb\u52a1\u7ec4\u6210\u3002 \u7528\u6237\u7ea7 <code>user</code> \u68c0\u7d22\u8be5 <code>user_id</code> \u4e0b\u5728\u8be5 Agent \u4e0a\u7684\u6240\u6709\u5386\u53f2\u8bb0\u5f55\u3002 \u957f\u671f\u4e2a\u6027\u5316\u52a9\u624b\uff0c\u9700\u8981\u8bb0\u4f4f\u7528\u6237\u7684\u4e60\u60ef\u3002"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#2_1","title":"2. \u6784\u5efa\u68c0\u7d22\u8fc7\u6ee4\u5668","text":"<p>\u5728\u8c03\u7528 <code>get_last_n</code> \u6216 <code>search</code> \u65f6\uff0c\u6846\u67b6\u4f1a\u6839\u636e\u914d\u7f6e\u7684 Scope \u81ea\u52a8\u6784\u5efa\u8fc7\u6ee4\u5668\u3002\u624b\u52a8\u64cd\u4f5c\u793a\u4f8b\uff1a</p> <pre><code># \u903b\u8f91\u53c2\u8003 aworld/agents/llm_agent.py\ndef build_filters(self, context: Context):\n    filters = {\"agent_id\": self.id()}\n    config = context.get_agent_memory_config(self.id())\n\n    # \u6838\u5fc3\u903b\u8f91\uff1a\u6839\u636e history_scope \u786e\u5b9a\u8fc7\u6ee4\u7ef4\u5ea6\n    scope = config.history_scope or \"task\"\n    if scope == \"user\":\n        filters[\"user_id\"] = context.user_id # \u6216\u4ece task \u4e2d\u83b7\u53d6\n    elif scope == \"session\":\n        filters[\"session_id\"] = context.get_task().session_id\n    else:\n        filters[\"task_id\"] = context.get_task().id\n    return filters\n\n# \u4f7f\u7528\u8fc7\u6ee4\u5668\u83b7\u53d6\u6700\u8fd1\u5386\u53f2\nhistories = memory.get_last_n(\n    last_rounds=config.history_rounds, \n    filters=build_filters(context)\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#33","title":"3.3 \u68c0\u7d22\u957f\u671f\u8bb0\u5fc6","text":"<pre><code># \u68c0\u7d22\u7528\u6237\u753b\u50cf\nprofiles = await memory.retrival_user_profile(\n    user_id=\"u_001\", \n    user_input=\"\u6211\u60f3\u5199\u70b9 Python \u4ee3\u7801\"\n)\n\n# \u68c0\u7d22\u76f8\u5173\u7ecf\u9a8c\nexperiences = await memory.retrival_agent_experience(\n    agent_id=\"a_999\",\n    user_input=\"\u5904\u7406 API \u9891\u7387\u9650\u5236\u62a5\u9519\"\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#4-long-term-extraction","title":"4. \u957f\u671f\u8bb0\u5fc6\u62bd\u53d6 (Long-term Extraction)","text":"<p>\u957f\u671f\u8bb0\u5fc6\u62bd\u53d6\u662f AWorld \u5b9e\u73b0\u201c\u667a\u80fd\u4f53\u8fdb\u5316\u201d\u7684\u6838\u5fc3\u673a\u5236\u3002\u5b83\u901a\u8fc7\u5206\u6790\u77ed\u671f\u5bf9\u8bdd\u5386\u53f2\uff0c\u81ea\u52a8\u6c89\u6dc0\u5177\u6709\u6301\u4e45\u4ef7\u503c\u7684\u77e5\u8bc6\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#41-triggering","title":"4.1 \u89e6\u53d1\u673a\u5236 (Triggering)","text":"<p>\u957f\u671f\u8bb0\u5fc6\u7684\u62bd\u53d6\u4e0d\u662f\u6bcf\u8f6e\u90fd\u53d1\u751f\u7684\uff0c\u800c\u662f\u7531 <code>DefaultMemoryOrchestrator</code> \u6839\u636e\u914d\u7f6e\u89e6\u53d1\uff1a</p> <ul> <li>\u6d88\u606f\u8ba1\u6570\u89e6\u53d1: \u5f53\u77ed\u671f\u8bb0\u5fc6\u4e2d\u7684\u6d88\u606f\u6570\u91cf\u8fbe\u5230 <code>message_count_threshold</code>\uff08\u9ed8\u8ba4 10 \u6761\uff09\u65f6\u89e6\u53d1\u3002</li> <li>\u91cd\u8981\u6027\u89e6\u53d1: \u76d1\u63a7\u6d88\u606f\u4e2d\u7684\u5173\u952e\u8bcd\uff08\u5982 \"error\", \"success\", \"\u5b8c\u6210\"\uff09\uff0c\u4e00\u65e6\u5339\u914d\u5219\u89e6\u53d1\u3002</li> <li>\u5f3a\u5236\u89e6\u53d1: \u5728\u8c03\u7528 <code>trigger_short_term_memory_to_long_term</code> \u65f6\u8bbe\u7f6e <code>force=True</code>\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#42-extraction-flow","title":"4.2 \u62bd\u53d6\u6d41\u7a0b (Extraction Flow)","text":"<p>AWorld \u7684\u957f\u671f\u8bb0\u5fc6\u62bd\u53d6\u662f\u4e00\u4e2a\u5168\u81ea\u52a8\u7684\u8fc7\u7a0b\uff0c\u7531\u7cfb\u7edf\u5728\u540e\u53f0\u9759\u9ed8\u6267\u884c\u3002</p> <ol> <li>\u4efb\u52a1\u521b\u5efa: \u7f16\u6392\u5668\uff08Orchestrator\uff09\u6839\u636e <code>history_scope</code> \u81ea\u52a8\u6536\u96c6\u76f8\u5173\u7684\u6d88\u606f\u6d41\u3002</li> <li>\u5f02\u6b65\u5904\u7406: \u5982\u679c\u542f\u7528\u4e86 <code>enable_background_processing</code>\uff0c\u62bd\u53d6\u4efb\u52a1\u5c06\u5728\u540e\u53f0\u5f02\u6b65\u6267\u884c\uff0c\u4e0d\u5f71\u54cd\u4e3b\u5bf9\u8bdd\u7684\u54cd\u5e94\u901f\u5ea6\u3002</li> <li>LLM \u63d0\u53d6 (Gungnir): <ul> <li>\u5168\u81ea\u52a8\u8bc6\u522b: \u7cfb\u7edf\u4f1a\u81ea\u52a8\u8bc6\u522b\u5bf9\u8bdd\u4e2d\u7684\u5173\u952e\u4fe1\u606f\u5e76\u8fdb\u884c\u7ed3\u6784\u5316\u3002</li> <li>\u652f\u6301 Prompt \u81ea\u5b9a\u4e49: \u867d\u7136\u62bd\u53d6\u662f\u81ea\u52a8\u89e6\u53d1\u7684\uff0c\u4f46\u5f00\u53d1\u8005\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u81ea\u5b9a\u4e49\u62bd\u53d6\u7684 Prompt \u6a21\u677f\u3002\u901a\u8fc7\u4fee\u6539 <code>ExtractionConfig</code> \u4e2d\u7684 <code>user_profile_extraction_prompt</code> \u6216 <code>agent_experience_extraction_prompt</code>\uff0c\u53ef\u4ee5\u7cbe\u786e\u63a7\u5236 LLM \u5173\u6ce8\u7684\u4fe1\u606f\u7c7b\u578b\u548c\u8f93\u51fa\u683c\u5f0f\u3002</li> </ul> </li> <li>\u7ed3\u6784\u5316\u5b58\u50a8: \u63d0\u53d6\u7ed3\u679c\u88ab\u8f6c\u6362\u4e3a <code>UserProfile</code> \u6216 <code>AgentExperience</code> \u5bf9\u8c61\uff0c\u5e76\u6301\u4e45\u5316\u5230 <code>MemoryStore</code> \u548c\u5411\u91cf\u6570\u636e\u5e93\u4e2d\u3002</li> </ol>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#43-fact-extraction","title":"4.3 \u4e8b\u5b9e\u62bd\u53d6 (Fact Extraction)","text":"<p>\u9664\u4e86\u753b\u50cf\u548c\u7ecf\u9a8c\uff0cAWorld \u8fd8\u652f\u6301\u4ece\u5de5\u5177\u6267\u884c\u7ed3\u679c\uff08\u5982\u641c\u7d22\u7ed3\u679c\uff09\u4e2d\u62bd\u53d6\u539f\u5b50\u5316\u7684\u4e8b\u5b9e (Fact)\u3002</p> <ul> <li>\u62bd\u53d6\u573a\u666f: \u901a\u5e38\u7531 <code>ExtractToolFactOp</code> \u5728\u68c0\u6d4b\u5230\u5de5\u5177\u8fd4\u56de\u5927\u91cf\u4fe1\u606f\u65f6\u89e6\u53d1\u3002</li> <li>\u7279\u70b9: \u5c06\u590d\u6742\u7684\u4fe1\u606f\u6d41\u62c6\u89e3\u4e3a\u72ec\u7acb\u7684\u3001\u6700\u5c0f\u5355\u5143\u7684\u77e5\u8bc6\u70b9\uff08\u5982\uff1a\u67d0\u516c\u53f8\u7684\u8d22\u62a5\u6570\u636e\u3001\u67d0\u4e2a\u8f6f\u4ef6\u7684\u53d1\u5e03\u65e5\u671f\uff09\u3002</li> <li>\u4f5c\u7528: \u907f\u514d\u667a\u80fd\u4f53\u5728\u5904\u7406\u957f\u6587\u6863\u6216\u5927\u91cf\u641c\u7d22\u7ed3\u679c\u65f6\u4e22\u5931\u7ec6\u8282\uff0c\u540c\u65f6\u901a\u8fc7\u5411\u91cf\u68c0\u7d22\u5b9e\u73b0\u7cbe\u51c6\u7684\u201c\u4e8b\u5b9e\u53ec\u56de\u201d\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#44","title":"4.4 \u76f8\u5173\u914d\u7f6e","text":"<pre><code>from aworld.core.memory import LongTermConfig\n\n# \u6df1\u5ea6\u5b9a\u5236\u62bd\u53d6\u884c\u4e3a\nlt_config = LongTermConfig()\nlt_config.trigger.message_count_threshold = 15      # \u63d0\u9ad8\u89e6\u53d1\u9608\u503c\nlt_config.trigger.enable_importance_trigger = True  # \u5f00\u542f\u91cd\u8981\u6027\u76d1\u63a7\n\n# \u81ea\u5b9a\u4e49\u62bd\u53d6 Prompt (\u53ef\u9009)\nlt_config.extraction.user_profile_extraction_prompt = \"\u4f60\u662f\u4e00\u4e2a\u4e13\u4e1a\u7684\u4eba\u683c\u5206\u6790\u5e08\uff0c\u8bf7\u4ece\u5bf9\u8bdd\u4e2d\u63d0\u53d6...\"\nlt_config.extraction.agent_experience_extraction_prompt = \"\u8bf7\u603b\u7ed3\u667a\u80fd\u4f53\u5728\u672c\u6b21\u4efb\u52a1\u4e2d\u7684\u6838\u5fc3\u6280\u672f\u8def\u5f84...\"\n\nlt_config.extraction.enable_user_profile_extraction = True\nlt_config.processing.enable_background_processing = True\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#5","title":"5. \u9ad8\u7ea7\u529f\u80fd","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#51","title":"5.1 \u5411\u91cf\u5b58\u50a8\u4e0e\u8bed\u4e49\u641c\u7d22","text":"<p>AWorld Memory \u5185\u7f6e\u4e86\u5411\u91cf\u5316\u652f\u6301\uff0c\u80fd\u591f\u57fa\u4e8e\u8bed\u4e49\u68c0\u7d22\u6700\u76f8\u5173\u7684\u5386\u53f2\u4fe1\u606f\u3002</p> <pre><code>from aworld.core.memory import EmbeddingsConfig, VectorDBConfig\n\n# \u914d\u7f6e\u5411\u91cf\u6570\u636e\u5e93 (\u4f8b\u5982 ChromaDB)\ncustom_config = MemoryConfig(\n    embedding_config=EmbeddingsConfig(\n        provider=\"openai\",\n        model_name=\"text-embedding-3-small\"\n    ),\n    vector_store_config=VectorDBConfig(\n        provider=\"chroma\",\n        config={\"chroma_data_path\": \"./data/chroma\"}\n    )\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#52","title":"5.2 \u8bed\u4e49\u5316\u68c0\u7d22\u63a5\u53e3","text":"<p><code>search</code> \u65b9\u6cd5\u652f\u6301\u6df7\u5408\u68c0\u7d22\uff1a</p> <pre><code>results = memory.search(\n    query=\"\u7528\u6237\u5bf9\u7f16\u7a0b\u8bed\u8a00\u7684\u504f\u597d\",\n    memory_type=\"user_profile\",\n    filters={\"user_id\": \"u_001\"},\n    limit=5\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#53","title":"5.3 \u5185\u90e8\u5b9e\u73b0\u4e0e\u4f18\u5316\u53c2\u8003","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#llm","title":"\u6d88\u606f\u683c\u5f0f\u8f6c\u6362 (LLM \u9002\u914d)","text":"<p>AWorld \u5185\u90e8\u901a\u8fc7 <code>to_openai_message()</code> \u7edf\u4e00\u5c06\u8bb0\u5fc6\u9879\u8f6c\u6362\u4e3a\u6a21\u578b\u53ef\u63a5\u53d7\u7684\u683c\u5f0f\uff1a</p> <pre><code># \u903b\u8f91\u53c2\u8003 aworld/agents/llm_agent.py\nmessages = []\nfor history in histories:\n    if isinstance(history, MemoryMessage):\n        # \u81ea\u52a8\u5904\u7406 role, content \u4ee5\u53ca tool_calls \u7b49\u590d\u6742\u7ed3\u6784\n        messages.append(history.to_openai_message())\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#_1","title":"\u5197\u4f59\u5de5\u5177\u8c03\u7528\u6e05\u7406","text":"<p>\u4e3a\u4e86\u4fdd\u6301\u4e0a\u4e0b\u6587\u6574\u6d01\u5e76\u8282\u7701 Token\uff0c\u6846\u67b6\u5728\u7279\u5b9a\u65f6\u523b\uff08\u5982 Loop \u7ec8\u6b62\u6216\u91cd\u7f6e\u65f6\uff09\u4f1a\u81ea\u52a8\u6e05\u7406\u5197\u4f59\u7684\u5de5\u5177\u8c03\u7528\u6d88\u606f\uff1a</p> <pre><code># \u89c1 _clean_redundant_tool_call_messages \u5b9e\u73b0\n# \u903b\u8f91\uff1a\u4ece\u540e\u5f80\u524d\u904d\u5386\uff0c\u5220\u9664\u672a\u4ea7\u751f\u7ed3\u679c\u6216\u5df2\u5931\u6548\u7684 tool_call \u8bb0\u5f55\nmemory.delete(history_item_id)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%AE%B0%E5%BF%86%EF%BC%88Memory%EF%BC%89/#5_1","title":"5. \u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u5143\u6570\u636e\u4e00\u81f4\u6027: \u59cb\u7ec8\u63d0\u4f9b\u5b8c\u6574\u7684 <code>MessageMetadata</code>\u3002\u7531\u4e8e AWorld \u9ed8\u8ba4\u4f7f\u7528 <code>task_id</code> \u8fdb\u884c\u9694\u79bb\uff0c\u6f0f\u4f20\u5143\u6570\u636e\u4f1a\u5bfc\u81f4\u667a\u80fd\u4f53\u51fa\u73b0\u201c\u5931\u5fc6\u201d\u6216\u201c\u8bb0\u5fc6\u4e32\u6270\u201d\u3002</li> <li>\u9694\u79bb\u7ea7\u522b (History Scope) \u7684\u9009\u62e9\u7b56\u7565:<ul> <li>\u4f7f\u7528 <code>task</code> (\u9ed8\u8ba4): <ul> <li>\u5f53\u4efb\u52a1\u662f\u539f\u5b50\u5316\u7684\uff08\u5982\uff1a\u7ffb\u8bd1\u4e00\u6bb5\u8bdd\u3001\u6267\u884c\u4e00\u4e2a SQL\uff09\u3002</li> <li>\u4e3a\u4e86\u8282\u7701 Token\uff0c\u4e0d\u5e0c\u671b\u5386\u53f2\u5e72\u6270\u5f53\u524d\u51b3\u7b56\u3002</li> <li>\u5e76\u884c\u6267\u884c\u591a\u4e2a\u4e92\u4e0d\u76f8\u5173\u7684\u5b50\u4efb\u52a1\u3002</li> </ul> </li> <li>\u4f7f\u7528 <code>session</code>:<ul> <li>\u4ea4\u4e92\u5f0f\u5bf9\u8bdd\uff08Chat\uff09\uff1a\u7528\u6237\u4f1a\u901a\u8fc7\u201c\u521a\u624d\u8bf4\u7684\u90a3\u4e2a\u201d\u6765\u6307\u4ee3\u5386\u53f2\u3002</li> <li>\u590d\u6742\u6d41\u6c34\u7ebf\uff1a\u524d\u4e00\u4e2a Task \u7684\u8f93\u51fa\u662f\u540e\u4e00\u4e2a Task \u7684\u80cc\u666f\uff08\u5982\uff1a\u641c\u7d22 -&gt; \u6574\u7406 -&gt; \u5199\u62a5\u544a\uff09\u3002</li> <li>\u5355\u6b21\u767b\u5f55\u671f\u95f4\u7684\u4e0a\u4e0b\u6587\u7ef4\u6301\u3002</li> </ul> </li> <li>\u4f7f\u7528 <code>user</code>:<ul> <li>\u4e2a\u6027\u5316\u7ba1\u5bb6\uff1a\u9700\u8981\u8bb0\u4f4f\u7528\u6237\u7684\u540d\u5b57\u3001\u504f\u597d\u3001\u804c\u4e1a\u7b49\u3002</li> <li>\u957f\u671f\u9879\u76ee\u8ffd\u8e2a\uff1a\u8de8\u8d8a\u591a\u5929\u3001\u591a\u6b21\u767b\u5f55\u7684\u6301\u7eed\u6027\u652f\u6301\u3002</li> <li>\u6ce8\u610f\uff1a\u7ea7\u522b\u8d8a\u9ad8\uff0cToken \u6d88\u8017\u548c\u68c0\u7d22\u538b\u529b\u8d8a\u5927\uff0c\u5efa\u8bae\u914d\u5408 <code>enable_summary</code> \u4f7f\u7528\u3002</li> </ul> </li> </ul> </li> <li>\u4e0a\u4e0b\u6587\u538b\u7f29\u4e0e\u5386\u53f2\u4f20\u9012\u7b56\u7565:<ul> <li>\u77ed\u4e0a\u4e0b\u6587\u573a\u666f: \u5efa\u8bae\u901a\u8fc7 <code>session</code> \u7ea7\u522b\u5171\u4eab\u5386\u53f2\u6d88\u606f\u3002\u5728\u4f1a\u8bdd\u957f\u5ea6\u53ef\u63a7\u65f6\uff0c\u76f4\u63a5\u4f20\u9012\u539f\u59cb\u6d88\u606f\u80fd\u4fdd\u6301\u6700\u9ad8\u7684\u4ea4\u4e92\u5fe0\u5b9e\u5ea6\u3002</li> <li>\u957f\u4e0a\u4e0b\u6587\u573a\u666f: <ul> <li>Summary \u7b56\u7565: \u5efa\u8bae\u542f\u7528 <code>enable_summary</code>\uff0c\u901a\u8fc7\u5b9a\u671f\u751f\u6210\u7684\u6458\u8981\u66ff\u6362\u65e7\u6d88\u606f\uff0c\u6709\u6548\u964d\u4f4e Token \u6d88\u8017\u5e76\u4fdd\u7559\u5173\u952e\u80cc\u666f\u3002</li> <li>add_knowledge \u7ed3\u5408\u4f7f\u7528: \u5bf9\u4e8e\u8d85\u957f\u4fe1\u606f\u6216\u9700\u8981\u6301\u4e45\u5316\u7684\u77e5\u8bc6\uff0c\u5efa\u8bae\u4f7f\u7528 <code>add_knowledge</code> \u5c06\u5176\u6c89\u6dc0\u4e3a\u77e5\u8bc6\u7247\u6bb5\u3002\u901a\u8fc7\u201c\u6458\u8981\uff08Summary\uff09\u4fdd\u6301\u6d41\u5f0f\u80cc\u666f\u201d+\u201c<code>add_knowledge</code> \u4fdd\u6301\u5173\u952e\u7ec6\u8282\u201d\u7684\u7ec4\u5408\u6a21\u5f0f\uff0c\u5b9e\u73b0\u9ad8\u6548\u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u3002</li> </ul> </li> </ul> </li> </ol> <p>\u66f4\u591a\u6280\u672f\u7ec6\u8282\u8bf7\u53c2\u8003\u6e90\u7801\u6a21\u5757\uff1a<code>aworld.memory</code></p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/","title":"\u8ffd\u8e2a (Trace)","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_1","title":"\u603b\u89c8","text":"<p>AWorld Trace \u6a21\u5757\u662f\u4e00\u4e2a\u57fa\u4e8e OpenTelemetry \u6784\u5efa\u7684\u5168\u529f\u80fd\u5206\u5e03\u5f0f\u8ffd\u8e2a\u7cfb\u7edf\uff0c\u4e3a AWorld \u6846\u67b6\u63d0\u4f9b\u5b8c\u6574\u7684\u53ef\u89c2\u6d4b\u6027\u80fd\u529b\u3002\u8be5\u6a21\u5757\u63d0\u4f9b\u4e86\u7075\u6d3b\u7684\u8ffd\u8e2a\u914d\u7f6e\u3001\u81ea\u52a8\u63d2\u6869\u548c\u624b\u52a8\u8ffd\u8e2a\u80fd\u529b\uff0c\u652f\u6301\u591a\u79cd\u540e\u7aef\u5b58\u50a8\u548c\u5bfc\u51fa\u65b9\u5f0f\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_2","title":"\u6838\u5fc3\u7279\u6027","text":"<ul> <li>\u57fa\u4e8e OpenTelemetry \u6807\u51c6\u5b9e\u73b0\uff0c\u652f\u6301\u4e0e\u4e3b\u6d41\u53ef\u89c2\u6d4b\u6027\u5e73\u53f0\u517c\u5bb9</li> <li>\u63d0\u4f9b\u81ea\u52a8\u63d2\u6869\u529f\u80fd\uff0c\u65e0\u9700\u4fee\u6539\u4ee3\u7801\u5373\u53ef\u8ffd\u8e2a\u5173\u952e\u7ec4\u4ef6\uff08Agent\u3001Tool\u3001LLM\u7b49\uff09</li> <li>\u652f\u6301\u624b\u52a8\u521b\u5efa\u548c\u7ba1\u7406\u8ffd\u8e2a Span\uff0c\u5b9e\u73b0\u7cbe\u7ec6\u5316\u8ffd\u8e2a</li> <li>\u5185\u7f6e\u5185\u5b58\u5b58\u50a8\u548c Trace UI Server\uff0c\u65b9\u4fbf\u5feb\u901f\u67e5\u770b\u8ffd\u8e2a\u6570\u636e</li> <li>\u652f\u6301\u4e0e\u7b2c\u4e09\u65b9\u53ef\u89c2\u6d4b\u6027\u5e73\u53f0\uff08\u5982 Logfire\u3001Jaeger\uff09\u96c6\u6210</li> <li>\u63d0\u4f9b\u7075\u6d3b\u7684\u914d\u7f6e\u9009\u9879\uff0c\u6ee1\u8db3\u4e0d\u540c\u573a\u666f\u9700\u6c42</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_3","title":"\u4e3b\u8981\u7ec4\u4ef6","text":"<ul> <li>TraceManager \uff1a\u6838\u5fc3\u8ffd\u8e2a\u7ba1\u7406\u5668\uff0c\u8d1f\u8d23\u521b\u5efa\u548c\u7ba1\u7406\u8ffd\u8e2a Span</li> <li>ContextManager \uff1a\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff0c\u5904\u7406\u8ffd\u8e2a\u4e0a\u4e0b\u6587\u7684\u4f20\u64ad</li> <li>Instrumentation \uff1a\u81ea\u52a8\u63d2\u6869\u7ec4\u4ef6\uff0c\u5bf9\u6846\u67b6\u6838\u5fc3\u7ec4\u4ef6\u8fdb\u884c\u8ffd\u8e2a</li> <li>OpenTelemetryAdapter \uff1aOpenTelemetry \u9002\u914d\u5668\uff0c\u5b9e\u73b0\u4e0e OpenTelemetry API \u7684\u6865\u63a5</li> <li>TraceServer \uff1a\u5185\u7f6e\u8ffd\u8e2a UI \u670d\u52a1\u5668\uff0c\u63d0\u4f9b\u53ef\u89c6\u5316\u8ffd\u8e2a\u6570\u636e\u67e5\u770b\u80fd\u529b</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_4","title":"\u5feb\u901f\u5f00\u59cb","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#trace","title":"\u914d\u7f6e\u542f\u7528 Trace","text":"<p>\u8981\u5728 AWorld \u9879\u76ee\u4e2d\u542f\u7528 Trace \u8bb0\u5f55\uff0c\u60a8\u9700\u8981\u5728\u9879\u76ee\u542f\u52a8\u65f6\u914d\u7f6e ObservabilityConfig\uff1a</p> <pre><code>from aworld.trace.config import configure, ObservabilityConfig\n\n# \u914d\u7f6e Trace\nconfig = ObservabilityConfig(\n    trace_provider=\"otlp\",\n    trace_backends=[\"memory\"],  # \u4f7f\u7528\u5185\u5b58\u5b58\u50a8\n    trace_server_enabled=True,  # \u542f\u7528\u5185\u7f6e Trace UI Server\n    trace_server_port=7079       # Trace UI Server \u7aef\u53e3\n)\n\n# \u5e94\u7528\u914d\u7f6e\nconfigure(config)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#trace-ui-server-trace","title":"\u4f7f\u7528\u5185\u7f6e Trace UI Server \u67e5\u770b Trace","text":"<p>\u542f\u7528 Trace UI Server \u540e\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee\u4ee5\u4e0b\u5730\u5740\u67e5\u770b\u8ffd\u8e2a\u6570\u636e\uff1ahttp://localhost:7079</p> <p>Trace UI \u63d0\u4f9b\u4e86\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ul> <li>\u67e5\u770b\u6240\u6709\u8ffd\u8e2a\u8bb0\u5f55\u5217\u8868</li> <li>\u67e5\u770b\u5355\u4e2a\u8ffd\u8e2a\u7684\u5b8c\u6574\u8c03\u7528\u94fe\u8def</li> <li>\u67e5\u770b\u6bcf\u4e2a Span \u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5c5e\u6027\u3001\u72b6\u6001\u548c\u6301\u7eed\u65f6\u95f4</li> <li>\u652f\u6301\u6309\u65f6\u95f4\u6392\u5e8f\u548c\u7b5b\u9009\u8ffd\u8e2a\u8bb0\u5f55</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#trace-ui","title":"Trace UI \u4fe1\u606f\u89e3\u8bfb","text":"<p>AWorld \u6846\u67b6\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u81ea\u52a8\u521b\u5efa\u591a\u4e2a\u6838\u5fc3 Span\uff0c\u7528\u4e8e\u8ffd\u8e2a\u6846\u67b6\u5404\u4e2a\u7ec4\u4ef6\u7684\u6267\u884c\u60c5\u51b5\u3002\u4ee5\u4e0b\u662f\u4e3b\u8981\u7684\u6838\u5fc3 Span \u7c7b\u578b\uff1a</p> <ul> <li>Event Span<ul> <li>\u540d\u79f0\u683c\u5f0f\uff1aevent. <li>\u63cf\u8ff0\uff1aAWorld \u662f\u4ee5event\u9a71\u52a8\u7684\u8fd0\u884c\u6846\u67b6\uff0cTrace\u7cfb\u7edf\u9ed8\u8ba4\u4f1a\u4e3a\u5404\u4e2aEvent\u7684\u6267\u884c\u521b\u5efa\u4e00\u4e2aSpan\uff0cSpan\u540d\u79f0\u4ee5\u201cevent.\u201d\u4e3a\u524d\u7f00\uff0c\u201cevent.\u201d\u540e\u9762\u7684\u4e8c\u7ea7\u540d\u79f0\u4e3aevent\u7c7b\u578b\uff0c\u5982:event.output\uff0c\u4ee3\u8868\u4e00\u6761output\u4e8b\u4ef6</li> <li>\u4e3b\u8981\u5c5e\u6027\uff1a<ul> <li>event.topic\uff1a\u4e8b\u4ef6\u4e3b\u9898</li> <li>event.payload\uff1a\u4e8b\u4ef6\u8be6\u60c5</li> <li>event.sender\uff1a\u4e8b\u4ef6\u53d1\u9001\u8005</li> <li>event.receiver\uff1a\u4e8b\u4ef6\u63a5\u6536\u8005</li> </ul> </li> <li>Task Span<ul> <li>\u540d\u79f0\u683c\u5f0f\uff1atask. <li>\u63cf\u8ff0\uff1a\u4ee3\u8868\u4e00\u4e2a\u5b8c\u6574\u7684\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b</li> <li>\u4e3b\u8981\u5c5e\u6027\uff1a<ul> <li>task.id\uff1a\u4efb\u52a1id</li> <li>task.input\uff1a\u7528\u6237\u8f93\u5165</li> <li>task.is_sub_task\uff1a\u662f\u5426\u4e3a\u5b50\u4efb\u52a1</li> </ul> </li> <li>Agent Span<ul> <li>\u540d\u79f0\u683c\u5f0f\uff1aagent. <li>\u63cf\u8ff0\uff1a\u4ee3\u8868\u4e00\u4e2aagent\u7684\u6267\u884c\u8fc7\u7a0b</li> <li>\u4e3b\u8981\u5c5e\u6027\uff1a<ul> <li>agent.name \uff1aagent\u540d\u79f0</li> <li>agent.id \uff1aagent ID</li> <li>session.id: session ID</li> <li>user.id: \u7528\u6237 ID</li> </ul> </li> <li>Tool Span<ul> <li>\u540d\u79f0\u683c\u5f0f\uff1atool.&lt;\u5de5\u5177\u540d\u79f0&gt;</li> <li>\u63cf\u8ff0\uff1a\u4ee3\u8868\u4e00\u4e2a\u5de5\u5177\u7684\u6267\u884c\u8fc7\u7a0b\uff0c\u5982\u679c\u662fmcp\u5de5\u5177\uff0c&lt;\u5de5\u5177\u540d\u79f0&gt;\u4e3amcp\u670d\u52a1\u7684\u540d\u79f0</li> <li>\u4e3b\u8981\u5c5e\u6027<ul> <li>tool.name\uff1a\u5de5\u5177\u540d\u79f0</li> <li>agent.name \uff1a\u8c03\u7528\u5de5\u5177\u7684agent\u540d\u79f0</li> <li>agent.id \uff1a\u8c03\u7528\u5de5\u5177\u7684agent ID</li> <li>ession.id: session ID</li> <li>user.id: \u7528\u6237 ID</li> </ul> </li> <li>\u5982\u4f55\u67e5\u770b\u5de5\u5177\u6267\u884c\u7ed3\u679c<ul> <li>\u67e5\u770b\u5b50span\u4e2d\u7684\u201cevent.output.tool_call_result\u201dspan</li> </ul> </li> </ul> </li> <li>LLM Span<ul> <li>\u540d\u79f0\u683c\u5f0f\uff1allm.&lt;\u6a21\u578b\u540d\u79f0&gt;</li> <li>\u63cf\u8ff0\uff1a\u4ee3\u8868\u4e00\u6b21LLM\u8c03\u7528\u8fc7\u7a0b</li> <li>\u4e3b\u8981\u5c5e\u6027<ul> <li>gen_ai.prompt\uff1a\u8c03\u7528LLM\u7684\u63d0\u793a\u8bcd</li> <li>gen_ai.prompt.tools\uff1a\u8c03\u7528LLM\u7684\u53ef\u7528\u5de5\u5177\u5217\u8868</li> <li>gen_ai.request.&lt;\u53c2\u6570\u540d&gt;\uff1a\u8c03\u7528LLM\u65f6\u7684\u8bf7\u6c42\u53c2\u6570\uff0c\u5982\uff1agen_ai.request.top_k</li> <li>gen_ai.completion.content\uff1aLLM\u5b8c\u6210\u54cd\u5e94\u5185\u5bb9</li> <li>gen_ai.duration\uff1aLLM\u5b8c\u6210\u54cd\u5e94\u65f6\u95f4</li> <li>gen_ai.completion.reasoning_content\uff1aLLM\u63a8\u7406\u5185\u5bb9</li> <li>gen_ai.completion.tool_calls\uff1aLLM\u8fd4\u56de\u7684\u5de5\u5177\u8c03\u7528\u6307\u4ee4</li> <li>gen_ai.first_token_duration\uff1aLLM\u8fd4\u56de\u7684\u9996token\u65f6\u95f4</li> <li>gen_ai.usage.input_tokens\uff1aLLM\u8c03\u7528\u7684\u8f93\u5165token\u4f7f\u7528\u91cf</li> <li>gen_ai.usage.output_tokens\uff1aLLM\u8c03\u7528\u7684\u8f93\u51fatoken\u4f7f\u7528\u91cf</li> <li>gen_ai.usage.total_tokens\uff1aLLM\u8c03\u7528\u7684token\u603b\u4f7f\u7528\u91cf</li> </ul> </li> </ul> </li>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_5","title":"\u6838\u5fc3\u6982\u5ff5","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#trace_1","title":"Trace\uff08\u8ffd\u8e2a\uff09","text":"<p>Trace \u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u8c03\u7528\u94fe\u8def\uff0c\u7531\u591a\u4e2a Span \u7ec4\u6210\uff0c\u4ee3\u8868\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684\u64cd\u4f5c\u6d41\u7a0b\u3002\u6bcf\u4e2a Trace \u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684 Trace ID\uff0c\u7528\u4e8e\u6807\u8bc6\u6574\u4e2a\u8c03\u7528\u94fe\u8def\u3002\u5728AWorld\u4e2d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2aTrace\u4ee3\u8868\u7528\u6237\u8bf7\u6c42\u7684\u4e00\u4e2aTask\u6267\u884c\u8fc7\u7a0b\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#span","title":"Span\uff08\u8de8\u5ea6\uff09","text":"<p>Span \u662f Trace \u4e2d\u7684\u5355\u4e2a\u64cd\u4f5c\u5355\u5143\uff0c\u4ee3\u8868\u4e86\u4e00\u4e2a\u5177\u4f53\u7684\u6267\u884c\u6b65\u9aa4\u3002\u6bcf\u4e2a Span \u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684 Span ID\uff0c\u5305\u542b\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <ul> <li>\u540d\u79f0\uff1a\u64cd\u4f5c\u7684\u540d\u79f0</li> <li>\u5f00\u59cb\u65f6\u95f4\u548c\u7ed3\u675f\u65f6\u95f4\uff1a\u64cd\u4f5c\u7684\u6267\u884c\u65f6\u95f4\u8303\u56f4</li> <li>\u6301\u7eed\u65f6\u95f4\uff1a\u64cd\u4f5c\u6267\u884c\u7684\u603b\u65f6\u957f</li> <li>\u5c5e\u6027\uff1a\u4e0e\u64cd\u4f5c\u76f8\u5173\u7684\u952e\u503c\u5bf9\u4fe1\u606f</li> <li>\u72b6\u6001\uff1a\u64cd\u4f5c\u7684\u6267\u884c\u72b6\u6001\uff08\u6210\u529f\u3001\u5931\u8d25\u7b49\uff09</li> <li>\u7236 Span ID\uff1a\u7236\u64cd\u4f5c\u7684 Span ID</li> <li>\u5b50 Span \u5217\u8868\uff1a\u5f53\u524d\u64cd\u4f5c\u7684\u5b50\u64cd\u4f5c\u5217\u8868</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#tracecontext","title":"TraceContext\uff08\u8ffd\u8e2a\u4e0a\u4e0b\u6587\uff09","text":"<p>TraceContext \u662f\u8de8\u670d\u52a1\u4f20\u9012\u8ffd\u8e2a\u4fe1\u606f\u7684\u8f7d\u4f53\uff0c\u5305\u542b Trace ID\u3001Span ID \u7b49\u4fe1\u606f\uff0c\u7528\u4e8e\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u5173\u8054\u4e0d\u540c\u670d\u52a1\u7684 Span\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#traceprovider","title":"TraceProvider\uff08\u8ffd\u8e2a\u63d0\u4f9b\u8005\uff09","text":"<p>TraceProvider \u662f\u521b\u5efa\u548c\u7ba1\u7406 Tracer \u7684\u5de5\u5382\uff0c\u8d1f\u8d23\u914d\u7f6e\u548c\u521d\u59cb\u5316\u8ffd\u8e2a\u7cfb\u7edf\u3002AWorld\u5bf9Trace\u64cd\u4f5c\u5b9e\u73b0\u4e86\u9ad8\u5c42\u62bd\u8c61\uff0c\u4f7fAWorld\u5176\u4ed6\u5404\u529f\u80fd\u6a21\u5757\u5bf9Trace\u7684\u4f7f\u7528\u4e0d\u4f9d\u8d56\u4e8e\u67d0\u4e2a\u5177\u4f53\u7684Trace\u5b9e\u73b0\u6846\u67b6\uff0c\u4e0d\u540c\u7684\u4e09\u65b9Trace\u6846\u67b6\u53ef\u4ee5\u63d0\u4f9b\u5404\u81ea\u7684TraceProvider\u63a5\u5165\uff08\u9ed8\u8ba4\u5b9e\u73b0\u4e86Opentelemetry\u6846\u67b6\uff09\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#tracer","title":"Tracer\uff08\u8ffd\u8e2a\u5668\uff09","text":"<p>Tracer \u662f\u521b\u5efa\u548c\u7ba1\u7406 Span \u7684\u7ec4\u4ef6\uff0c\u7528\u4e8e\u5728\u5e94\u7528\u4ee3\u7801\u4e2d\u521b\u5efa\u548c\u7ed3\u675f Span\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#spanconsumer","title":"SpanConsumer\uff08\u8de8\u5ea6\u6d88\u8d39\u8005\uff09","text":"<p>SpanConsumer \u662f\u6d88\u8d39 Span \u6570\u636e\u7684\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u5e2e\u52a9\u7528\u6237\u5b9e\u73b0\u5bf9Spen\u6570\u636e\u7684\u81ea\u5b9a\u4e49\u903b\u8f91\uff0c\u5982\uff1a\u5904\u7406\u548c\u5bfc\u51fa Span \u6570\u636e\u5230\u4e0d\u540c\u7684\u540e\u7aef\u5b58\u50a8\u6216\u5e73\u53f0\uff0c\u5b9e\u65f6\u751f\u6210Agent\u6267\u884c\u8f68\u8ff9\u7b49\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_6","title":"\u4f7f\u7528\u65b9\u5f0f","text":"<pre><code>from aworld.trace.span_cosumer import SpanConsumer, register_span_consumer\nfrom aworld.trace.base import Span\nfrom typing import Sequence\n\n@register_span_consumer\nclass MySpanConsumer(SpanConsumer):\n    def consume(self, spans: Sequence[Span]) -&gt; None:\n        # Process the spans\n        for span in spans:\n            print(f\"Span processed: {span.get_name()}\")\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#instrumentation","title":"Instrumentation\uff08\u63d2\u6869\uff09","text":"<p>Instrumentation \u662f\u81ea\u52a8\u8ffd\u8e2a\u6846\u67b6\u6838\u5fc3\u7ec4\u4ef6\u7684\u673a\u5236\uff0c\u901a\u8fc7\u5b57\u8282\u7801\u589e\u5f3a\u6216\u88c5\u9970\u5668\u7684\u65b9\u5f0f\uff0c\u65e0\u9700\u4fee\u6539\u4ee3\u7801\u5373\u53ef\u5b9e\u73b0\u5bf9\u6838\u5fc3\u7ec4\u4ef6\u7684\u8ffd\u8e2a\u3002AWorld\u4e2d\u5b9e\u73b0\u4e86\u5bf9\u4ee5\u4e0b\u7ec4\u4ef6\u7684\u63d2\u6869\uff1a</p> <ul> <li>EventBusInstrumentor\uff08\u9ed8\u8ba4\u5f00\u542f\uff09\uff1aAWorld\u5185\u90e8\u7684\u6d88\u606f\u603b\u7ebf\u63d2\u6869\uff0c\u4f7fTrace\u80fd\u81ea\u52a8\u4e3aEvent\u6267\u884c\u521b\u5efaSpan\uff0c\u5e76\u8ddf\u8e2aEvent\u7684\u7236\u5b50\u5173\u7cfb\uff0cEvent A\u7684\u5904\u7406\u903b\u8f91\u4e2d\u53d1\u51fa\u4e86Event B\uff0c\u5219Event A\u7684Span\u662fEvent B\u7684Span\u7684\u7236Span\u3002</li> <li>AgentInstrumentor\uff08\u9ed8\u8ba4\u5f00\u542f\uff09: AWorld\u5185\u90e8Agent\u57fa\u7c7b\u63d2\u6869\uff0c\u4f7fTrace\u80fd\u81ea\u52a8\u4e3aAgent\u6267\u884c\u521b\u5efaSpan\uff0c\u800c\u65e0\u9700\u4fb5\u5165Agent\u6838\u5fc3\u4ee3\u7801\u3002</li> <li>ToolInstrumentor\uff08\u9ed8\u8ba4\u5f00\u542f\uff09\uff1aAWorld\u5185\u90e8\u5de5\u5177\u57fa\u7c7b\u63d2\u6869\uff0c\u4f7fTrace\u80fd\u81ea\u52a8\u4e3a\u5de5\u5177\u6267\u884c\u521b\u5efaSpan\uff0c\u800c\u65e0\u9700\u4fb5\u5165\u5de5\u5177\u6838\u5fc3\u4ee3\u7801\u3002</li> <li>LLMModelInstrumentor\uff08\u9ed8\u8ba4\u5f00\u542f\uff09\uff1aAWorld\u5185\u90e8\u5927\u6a21\u578b\u8c03\u7528\u63d2\u6869\uff0c\u4f7fTrace\u80fd\u81ea\u52a8\u4e3a\u6bcf\u6b21LLM\u8c03\u7528\u521b\u5efaSpan\uff0c\u800c\u65e0\u9700\u4fb5\u5165\u8c03\u7528\u6838\u5fc3\u4ee3\u7801\u3002</li> <li>ThreadingInstrumentor\uff08\u9ed8\u8ba4\u5f00\u542f\uff09\uff1a\u5bf9threading\u5e93\u7684\u63d2\u6869\uff0c\u4f7fTrace\u4e0a\u4e0b\u6587\u53ef\u4ee5\u5728\u4e0d\u540c\u7ebf\u7a0b\u4e4b\u95f4\u4f20\u64ad\uff0c\u8fd9\u5728\u591a\u7ebf\u7a0b\u6267\u884c\u6a21\u5f0f\u4e0a\u975e\u5e38\u91cd\u8981\u3002</li> <li>FastAPIInstrumentor\uff1a\u5bf9fastapi\u5e93\u7684\u63d2\u6869\uff0c\u9002\u7528\u4e8e\u5728\u6784\u5efa\u5728FastAPI\u4e4b\u4e0a\u7684web\u670d\u52a1\u7684Trace\u8ffd\u8e2a\uff0c\u542f\u7528\u540e\u53ef\u4ee5\u4e3a\u6bcf\u6b21\u8bf7\u6c42\u7684\u6267\u884c\u521b\u5efaSpan\u3002</li> <li>FlaskInstrumentor\uff1a\u5bf9flask\u5e93\u7684\u63d2\u6869\uff0c\u9002\u7528\u4e8e\u5728\u6784\u5efa\u5728flask\u4e4b\u4e0a\u7684web\u670d\u52a1\u7684Trace\u8ffd\u8e2a\uff0c\u542f\u7528\u540e\u53ef\u4ee5\u4e3a\u6bcf\u6b21\u8bf7\u6c42\u7684\u6267\u884c\u521b\u5efaSpan\u3002</li> <li>RequestsInstrumentor\uff1a\u5bf9requests\u5e93\u7684\u63d2\u6869\uff0c\u9002\u7528\u4e8e\u5bf9\u5916\u90e8\u670d\u52a1\u7684\u8c03\u7528\u7684Trace\u8ffd\u8e2a\uff0c\u542f\u7528\u540e\u53ef\u4ee5\u4e3a\u6bcf\u6b21\u5bf9\u5916\u8bf7\u6c42\u521b\u5efaSpan\u3002</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_7","title":"\u542f\u7528\u65b9\u5f0f","text":"<p>\u4ee5FastAPIInstrumentor\u4e3a\u4f8b\uff1a</p> <pre><code>from aworld.trace.instrumentation.fastapi import FastAPIInstrumentor\n\nFastAPIInstrumentor().instrument()\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_8","title":"\u96c6\u6210\u4e09\u65b9\u89c2\u6d4b\u5e73\u53f0","text":"<p>AWorld\u9ed8\u8ba4\u662f\u57fa\u4e8eOpenTelemetry\u6784\u5efa\u7684Trace\u8ffd\u8e2a\u80fd\u529b\uff0c\u6536\u76ca\u4e8eOpenTelemetry\u7684\u6570\u636e\u4f20\u8f93\u534f\u8baeOTLP\u7684\u5e7f\u6cdb\u4f7f\u7528\uff0c\u4e14\u5df2\u6210\u4e3aTrace\u6570\u636e\u4f20\u8f93\u534f\u8bae\u7684\u4e8b\u5b9e\u6807\u51c6\uff0cAWorld\u53ef\u4ee5\u4e0e\u5e7f\u6cdb\u7684\u4e09\u65b9\u89c2\u6d4b\u5e73\u53f0\u96c6\u6210\uff0c\u5b9e\u73b0Trace\u6570\u636e\u7684\u53ef\u89c6\u5316\u5c55\u793a\u548c\u5206\u6790\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_9","title":"\u4f7f\u7528\u4e09\u65b9\u5546\u7528\u5e73\u53f0","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#logfire","title":"\u4f7f\u7528 Logfire","text":"<p>Pydantic Logfire(https://logfire.pydantic.dev)\u7531Pydantic Validation\u80cc\u540e\u7684\u56e2\u961f\u6253\u9020\uff0c\u662f\u4e00\u79cd\u65b0\u578b\u7684\u53ef\u89c2\u6d4b\u6027\u5e73\u53f0\u3002</p> <p>\u8981\u96c6\u6210 Logfire\uff0c\u60a8\u53ea\u9700\u89812\u6b65\uff1a</p> <ol> <li>\u5230Logfire\u5e73\u53f0\u4e2d\u521b\u5efa\u9879\u76ee\uff0c\u7533\u8bf7Write Token\uff0c\u8bf7\u53c2\u9605Logfire\u5b98\u65b9\u6587\u6863\uff1ahttps://logfire.pydantic.dev/docs/\uff0c\u751f\u4ea7\u73af\u5883\u5efa\u8bae\u8d2d\u4e70\u4ed8\u8d39\u8ba1\u5212\u3002</li> <li>AWorld\u5e94\u7528\u542f\u52a8\u65f6\uff0c\u914d\u7f6e\u76f8\u5e94\u7684 Trace Provider \u548c\u540e\u7aef\uff1a</li> </ol> <pre><code>from aworld.trace.config import configure, ObservabilityConfig\n\n# \u914d\u7f6e Logfire \u96c6\u6210\nconfig = ObservabilityConfig(\n    trace_provider=\"otlp\",\n    trace_backends=[\"logfire\"],  # \u4f7f\u7528 Logfire \u4f5c\u4e3a\u540e\u7aef\n    trace_base_url=\"https://logfire-us.pydantic.dev\",  # Logfire API URL\n    trace_write_token=\"your-logfire-write-token\"  # Logfire \u5199\u5165\u4ee4\u724c\n)\n\n# \u5e94\u7528\u914d\u7f6e\nconfigure(config)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_10","title":"\u4f7f\u7528\u4e09\u65b9\u5f00\u6e90\u5e73\u53f0","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#jaeger","title":"\u4f7f\u7528 Jaeger","text":"<p>Jaeger \uff08https://www.jaegertracing.io/\uff09\u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u8ffd\u8e2a\u5e73\u53f0\uff0c\u7531Uber Technologies\u4e8e 2016 \u5e74\u4ee5\u5f00\u6e90\u5f62\u5f0f\u53d1\u5e03\uff0c\u5e76\u6350\u8d60\u7ed9\u4e86\u4e91\u539f\u751f\u8ba1\u7b97\u57fa\u91d1\u4f1a\uff0c\u5b83\u662f\u8be5\u57fa\u91d1\u4f1a\u7684\u6bd5\u4e1a\u9879\u76ee\u3002</p> <p>\u4f7f\u7528Jaeger\u8fd9\u6837\u7684\u5f00\u6e90\u5e93\u4f5c\u4e3a\u540e\u7aef\u89c2\u6d4b\u5e73\u53f0\uff0c\u9700\u8981\u7528\u6237\u81ea\u5df1\u642d\u5efa\u5e73\u53f0\u670d\u52a1\uff0c\u8fd0\u7ef4\u6210\u672c\u4e0e\u96be\u5ea6\u76f8\u5bf9\u8f83\u5927\u3002Jaeger\u540e\u7aef\u5e73\u53f0\u642d\u5efa\u8bf7\u53c2\u9605\u5b98\u65b9\u6587\u6863\uff1ahttps://www.jaegertracing.io/docs/2.13/deployment/</p> <p>AWorld\u5e94\u7528\u542f\u52a8\u65f6\uff0c\u914d\u7f6e\u76f8\u5e94\u7684 Trace Provider \u548c\u540e\u7aef\uff1a</p> <pre><code>from aworld.trace.config import configure, ObservabilityConfig\n\n# \u914d\u7f6e Jaeger \u96c6\u6210\nconfig = ObservabilityConfig(\n    trace_provider=\"otlp\",\n    trace_backends=[\"other_otlp\"],  # \u4f7f\u7528\u81ea\u5b9a\u4e49 OTLP \u540e\u7aef\n    trace_base_url=\"http://localhost:4317\",  # Jaeger OTLP \u63a5\u6536\u5668\u5730\u5740\n    trace_write_token=None  # Jaeger \u901a\u5e38\u4e0d\u9700\u8981\u4ee4\u724c\n)\n\n# \u5e94\u7528\u914d\u7f6e\nconfigure(config)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#trace_2","title":"\u5982\u4f55\u81ea\u5b9a\u4e49 Trace \u8bb0\u5f55","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#span_1","title":"\u4f7f\u7528\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u521b\u5efa Span","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528 TraceManager \u7684 span \u65b9\u6cd5\u521b\u5efa\u81ea\u5b9a\u4e49 Span\uff1a</p> <pre><code>import aworld.trace as trace \n\nwith trace.span(\"custom_operation\", attributes={\"custom_attr\": \"value\"}):\n    # \u6267\u884c\u9700\u8981\u8ffd\u8e2a\u7684\u64cd\u4f5c\n    result = perform_custom_operation()\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#span_2","title":"\u88c5\u9970\u5668\u65b9\u5f0f\u521b\u5efa Span","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528 func_span \u88c5\u9970\u5668\u4e3a\u51fd\u6570\u521b\u5efa\u8ffd\u8e2a Span\uff1a</p> <pre><code>import aworld.trace as trace \n\n# \u4f7f\u7528\u88c5\u9970\u5668\u521b\u5efa Span\n@trace.func_span(\"custom_function\", attributes={\"function_type\": \"business\"},extract_args=True)\ndef custom_function(param1, param2):\n    # \u51fd\u6570\u5b9e\u73b0\n    return result\n</code></pre> <p>\u5176\u4e2dextract_args\u53c2\u6570\u7528\u4e8e\u63a7\u5236\u662f\u5426\u62bd\u53d6\u51fd\u6570\u53c2\u6570\u5217\u8868\uff0c\u5199\u5165Span\u5c5e\u6027\u4e2d\uff0c\u9ed8\u8ba4\u503c\u4e3aFalse\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#span_3","title":"\u83b7\u53d6\u5f53\u524d Span \u5e76\u6dfb\u52a0\u5c5e\u6027","text":"<p>\u60a8\u53ef\u4ee5\u83b7\u53d6\u5f53\u524d\u6d3b\u52a8\u7684 Span \u5e76\u6dfb\u52a0\u81ea\u5b9a\u4e49\u5c5e\u6027\uff1a</p> <pre><code>import aworld.trace as trace \n\n# \u83b7\u53d6\u5f53\u524d Span\ncurrent_span = trace.get_current_span()\n\n# \u6dfb\u52a0\u81ea\u5b9a\u4e49\u5c5e\u6027\ncurrent_span.set_attribute(\"custom_key\", \"custom_value\")\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#span_4","title":"\u624b\u52a8\u7ba1\u7406 Span \u751f\u547d\u5468\u671f","text":"<p>\u60a8\u4e5f\u53ef\u4ee5\u624b\u52a8\u7ba1\u7406 Span \u7684\u751f\u547d\u5468\u671f\uff1a</p> <pre><code>import aworld.trace as trace \n\n# \u521b\u5efa Span\nspan = trace.span(\"manual_operation\")\n\ntry:\n    # \u6267\u884c\u9700\u8981\u8ffd\u8e2a\u7684\u64cd\u4f5c\n    result = perform_operation()\n\n    # \u8bbe\u7f6e Span \u72b6\u6001\u4e3a\u6210\u529f\n    span.set_status(\"OK\")\nfinally:\n    # \u7ed3\u675f Span\n    span.end()\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_11","title":"\u9ad8\u7ea7\u529f\u80fd","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_12","title":"\u81ea\u52a8\u8ffd\u8e2a\u914d\u7f6e","text":"<p>\u60a8\u53ef\u4ee5\u914d\u7f6e\u81ea\u52a8\u8ffd\u8e2a\u4ee5\u6253\u5f00\u51fd\u6570\u8c03\u7528\u7684\u81ea\u52a8\u8ffd\u8e2a\u529f\u80fd\uff0c\u5f00\u542f\u540e\uff0c\u6bcf\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\u90fd\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2aSpan\u3002</p> <pre><code>import aworld.trace as trace\n\n# \u914d\u7f6e\u81ea\u52a8\u8ffd\u8e2a\ntrace.auto_tracing(\n    modules=[\"my_module\", \"another_module\"],  # \u8981\u8ffd\u8e2a\u7684\u6a21\u5757\n    min_duration=0.1  # \u6700\u5c0f\u6301\u7eed\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u53ea\u6709\u8d85\u8fc7\u6b64\u65f6\u95f4\u7684\u51fd\u6570\u624d\u4f1a\u88ab\u8ffd\u8e2a\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#trace_3","title":"Trace\u547d\u540d\u7a7a\u95f4\u9694\u79bb","text":"<p>\u60a8\u53ef\u80fd\u4f7f\u7528AWorld\u6784\u5efa\u4e86\u591a\u4e2a\u4e0d\u540c\u7684\u5e94\u7528\uff0c\u4e0d\u540c\u5e94\u7528\u7684Trace\u6570\u636e\u4f7f\u7528\u4e0d\u540c\u7684\u547d\u540d\u7a7a\u95f4\u8fdb\u884c\u9694\u79bb\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u6765\u6307\u4ee4Trace\u547d\u540d\u7a7a\u95f4\u3002</p> <pre><code>os.environ[\"MONITOR_SERVICE_NAME\"] = \"otlp_example\"\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#trace_4","title":"\u96c6\u6210\u5176\u4ed6Trace\u4f20\u64ad\u534f\u8bae","text":"<p>AWorld Trace \u6a21\u5757\u5185\u90e8\u9ed8\u8ba4\u4f7f\u7528Opentelemetry\u7684W3C\u4f20\u64ad\u534f\u8bae\uff0c\u5f53\u4f7f\u7528\u5176\u4ed6Trace\u4f20\u64ad\u534f\u8bae\u7684\u5e94\u7528\u4e0eAWorld\u5e94\u7528\u4ea4\u4e92\u65f6\uff0c\u7531\u4e8e\u534f\u8bae\u4e0d\u4e00\u81f4\uff0ctrace\u5c31\u65e0\u6cd5\u8de8\u5e94\u7528\u4f20\u64ad\u3002\u4e3a\u6b64\uff0cAWorld Trace \u652f\u6301\u901a\u8fc7\u81ea\u5b9a\u4e49\u4f20\u64ad\u534f\u8bae\u5b9e\u73b0\u4e0d\u540c\u7cfb\u7edf\u95f4\u7684\u8ffd\u8e2a\u4e0a\u4e0b\u6587\u4f20\u9012\u3002\u4f20\u64ad\u534f\u8bae\u8d1f\u8d23\u5728\u670d\u52a1\u95f4\u6216\u5e94\u7528\u95f4\u4f20\u9012 TraceContext \u4fe1\u606f\uff0c\u786e\u4fdd\u8ffd\u8e2a\u94fe\u8def\u7684\u8fde\u7eed\u6027\u3002\u4f8b\u5982\uff0cAWorld\u652f\u6301\u4e0eSofa\u5e94\u7528\u7684Trace\u65e0\u7f1d\u4f20\u64ad\uff0c\u60a8\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0\u81ea\u5b9a\u4e49\u4f20\u64ad\u534f\u8bae\uff0c\u5b9e\u73b0AWorld\u5e94\u7528\u4e0e\u4f7f\u7528Zipkin\u505aTrace\u8ffd\u8e2a\u7684\u5e94\u7528\u4e92\u901aTrace\u4e0a\u4e0b\u6587\u3002</p> <p></p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_13","title":"\u6838\u5fc3\u6982\u5ff5","text":"<ul> <li>Propagator \uff1a\u4f20\u64ad\u5668\u63a5\u53e3\uff0c\u5b9a\u4e49\u4e86\u4ece\u8f7d\u4f53\u63d0\u53d6\u548c\u6ce8\u5165\u8ffd\u8e2a\u4e0a\u4e0b\u6587\u7684\u65b9\u6cd5</li> <li>TraceContext \uff1a\u8ffd\u8e2a\u4e0a\u4e0b\u6587\uff0c\u5305\u542b trace_id\u3001span_id\u3001\u7248\u672c\u7b49\u6838\u5fc3\u4fe1\u606f</li> <li>Carrier \uff1a\u8f7d\u4f53\uff0c\u7528\u4e8e\u5b58\u50a8\u548c\u4f20\u8f93\u8ffd\u8e2a\u4e0a\u4e0b\u6587\u7684\u5a92\u4ecb\uff08\u5982 HTTP \u5934\u3001\u6d88\u606f\u5934\uff09</li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_14","title":"\u4f20\u64ad\u534f\u8bae\u96c6\u6210\u67b6\u6784","text":"<p>AWorld \u4f7f\u7528 CompositePropagator \u5b9e\u73b0\u591a\u534f\u8bae\u652f\u6301\uff0c\u5176\u67b6\u6784\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%BD%E8%B8%AA%20%28Trace%29%20/#_15","title":"\u5b9e\u73b0\u81ea\u5b9a\u4e49\u4f20\u64ad\u534f\u8bae","text":"<p>1\u3001\u7ee7\u627f Propagator \u62bd\u8c61\u7c7b</p> <p>\u8981\u5b9e\u73b0\u81ea\u5b9a\u4e49\u4f20\u64ad\u534f\u8bae\uff0c\u9996\u5148\u9700\u8981\u7ee7\u627f Propagator \u62bd\u8c61\u7c7b\u5e76\u5b9e\u73b0 extract \u548c inject \u65b9\u6cd5\uff1a</p> <ul> <li>extract\uff1a\u5f53\u4e00\u4e2a\u8bf7\u6c42\u4ece\u5176\u4ed6\u4f20\u64ad\u534f\u8bae\uff08\u5982\uff1aZipkin B3 \u4f20\u64ad\u534f\u8bae\uff09\u7684\u5e94\u7528\u8fdb\u5165AWorld\u5e94\u7528\u65f6\uff0c\u6839\u636eB3\u534f\u8bae\u62bd\u53d6\u8bf7\u6c42\u4e0a\u4e0b\u6587\u4e2d\u7684Trace\u4fe1\u606f\uff08trace_id, span_id, baggage\u7b49\uff09\u3002</li> <li>inject\uff1a\u5f53\u4e00\u4e2a\u8bf7\u6c42\u4eceAWorld\u5e94\u7528\u53d1\u9001\u5230\u5176\u4ed6\u4f20\u64ad\u534f\u8bae\u5e94\u7528\u65f6\uff0c\u5c06trace\u4fe1\u606f\u6309\u76ee\u6807\u5e94\u7528\u7684trace\u4f20\u64ad\u534f\u8bae\u5199\u5165\u8bf7\u6c42\u4e0a\u4e0b\u6587\u4e2d\u3002</li> </ul> <pre><code>from aworld.trace.base import Propagator, TraceContext, Carrier\nfrom aworld.logs.util import logger\n\nclass CustomTracePropagator(Propagator):\n    \"\"\"\n    \u81ea\u5b9a\u4e49 Trace \u4f20\u64ad\u534f\u8bae\u5b9e\u73b0\n    \"\"\"\n\n    # \u5b9a\u4e49\u534f\u8bae\u5934\u540d\u79f0\n    _CUSTOM_TRACE_ID_HEADER = \"X-Custom-Trace-ID\"\n    _CUSTOM_SPAN_ID_HEADER = \"X-Custom-Span-ID\"\n    _CUSTOM_FLAGS_HEADER = \"X-Custom-Flags\"\n\n    def extract(self, carrier: Carrier) -&gt; Optional[TraceContext]:\n        \"\"\"\n        \u4ece\u8f7d\u4f53\u4e2d\u63d0\u53d6\u81ea\u5b9a\u4e49\u8ffd\u8e2a\u4e0a\u4e0b\u6587\n        \"\"\"\n        # \u83b7\u53d6\u81ea\u5b9a\u4e49\u534f\u8bae\u5934\n        trace_id = self._get_value(carrier, self._CUSTOM_TRACE_ID_HEADER)\n        span_id = self._get_value(carrier, self._CUSTOM_SPAN_ID_HEADER)\n        flags = self._get_value(carrier, self._CUSTOM_FLAGS_HEADER) or \"01\"\n\n        logger.debug(f\"Extract custom trace context: trace_id={trace_id}, span_id={span_id}\")\n\n        # \u9a8c\u8bc1\u5fc5\u8981\u53c2\u6570\n        if not trace_id or not span_id:\n            return None\n\n        # \u521b\u5efa\u5e76\u8fd4\u56de TraceContext\n        return TraceContext(\n            trace_id=trace_id,\n            span_id=span_id,\n            trace_flags=flags,\n            version=\"00\",  # \u81ea\u5b9a\u4e49\u7248\u672c\u53f7\n            attributes={\n                \"custom_protocol\": \"v1\",\n                # \u53ef\u4ee5\u6dfb\u52a0\u66f4\u591a\u81ea\u5b9a\u4e49\u5c5e\u6027\n            }\n        )\n\n    def inject(self, trace_context: TraceContext, carrier: Carrier) -&gt; None:\n        \"\"\"\n        \u5c06\u8ffd\u8e2a\u4e0a\u4e0b\u6587\u6ce8\u5165\u5230\u8f7d\u4f53\u4e2d\n        \"\"\"\n        if not trace_context:\n            return\n\n        logger.debug(f\"Inject custom trace context: trace_id={trace_context.trace_id}, span_id={trace_context.span_id}\")\n\n        # \u6ce8\u5165\u81ea\u5b9a\u4e49\u534f\u8bae\u5934\n        carrier.set(self._CUSTOM_TRACE_ID_HEADER, trace_context.trace_id)\n        carrier.set(self._CUSTOM_SPAN_ID_HEADER, trace_context.span_id)\n        carrier.set(self._CUSTOM_FLAGS_HEADER, trace_context.trace_flags)\n\n        # \u53ef\u4ee5\u6ce8\u5165\u66f4\u591a\u81ea\u5b9a\u4e49\u5c5e\u6027\n        if \"custom_protocol\" in trace_context.attributes:\n            carrier.set(\"X-Custom-Protocol-Version\", trace_context.attributes[\"custom_protocol\"])\n</code></pre> <p>2\u3001\u6ce8\u518c\u81ea\u5b9a\u4e49\u4f20\u64ad\u5668</p> <p>\u5b9e\u73b0\u81ea\u5b9a\u4e49\u4f20\u64ad\u5668\u540e\uff0c\u9700\u8981\u5c06\u5176\u6ce8\u518c\u5230\u5168\u5c40\u4f20\u64ad\u5668\u4e2d\uff1a</p> <pre><code>from aworld.trace.propagator import get_global_trace_propagator, CompositePropagator\nfrom my_custom_propagator import CustomTracePropagator\n\n# \u83b7\u53d6\u5f53\u524d\u5168\u5c40\u4f20\u64ad\u5668\nglobal_propagator = get_global_trace_propagator()\n\n# \u83b7\u53d6\u73b0\u6709\u4f20\u64ad\u5668\u5217\u8868\nif isinstance(global_propagator, CompositePropagator):\n    existing_propagators = list(global_propagator._propagators)\nelse:\n    existing_propagators = [global_propagator]\n\n# \u6dfb\u52a0\u81ea\u5b9a\u4e49\u4f20\u64ad\u5668\nexisting_propagators.append(CustomTracePropagator())\n\n# \u521b\u5efa\u65b0\u7684\u590d\u5408\u4f20\u64ad\u5668\nnew_composite_propagator = CompositePropagator(existing_propagators)\n\n# \u66ff\u6362\u5168\u5c40\u4f20\u64ad\u5668\nfrom aworld.trace.propagator import _GLOBAL_TRACE_PROPAGATOR\n_GLOBAL_TRACE_PROPAGATOR = new_composite_propagator\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/","title":"\u81ea\u5b9a\u4e49Runner\uff08Custom Runner\uff09","text":"<p>AWorld\u6846\u67b6\u63d0\u4f9b\u4e86\u7075\u6d3b\u7684\u8fd0\u884c\u65f6\u57fa\u7840\u8bbe\u65bd\uff0c\u4f7f\u5f97\u5f00\u53d1\u8005\u53ef\u4ee5\u5728\u4e0d\u4fee\u6539\u6846\u67b6\u4ee3\u7801\u7684\u524d\u63d0\u4e0b\uff0c\u5b9e\u73b0\u4efb\u610f\u590d\u6742\u7684\u6267\u884c\u903b\u8f91\u3002Runner\u4f5c\u4e3a\u8fd0\u884c\u65f6\u6838\u5fc3\uff0c\u540c\u6837\u5141\u8bb8\u5f00\u53d1\u8005\u521b\u5efa\u5b8c\u5168\u81ea\u5b9a\u4e49\u7684\u4efb\u52a1\u6267\u884cRunner\u548c\u5f15\u64ce\uff0c\u4ee5\u9002\u5e94\u7279\u5b9a\u7684\u4e1a\u52a1\u9700\u6c42\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/#runner","title":"\u4f55\u65f6\u9700\u8981\u81ea\u5b9a\u4e49Runner","text":"<ul> <li> <p>\u2705 \u9700\u8981\u7279\u6b8a\u7684\u6267\u884c\u6d41\u7a0b\uff08\u5982\u5e76\u884c\u3001\u6761\u4ef6\u5206\u652f\u3001\u5faa\u73af\uff09</p> </li> <li> <p>\u2705 \u9700\u8981\u81ea\u5b9a\u4e49\u7684\u9519\u8bef\u5904\u7406\u548c\u6062\u590d\u673a\u5236</p> </li> <li> <p>\u2705 \u9700\u8981\u96c6\u6210\u7279\u5b9a\u7684\u5916\u90e8\u7cfb\u7edf</p> </li> <li> <p>\u2705 \u9700\u8981\u6027\u80fd\u4f18\u5316\u6216\u8d44\u6e90\u63a7\u5236</p> </li> <li> <p>\u2705 \u9700\u8981\u5b9e\u73b0\u7279\u5b9a\u7684\u8c03\u5ea6\u7b56\u7565</p> </li> <li> <p>\u2705 \u9700\u8981\u5b8c\u5168\u5b9a\u5236\u5316\u7684\u8f93\u51fa\u548c\u76d1\u63a7</p> </li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/#runner_1","title":"\u4f55\u65f6\u4e0d\u9700\u8981\u81ea\u5b9a\u4e49Runner","text":"<ul> <li> <p>\u274c \u6539\u53d8\u540e\u5904\u7406\u903b\u8f91 \u2192 \u4f7f\u7528Handler</p> </li> <li> <p>\u274c \u4fee\u6539\u53c2\u6570 \u2192 \u4f7f\u7528Hooks\u6216Callbacks</p> </li> <li> <p>\u274c \u6539\u53d8\u8f93\u51fa\u683c\u5f0f \u2192 \u4f7f\u7528OutputProcessHook</p> </li> <li> <p>\u274c \u81ea\u5b9a\u4ee5\u8f68\u8ff9 \u2192 \u6269\u5c55TrajectoryStrategy</p> </li> </ul>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/#runner_2","title":"\u521b\u5efa\u81ea\u5b9a\u4e49Runner","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/#agent","title":"Agent\u4efb\u52a1","text":"<p>\u5efa\u8bae\u57fa\u4e8eTaskRunner</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/#taskrunner","title":"\u7ee7\u627fTaskRunner","text":"<pre><code>from aworld.runners.task_runner import TaskRunner\nfrom aworld.core.task import Task, TaskResponse\nfrom aworld.core.context.base import Context\n\nclass MyCustomRunner(TaskRunner):\n    \"\"\"\u81ea\u5b9a\u4e49Runner\u6a21\u677f\"\"\"\n\n    def __init__(self, task: Task, *args, **kwargs):\n        super().__init__(task, *args, **kwargs)\n        # \u6dfb\u52a0\u81ea\u5b9a\u4e49\u521d\u59cb\u5316\n        self.custom_state = {}\n\n    async def pre_run(self):\n        \"\"\"\u51c6\u5907\u5de5\u4f5c\"\"\"\n        await super().pre_run()\n        # \u81ea\u5b9a\u4e49\u521d\u59cb\u5316\u903b\u8f91\n        logger.info(\"Custom runner preparing...\")\n\n    async def do_run(self, context: Context = None) -&gt; TaskResponse:\n        \"\"\"\u6838\u5fc3\u6267\u884c\u903b\u8f91\"\"\"\n        # \u8fd9\u662f\u5fc5\u987b\u5b9e\u73b0\u7684\u62bd\u8c61\u65b9\u6cd5\n        pass\n\n    async def post_run(self):\n        \"\"\"\u6e05\u7406\u5de5\u4f5c\"\"\"\n        await super().post_run()\n        # \u81ea\u5b9a\u4e49\u6e05\u7406\u903b\u8f91\n        logger.info(\"Custom runner cleaning up...\")\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/#_1","title":"\u81ea\u5b9a\u4e49\u6838\u5fc3\u6267\u884c\u6d41\u7a0b","text":"<pre><code>async def do_run(self, context: Context = None) -&gt; TaskResponse:\n    \"\"\"\u5b9e\u73b0\u81ea\u5df1\u7684\u6267\u884c\u903b\u8f91\uff0c\u8fd4\u56deTaskResponse\u5bf9\u8c61\"\"\"\n    observation = self.observation\n\n    try:\n        # 1. \u6267\u884c\u4efb\u52a1\u7684\u6838\u5fc3\u903b\u8f91\n        result = await self._execute_custom_logic(observation)\n\n        # 2. \u751f\u6210\u54cd\u5e94\n        response = TaskResponse(\n            task_id=self.task.id,\n            content=result,\n            status=\"success\"\n        )\n\n        return response\n\n    except Exception as e:\n        logger.error(f\"Execution failed: {e}\")\n        return TaskResponse(\n            task_id=self.task.id,\n            content=str(e),\n            status=\"failed\"\n        )\n\nasync def _execute_custom_logic(self, observation):\n    \"\"\"\u81ea\u5b9a\u4e49\u6267\u884c\u903b\u8f91\"\"\"\n    pass\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/#_2","title":"\u5176\u4ed6\u7c7b\u4efb\u52a1","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/#runner_3","title":"\u7ee7\u627fRunner","text":"<pre><code>class TreeSearchRunner(Runner):\n    \"\"\"\u57fa\u4e8e\u6811\u641c\u7d22\u7684\u81ea\u5b9a\u4e49Runner\"\"\"\n\n    def __init__(self, task: Task, *args, **kwargs):\n        super().__init__(task, *args, **kwargs)\n        self.max_depth = self.conf.get('max_depth', 3)\n        self.max_breadth = self.conf.get('max_breadth', 3)\n        self.search_tree = {}\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/#_3","title":"\u5b9e\u73b0\u6838\u5fc3\u6267\u884c","text":"<pre><code>async def do_run(self, context: Context = None) -&gt; TaskResponse:\n        \"\"\"\u6267\u884c\u6811\u641c\u7d22\"\"\"\n        observation = self.observation\n\n        # \u6267\u884c\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\n        best_result = await self._dfs(observation, depth=0)\n\n        return TaskResponse(\n            task_id=self.task.id,\n            content=best_result,\n            status=\"success\"\n        )\n\n    async def _dfs(self, state, depth):\n        \"\"\"\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\"\"\"\n        if depth &gt;= self.max_depth:\n            return state\n\n        # \u83b7\u53d6\u53ef\u80fd\u7684\u52a8\u4f5c\n        agent = self.swarm.ordered_agents[0]\n        actions = await self._get_possible_actions(agent, state)\n\n        # \u63a2\u7d22\u524dmax_breadth\u4e2a\u52a8\u4f5c\n        best_result = state\n        best_score = self._evaluate(state)\n\n        for action in actions[:self.max_breadth]:\n            # \u6267\u884c\u52a8\u4f5c\n            next_state = await self._execute_action(action, state)\n\n            # \u9012\u5f52\u641c\u7d22\n            result = await self._dfs(next_state, depth + 1)\n\n            # \u8bc4\u4f30\u7ed3\u679c\n            score = self._evaluate(result)\n            if score &gt; best_score:\n                best_score = score\n                best_result = result\n\n        return best_result\n\n    async def _get_possible_actions(self, agent, state):\n        \"\"\"\u83b7\u53d6\u53ef\u80fd\u7684\u52a8\u4f5c\"\"\"\n        obs = Observation(content=str(state))\n        output = await agent.run(obs)\n        return output.get('actions', [])\n\n    async def _execute_action(self, action, state):\n        \"\"\"\u6267\u884c\u52a8\u4f5c\"\"\"\n        tool = self.tools.get(action['tool'])\n        result = await tool.step(action['args'])\n        return result.get('next_state', state)\n\n    def _evaluate(self, state):\n        \"\"\"\u8bc4\u4f30\u72b6\u6001\"\"\"\n        # \u81ea\u5b9a\u4e49\u8bc4\u4f30\u903b\u8f91\n        return len(str(state))\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%87%AA%E5%AE%9A%E4%B9%89Runner%EF%BC%88Custom%20Runner%EF%BC%89/#_4","title":"\u6700\u4f73\u5b9e\u8df5","text":"<p>\u2705 \u5efa\u8bae\uff1a\u6e05\u6670\u7684\u804c\u8d23\u5212\u5206</p> <p>\u6a21\u5757\u5316\u8bbe\u8ba1</p> <pre><code>class WellDesignedRunner(TaskRunner):\n    \"\"\"\u6d41\u7a0b\u548c\u6a21\u5757\u6e05\u6670\"\"\"\n\n    async def do_run(self, context):\n        # \u53ea\u5904\u7406\u4e3b\u8981\u6d41\u7a0b\n        return await self._main_execution(context)\n\n    async def _main_execution(self, context):\n        \"\"\"\u4e3b\u6267\u884c\u903b\u8f91\"\"\"\n        observation = ...\n\n        # 1. \u6267\u884c\u524d\u7f6e\u5904\u7406\n        processed_obs = await self._preprocess(observation)\n\n        # 2. \u6267\u884c\u4e3b\u8981\u903b\u8f91\n        for step in range(self.max_steps):\n            output = await self._execute_step(processed_obs, step)\n            results.append(output)\n\n            if self._should_stop(output):\n                break\n\n            # 3. \u66f4\u65b0\u89c2\u5bdf\n            processed_obs = self._update_observation(processed_obs, output)\n\n        # 4. \u6267\u884c\u540e\u7f6e\u5904\u7406\n        final_result = await self._postprocess(results)\n        ...\n\n    async def _execute_step(self, obs, step):\n        pass\n\n    def _should_stop(self, output):\n        pass\n\n    def _update_observation(self, ob, output):\n        pass\n\n    async def _preprocess(self):\n        pass\n\n    async def _postprocess(self):\n        pass\n</code></pre> <p>\u274c \u4e0d\u63a8\u8350\uff1a\u5355\u4e2a\u65b9\u6cd5\u8fc7\u4e8e\u5e9e\u5927</p> <p>\u8026\u5408\u4e25\u91cd\uff0c\u96be\u4ee5\u5355\u6d4b</p> <pre><code>class PoorlyDesignedRunner(TaskRunner):\n    async def do_run(self, context):\n        # \u6240\u6709\u903b\u8f91\u90fd\u5728\u91cc\u9762\u6267\u884c\n        # ... \u51e0\u767e\u884c\u4ee3\u7801 ...\n        pass\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>class TestableRunner(TaskRunner):\n    \"\"\"\u6613\u4e8e\u6d4b\u8bd5\u7684Runner\"\"\"\n\n    def __init__(self, task: Task, *args, **kwargs):\n        super().__init__(task, *args, **kwargs)\n        self._inject_dependencies()\n\n    def _inject_dependencies(self):\n        \"\"\"\u4f9d\u8d56\u6ce8\u5165\uff0c\u4fbf\u4e8e\u6d4b\u8bd5\u65f6mock\"\"\"\n        self.http_client = getattr(self, 'http_client', HttpClient())\n        self.cache = getattr(self, 'cache', DefaultCache())\n        self.url = getattr(self, 'url', ...)\n\n    async def do_run(self, context: Context = None) -&gt; TaskResponse:\n        \"\"\"\u53ef\u6d4b\u8bd5\u7684\u6267\u884c\"\"\"\n        # \u4f7f\u7528\u6ce8\u5165\u7684\u4f9d\u8d56\n        result = await self.http_client.get(self.url)\n        cached_result = self.cache.get(result)\n\n        return TaskResponse(\n            task_id=self.task.id,\n            content=cached_result,\n            status=\"success\"\n        )\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/","title":"\u8fd0\u884c\u65f6\u6982\u8ff0\uff08Runtime Overview\uff09","text":"<p>AWorld\u7684\u8fd0\u884c\u65f6\u662f\u4e00\u4e2a\u901a\u7528\u7684\uff0c\u5efa\u7acb\u5728\u8ba1\u7b97\u5f15\u64ce\u4e4b\u4e0a\u7684\uff0c\u7075\u6d3b\u7684\u5206\u5e03\u5f0f\u6267\u884c\u6846\u67b6\u3002AWorld\u4e2d\u63d0\u4f9b\u4e86\u9762\u5411\u667a\u80fd\u4f53\u7684\u5b8c\u6574\u5b9e\u73b0\uff0c\u5e76\u5728\u7cfb\u7edf\u4e2d\u63d0\u4f9b\u4e86\uff1a</p> <ol> <li> <p>\u5b8c\u6574\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406 \u2014\u2014 \u6e05\u6670\u7684\u521d\u59cb\u5316\u3001\u6267\u884c\u3001\u6e05\u7406\u9636\u6bb5</p> </li> <li> <p>\u7075\u6d3b\u7684\u6267\u884c\u6a21\u5f0f \u2014\u2014 \u4e8b\u4ef6\u9a71\u52a8\u3001\u8c03\u7528\u9a71\u52a8\u3001\u81ea\u5b9a\u4e49\u6267\u884c\u5b9e\u73b0\u4efb\u610f\u590d\u6742\u7684\u7f16\u6392\u6267\u884c\u903b\u8f91</p> </li> <li> <p>\u7edf\u4e00\u7684\u591a\u6267\u884c\u5f15\u64ce\u652f\u6301 \u2014\u2014 \u652f\u6301\u672c\u5730\u3001Spark\u3001Ray\u7b49\u591a\u79cd\u8ba1\u7b97\u540e\u7aef</p> </li> <li> <p>\u65b9\u4fbf\u7684\u5206\u5e03\u5f0f\u652f\u6301 \u2014\u2014 \u914d\u7f6e\u5316\u652f\u6301\u4efb\u52a1\u7684\u5206\u5e03\u5f0f\u6267\u884c\u548c\u72b6\u6001\u540c\u6b65</p> </li> <li> <p>\u5b8c\u6574\u7684\u53ef\u89c2\u6d4b\u6027 \u2014\u2014 \u8ffd\u8e2a\u3001\u65e5\u5fd7\u3001\u4e8b\u4ef6\u72b6\u6001\u3001\u8f68\u8ff9\u8bb0\u5f55</p> </li> <li> <p>\u5168\u9762\u7684\u4e0a\u4e0b\u6587 \u2014\u2014 Session\uff0c\u4efb\u52a1\uff0cAgent\u7ea7\u522b\u7684\u5b8c\u6574\u72b6\u6001\u7ba1\u7406</p> </li> <li> <p>\u5f3a\u5927\u7684\u6269\u5c55\u673a\u5236 \u2014\u2014 \u9762\u5411\u4e0d\u540c\u7ef4\u5ea6\u7684\u81ea\u5b9a\u4e49\u6269\u5c55Hooks\u3001Callbacks\u3001Handler</p> </li> <li> <p>\u53ef\u9760\u7684\u9519\u8bef\u5904\u7406 \u2014\u2014 \u652f\u6301\u91cd\u8bd5\u3001\u6062\u590d\u7b49\u673a\u5236</p> </li> </ol>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#_1","title":"\u8fd0\u884c\u65f6\u67b6\u6784","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#_2","title":"\u6846\u67b6\u56fe","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    AWorld Runtime Framework                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502               Runner Layer                              \u2502   \u2502\n\u2502  \u2502      (EventRunner / Handler / Callback / Hooks )        \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                     \u2502                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  \u2502    Context  Layer                   \u2502                       \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502                       \u2502\n\u2502  \u2502  \u2502   Session    \u2502  \u2502   Context    \u2502 \u2502                       \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502                       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                     \u2502                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  \u2502   Event Management Layer            \u2502                       \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502                       \u2502\n\u2502  \u2502  \u2502  EventBus    \u2502  \u2502  EventManager\u2502 \u2502                       \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502                       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                     \u2502                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  \u2502    Compute Engine Layer             \u2502                       \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2510  \u2502                       \u2502\n\u2502  \u2502  \u2502  Local   \u2502 \u2502  Spark   \u2502 \u2502 Ray \u2502  \u2502                       \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518  \u2502                       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                     \u2502                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  \u2502      Multi-Agent / Sandbox          \u2502                       \u2502\n\u2502  \u2502  (Tools, Agents, Storage)           \u2502                       \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                                                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#_3","title":"\u5173\u952e\u6d41\u7a0b","text":"<pre><code>\u4efb\u52a1\u521b\u5efa\n   \u2193\n[Runner\u521d\u59cb\u5316]\n   \u251c\u2500 pre_run()        : \u9a8c\u8bc1\u3001\u8d44\u6e90\u52a0\u8f7d\u3001\u4e0a\u4e0b\u6587\u521d\u59cb\u5316\n   \u2502\n[\u8fd0\u884c\u65f6\u6267\u884c]\n   \u251c\u2500 do_run()         : \u6838\u5fc3\u6267\u884c\u903b\u8f91\n   \u2502   \u251c\u2500 Event/Call   : \u9a71\u52a8\u65b9\u5f0f\n   \u2502   \u251c\u2500 Sync/Async   : \u540c\u5f02\u6b65\n   \u2502   \u251c\u2500 Trace        : \u8ffd\u8e2a\n   \u2502   \u2514\u2500 ErrorProcess : \u9519\u8bef\u5904\u7406\n   \u2502   \u2514\u2500 Trajectory   : \u8f68\u8ff9\u5904\u7406\n   \u2502\n[\u8fd0\u884c\u65f6\u6e05\u7406]\n   \u2514\u2500 post_run()       : \u8d44\u6e90\u91ca\u653e\u3001\u72b6\u6001\u4fdd\u5b58\u3001\u901a\u77e5\n   \u2193\n\u4efb\u52a1\u54cd\u5e94\u8fd4\u56de\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#_4","title":"\u6838\u5fc3\u7ec4\u4ef6","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#task-","title":"Task - \u4efb\u52a1\u5b9a\u4e49","text":"<p><code>Task</code>\u662fAWorld\u80fd\u8fd0\u884c\u7684\u4e09\u4e2a\u6838\u5fc3\uff08Agent\uff0c Tool\uff09\u6982\u5ff5\u4e4b\u4e00\u3002</p> <p>Task\u5b9a\u4e49\u4e86\u8981\u6267\u884c\u7684\u4efb\u52a1\u7684\u6240\u6709\u4fe1\u606f\uff0c\u4e00\u822c\u8981\u5305\u62ec\u4efb\u52a1\u7684\u8f93\u5165\u3001\u7528\u5230\u7684Agent\u3001\u9700\u8981\u7684\u5de5\u5177\u3001\u4f9d\u8d56\u7684\u4e0a\u4e0b\u6587\u3001\u6267\u884c\u7684\u6a21\u5f0f\u7b49\u4fe1\u606f\u3002\u8be6\u89c1Task\u7ed3\u6784\u7684\u4e00\u79cd\u5b9e\u73b0\u3002</p> <pre><code>from aworld.core.task import Task\nfrom aworld core.common import StreamingMode\n\n# \u4e00\u4e2a\u590d\u6742\u7684\u4efb\u52a1\u793a\u4f8b\ntask = Task(\n    name=\"complex_task\",\n    input=user_input,\n    swarm=multi_agent,\n    conf={\n        \"max_steps\": 20,\n        \"run_mode\": \"interactive\",\n        \"check_input\": True\n    },\n    hooks={\n        \"start\": [\"init_logging\", \"init_context\"],\n        \"error\": [\"handle_error\", \"send_alert\"]\n    },\n    streaming_mode=StreamingMode.CORE\n)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#runner-","title":"Runner - \u4efb\u52a1\u6267\u884c\u5668","text":"<p><code>Runner</code>\u662f\u4efb\u52a1\u5b9a\u4e49\u6267\u884c\u7684\u5b9e\u4f53\uff0c\u4e5f\u662f\u8fd0\u884c\u65f6\u7684\u6838\u5fc3\uff0c\u4e00\u822c\u6bcf\u4e00\u7c7b\u4efb\u52a1(agent\uff0c\u8bc4\u4f30\uff0c\u6570\u636e\u751f\u6210\uff0c\u8bad\u7ec3)\uff0c\u90fd\u9700\u8981\u4e00\u7c7bRunner\u8d1f\u8d23\u5176\u4efb\u52a1\u7684\u5b8c\u6574\u751f\u547d\u5468\u671f\u548c\u6d41\u7a0b\u7ba1\u7406\u3002</p> <p>\u4ee5Agent\u4efb\u52a1\u4e3a\u4f8b\uff0c\u4e8b\u4ef6\u9a71\u52a8\u7684Runner\u7ba1\u7406\u6574\u4e2a\u4e8b\u4ef6\u7684\u5faa\u73af\u548c\u6536\u53d1\u4e8b\u4ef6\u7684\u72b6\u6001\uff0c\u7f16\u6392\u6574\u4e2a\u6267\u884c\u6d41\u7a0b\uff0c\u540c\u65f6\u57fa\u4e8e\u4e8b\u4ef6\u4e32\u8054\u4e0a\u4e0b\u6e38\u3002</p> <pre><code>async def do_run(self):\n    # \u53d1\u521d\u59cb\u6d88\u606f\n    await self.event_mng.emit_message(msg)\n    # \u6838\u5fc3\u5904\u7406\u6d41\u7a0b\n    await self._do_run()\n    # \u751f\u6210Trajectory\n    await self._save_trajectories()\n    # \u6784\u5efa\u54cd\u5e94\n    resp = self._response()\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#runtimeengine-","title":"RuntimeEngine - \u8ba1\u7b97\u5f15\u64ce","text":"<p><code>RuntimeEngine</code>\u62bd\u8c61\u4e86\u4e0d\u540c\u7684\u8ba1\u7b97\u5f15\u64ce\u540e\u7aef\uff0c\u63d0\u4f9b\u7edf\u4e00\u63a5\u53e3\uff0c\u80fd\u591f\u4fbf\u6377\u7684\u5c06\u4efb\u52a1\u8fd0\u884c\u5728\u6307\u5b9a\u7684\u5f15\u64ce\u4e4b\u4e0a\uff0c\u548c\u5206\u5e03\u5f0f\u6267\u884c\u3002\u5185\u90e8\u9690\u85cf\u4e86\u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u590d\u6742\u6027\uff0c\u8ba9\u5f00\u53d1\u8005\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u4e1a\u52a1\u903b\u8f91\u800c\u4e0d\u662f\u5e95\u5c42\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u7ec6\u8282\u3002</p> <p>\u53ef\u4ee5\u6839\u636e\u9700\u8981\u6269\u5c55engine\u7684\u80fd\u529b\u3002</p> <pre><code>class RuntimeEngine(object):\n\n    ...\n\n    async def execute(self, funcs: List[Callable], *args, **kwargs):\n        pass\n\n    # \u6269\u5c55gatcher\u80fd\u529b\n    async def agather(self):\n        pass\n\n    ...\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#eventbus-","title":"Eventbus - \u4e8b\u4ef6\u603b\u7ebf","text":"<p><code>Eventbus</code>\u662fAWorld\u6846\u67b6\u4e2d\u4e8b\u4ef6\u7684\u6838\u5fc3\u901a\u4fe1\u57fa\u7840\u8bbe\u65bd\uff0c\u8d1f\u8d23\u5728\u7cfb\u7edf\u5404\u7ec4\u4ef6\u95f4\u4f20\u9012\u4e8b\u4ef6\u6d88\u606f\u3002\u5b83\u91c7\u7528\u53d1\u5e03-\u8ba2\u9605\u6a21\u5f0f\uff0c\u652f\u6301\u5f02\u6b65\u6d88\u606f\u4f20\u9012\uff0c\u5b9e\u73b0\u7ec4\u4ef6\u95f4\u7684\u89e3\u8026\u5408\u3002\u57fa\u4e8eEventbus\uff0cAgents\u3001Tools\u548c\u5176\u4ed6\u7cfb\u7edf\u7ec4\u4ef6\u53ef\u4ee5\u677e\u6563\u8026\u5408\u5730\u8fdb\u884c\u901a\u4fe1\uff0c\u63d0\u9ad8\u7cfb\u7edf\u7684\u53ef\u6269\u5c55\u6027\u548c\u5e76\u53d1\u5904\u7406\u80fd\u529b\u3002\u76ee\u524d\u652f\u6301immemory\u548credis\u4e24\u7c7beventbus\u3002</p> <pre><code>async def publish(self, messages: Message, **kwargs):\n    \"\"\"\u53d1\u5e03\u6d88\u606f.\"\"\"\n\nasync def consume(self, message: Message, **kwargs):\n    \"\"\"\u6d88\u8d39\u6d88\u606f.\"\"\"\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#eventmanager-","title":"EventManager - \u4e8b\u4ef6\u7ba1\u7406","text":"<p><code>EventManager</code>\u4f5c\u4e3a\u4e8b\u4ef6\u7ba1\u7406\u4f53\u7cfb\u7684\u6838\u5fc3\uff0c\u8d1f\u8d23\u7ba1\u7406\u4e8b\u4ef6\u7684\u751f\u547d\u5468\u671f\uff0c\u5305\u62ec\u4e8b\u4ef6\u7684\u6ce8\u518c\u3001\u5206\u53d1\u548c\u5b58\u50a8\u3002\u5b83\u7ef4\u62a4\u7740\u4e8b\u4ef6\u5904\u7406\u5668\u7684\u6ce8\u518c\u8868\uff0c\u5e76\u63d0\u4f9b\u63a5\u53e3\u4f9b\u7ec4\u4ef6\u8ba2\u9605\u7279\u5b9a\u7c7b\u578b\u7684\u4e8b\u4ef6\u3002\u6b64\u5916\uff0cEventManager\u8fd8\u8d1f\u8d23\u4e8b\u4ef6\u6d88\u606f\u7684\u6301\u4e45\u5316\u5b58\u50a8\uff0c\u652f\u6301\u4e8b\u4ef6\u7684\u91cd\u653e\u548c\u5ba1\u8ba1\u529f\u80fd\uff0c\u786e\u4fdd\u7cfb\u7edf\u72b6\u6001\u7684\u53ef\u8ffd\u6eaf\u6027\u3002</p> <pre><code>async def emit_message(self, event: Message):\n    # \u5b58\u6d88\u606f\n    await self.store.create_data(Data(block_id=event.context.get_task().id, value=event, id=event.id))\n    # \u53d1\u9001\u6d88\u606f\n    await self.event_bus.publish(event)\n    # \u6d41\u5f0f\n    await self._handle_streaming(event)\n\nasync def messages_by_task_id(self, task_id: str):\n    # \u83b7\u53d6\u4efb\u52a1\u7684\u76f8\u5173\u6d88\u606f\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#handler-","title":"Handler - \u4e8b\u4ef6\u5904\u7406\u5668","text":"<p><code>Handler</code>\u662f\u4e8b\u4ef6\u5904\u7406\u7684\u5177\u4f53\u6267\u884c\u5355\u5143\uff0c\u8d1f\u8d23\u63a5\u6536\u548c\u5904\u7406\u901a\u8fc7Eventbus\u4f20\u9012\u7684\u4e8b\u4ef6\u6d88\u606f\u3002\u4e0d\u540c\u7c7b\u578b\u7684Handler\u4e13\u95e8\u5904\u7406\u7279\u5b9a\u7c7b\u522b\u7684\u4e8b\u4ef6\uff0c\u5982AgentHandler\u5904\u7406\u667a\u80fd\u4f53\u76f8\u5173\u4e8b\u4ef6\uff0cToolHandler\u5904\u7406\u5de5\u5177\u8c03\u7528\u4e8b\u4ef6\u7b49\u3002Handler\u901a\u8fc7\u5b9e\u73b0\u6807\u51c6\u5316\u7684\u5904\u7406\u63a5\u53e3\uff0c\u786e\u4fdd\u5404\u7c7b\u4e8b\u4ef6\u80fd\u5f97\u5230\u6070\u5f53\u7684\u5904\u7406\uff0c\u5e76\u652f\u6301\u94fe\u5f0f\u5904\u7406\u548c\u5f02\u6b65\u6267\u884c\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#callback-","title":"Callback - \u56de\u8c03","text":"<p><code>Callback</code>\u673a\u5236\u7528\u4e8e\u5904\u7406\u5f02\u6b65\u64cd\u4f5c\u5b8c\u6210\u540e\u7684\u7ed3\u679c\uff0c\u7279\u522b\u662f\u5728\u5de5\u5177\u6267\u884c\u6216\u957f\u65f6\u95f4\u8fd0\u884c\u4efb\u52a1\u5b8c\u6210\u540e\u63d0\u4f9b\u53cd\u9988\u3002\u5728AWorld\u4e2d\uff0cCallback\u7cfb\u7edf\u4e0e\u72b6\u6001\u7ba1\u7406\u7d27\u5bc6\u7ed3\u5408\uff0c\u786e\u4fdd\u5f02\u6b65\u64cd\u4f5c\u7684\u6b63\u786e\u5b8c\u6210\u72b6\u6001\u80fd\u88ab\u51c6\u786e\u8ffd\u8e2a\u548c\u5904\u7406\uff0c\u907f\u514d\u56e0\u5f02\u6b65\u64cd\u4f5c\u5bfc\u81f4\u7684\u72b6\u6001\u4e0d\u4e00\u81f4\u95ee\u9898\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#hooks-","title":"Hooks - \u94a9\u5b50\u6ce8\u5165","text":"<p><code>Hooks</code>\u673a\u5236\u4e3aAWorld\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u6269\u5c55\u80fd\u529b\uff0c\u5141\u8bb8\u5f00\u53d1\u8005\u5728\u4efb\u52a1\u6267\u884c\u7684\u5173\u952e\u8282\u70b9\u6ce8\u5165\u81ea\u5b9a\u4e49\u903b\u8f91\u3002\u901a\u8fc7\u5728\u9884\u5b9a\u4e49\u7684\u94a9\u5b50\u70b9\uff08\u5982\u4efb\u52a1\u5f00\u59cb\u524d\u3001LLM\u8c03\u7528\u524d\u540e\u3001\u5de5\u5177\u6267\u884c\u524d\u540e\u7b49\uff09\u6ce8\u518c\u94a9\u5b50\u51fd\u6570\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u5b9e\u73b0\u65e5\u5fd7\u8bb0\u5f55\u3001\u8f93\u5165\u8f93\u51fa\u5904\u7406\u3001\u6743\u9650\u68c0\u67e5\u7b49\u529f\u80fd\uff0c\u800c\u65e0\u9700\u4fee\u6539\u6838\u5fc3\u4ee3\u7801\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#statemanager-","title":"StateManager - \u72b6\u6001\u7ba1\u7406\u5668","text":"<p><code>StateManager</code>\u8d1f\u8d23\u8ddf\u8e2a\u548c\u7ba1\u7406\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u5404\u79cd\u72b6\u6001\u4fe1\u606f\uff0c\u5305\u62ec\u8fd0\u884c\u72b6\u6001\u3001\u6267\u884c\u7ed3\u679c\u548c\u9519\u8bef\u4fe1\u606f\u7b49\u3002\u5b83\u901a\u8fc7<code>RunNode</code>\u548c<code>NodeGroup</code>\u7b49\u6570\u636e\u7ed3\u6784\u7ec4\u7ec7\u548c\u7ef4\u62a4\u6267\u884c\u72b6\u6001\uff0c\u652f\u6301\u5c42\u7ea7\u5316\u7684\u72b6\u6001\u7ba1\u7406\uff0c\u63d0\u4f9b\u7b49\u5f85\u673a\u5236\u4ee5\u534f\u8c03\u4efb\u52a1\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u786e\u4fdd\u590d\u6742\u4efb\u52a1\u6d41\u7a0b\u7684\u6b63\u786e\u6267\u884c\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A6%82%E8%BF%B0%EF%BC%88Runtime%20Overview%EF%BC%89/#agent","title":"\u4e8b\u4ef6\u9a71\u52a8\u7684Agent\u8fd0\u884c\u65f6","text":"<p>AWorld\u9762\u5411Agent\uff0c\u5b9e\u73b0\u4e86\u5b8c\u6574\u7684\u4e8b\u4ef6\u9a71\u52a8\u7684Agent\u8fd0\u884c\u65f6\u6d41\u7a0b\uff1a</p> <p></p> <p>\u6240\u6709\u76f8\u5173\u7684\u884c\u4e3a\uff0c\u6a21\u5757\u548c\u80fd\u529b\uff0c\u90fd\u4f53\u73b0\u5728\u8fd9\u4e2a\u5b8c\u6574\u6d41\u7a0b\u4e2d\uff0c\u5982Context\u7684\u66f4\u65b0\uff0cTrajectory\u6784\u5efa\uff0c\u4eba\u673a\u4ea4\u4e92\u7b49\u3002</p> <p>\u4e3a\u4e86\u65b9\u4fbf\u7684\u6267\u884cRunner\uff0c\u6846\u67b6\u63d0\u4f9b\u4e86<code>Runners</code>\u5de5\u5177\u7c7b\uff0c\u7528\u4ee5\u5de5\u5177\u5316\u6267\u884c\u4e0d\u540c\u5f62\u5f0f\u7684\u4efb\u52a1\u3002</p> <pre><code>from aworld.runners import Runners\n\n# \u8fd0\u884c\u4e00\u4e2aAgent\u6216\u4e00\u7ec4Agent (Swarm)\nRunners.run(...)\n# \u8fd0\u884c\u4e00\u4e2a\u6216\u591a\u4e2aTask\nRunners.run_task(...)\n\n# \u6d41\u5f0f\u54cd\u5e94\u8fd0\u884c\u4e00\u4e2aAgent\u6216\u4e00\u7ec4Agent (Swarm)\nRunners.streaming_run(...)\n# \u6d41\u5f0f\u54cd\u5e94\u8fd0\u884c\u4e00\u4e2aTask\nRunners.streaming_run_task(...)\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E9%92%A9%E5%AD%90%EF%BC%88Hooks%EF%BC%89/","title":"\u94a9\u5b50\uff08Hooks\uff09","text":"<p>Hooks\uff08\u94a9\u5b50\uff09\u662fAWorld\u6846\u67b6\u4e2d\u7684\u8fd0\u884c\u65f6\u751f\u547d\u5468\u671f\u62e6\u622a\u673a\u5236\uff0c\u662f\u5b9e\u73b0\u5f00\u95ed\u539f\u5219\uff08Open-Closed Principle\uff09\u7684\u8bbe\u8ba1\u4f53\u73b0\u3002\u5b83\u5141\u8bb8\u5f00\u53d1\u8005\u5728\u4efb\u52a1\u6267\u884c\u7684\u5173\u952e\u70b9\u63d2\u5165\u81ea\u5b9a\u4e49\u903b\u8f91\uff0c\u800c\u65e0\u9700\u4fee\u6539\u6846\u67b6\u6838\u5fc3\u4ee3\u7801\u3002</p>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E9%92%A9%E5%AD%90%EF%BC%88Hooks%EF%BC%89/#hooks","title":"Hooks\u7684\u6838\u5fc3\u4f5c\u7528","text":"<p>Hooks\u53ef\u4ee5\u5728\u4ee5\u4e0b\u573a\u666f\u53d1\u6325\u4f5c\u7528\uff1a</p> <ol> <li>\u76d1\u63a7\u548c\u65e5\u5fd7 - \u8bb0\u5f55\u5173\u952e\u6267\u884c\u70b9\u7684\u6570\u636e</li> <li>\u6027\u80fd\u5206\u6790 - \u6d4b\u91cf\u5404\u4e2a\u9636\u6bb5\u7684\u8017\u65f6</li> <li>\u6570\u636e\u8f6c\u6362 - \u5728\u4e0d\u540c\u9636\u6bb5\u8f6c\u6362\u6216\u6e05\u6d17\u6570\u636e</li> <li>\u4e1a\u52a1\u903b\u8f91\u6ce8\u5165 - \u63d2\u5165\u7279\u5b9a\u7684\u4e1a\u52a1\u89c4\u5219</li> <li>\u9519\u8bef\u5904\u7406\u548c\u6062\u590d - \u5728\u9519\u8bef\u65f6\u8fdb\u884c\u5e72\u9884</li> <li>\u5ba1\u8ba1\u548c\u8ffd\u8e2a - \u8bb0\u5f55\u6240\u6709\u5173\u952e\u64cd\u4f5c</li> </ol>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E9%92%A9%E5%AD%90%EF%BC%88Hooks%EF%BC%89/#hooks_1","title":"\u4e3a\u4ec0\u4e48\u9700\u8981Hooks\uff1f","text":"<p>\u5728\u6ca1\u6709Hooks\u7684\u67b6\u6784\u4e2d\uff0c\u4e00\u822c\u9700\u8981\u4fee\u6539\u6846\u67b6\u4ee3\u7801\u6765\u6dfb\u52a0\u529f\u80fd\u3002\u4f7f\u7528Hooks\u7684\u65b9\u5f0f\u5141\u8bb8\u901a\u8fc7\u6ce8\u518c\u94a9\u5b50\u51fd\u6570\u6765\u6269\u5c55\u6846\u67b6\u529f\u80fd\uff0c\u65e0\u9700\u4fee\u6539\u4e3b\u6d41\u7a0b\u4ee3\u7801\u3002\u5408\u7406\u4f7f\u7528Hooks\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u4f18\u96c5\u5730\u6269\u5c55\u6846\u67b6\u529f\u80fd\uff0c\u540c\u65f6\u4fdd\u6301\u4ee3\u7801\u7684\u6e05\u6670\u548c\u53ef\u7ef4\u62a4\u6027\u3002</p> <ol> <li>\u975e\u4fb5\u5165\u5f0f\u7684\u6269\u5c55\u673a\u5236 - \u65e0\u9700\u4fee\u6539\u6846\u67b6\u4ee3\u7801</li> <li>\u6e05\u6670\u7684\u751f\u547d\u5468\u671f\u62e6\u622a - \u5728\u5173\u952e\u70b9\u63d2\u5165\u903b\u8f91</li> <li>\u7075\u6d3b\u7684\u7ec4\u5408\u65b9\u5f0f - \u652f\u6301Hook\u94fe\u548c\u6761\u4ef6\u6267\u884c</li> <li>\u5f3a\u5927\u7684\u76d1\u63a7\u80fd\u529b - \u5b8c\u6574\u7684\u4e8b\u4ef6\u8ffd\u8e2a</li> <li>\u53ef\u7ef4\u62a4\u7684\u4ee3\u7801 - \u5173\u6ce8\u70b9\u5206\u79bb</li> </ol>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E9%92%A9%E5%AD%90%EF%BC%88Hooks%EF%BC%89/#hook","title":"Hook\u673a\u5236","text":""},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E9%92%A9%E5%AD%90%EF%BC%88Hooks%EF%BC%89/#hookhook-point","title":"Hook\u70b9\uff08Hook Point\uff09","text":"<p>Hook\u70b9\u662f\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u5173\u952e\u65f6\u523b\u3002\u6846\u67b6\u5185\u90e8\u5df2\u5b9a\u4e49\u7cfb\u5217\u7684Hook\u70b9\uff1a</p> <pre><code>class HookPoint:\n    START = \"start\"                    # \u4efb\u52a1\u5f00\u59cb\n    FINISHED = \"finished\"              # \u4efb\u52a1\u5b8c\u6210\n    ERROR = \"error\"                    # \u4efb\u52a1\u51fa\u9519\n    PRE_LLM_CALL = \"pre_llm_call\"      # LLM\u8c03\u7528\u524d\n    POST_LLM_CALL = \"post_llm_call\"    # LLM\u8c03\u7528\u540e\n    PRE_TOOL_CALL = \"pre_tool_call\"    # Tool\u8c03\u7528\u524d\n    POST_TOOL_CALL = \"post_tool_call\"  # Tool\u8c03\u7528\u540e\n    OUTPUT_PROCESS = \"output_process\"  # \u8f93\u51fa\u5904\u7406\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E9%92%A9%E5%AD%90%EF%BC%88Hooks%EF%BC%89/#hook_1","title":"Hook\uff08\u94a9\u5b50\uff09","text":"<p>Hook\u662f\u4e00\u4e2a\u53ef\u6267\u884c\u7684\u5355\u5143\uff0c\u5728\u7279\u5b9a\u7684Hook\u70b9\u88ab\u8c03\u7528\uff1a</p> <pre><code>class Hook:\n\n    @abc.abstractmethod\n    def point(self) -&gt; str:\n        \"\"\"\u8fd4\u56de\u8fd9\u4e2aHook\u6240\u5c5e\u7684Hook\u70b9\"\"\"\n\n    @abc.abstractmethod\n    async def exec(self, message: Message, context: Context = None) -&gt; Message:\n        \"\"\"\n        \u6267\u884cHook\u903b\u8f91\n\n        Args:\n            message: \u5f53\u524d\u7684\u6d88\u606f\u5bf9\u8c61\n            context: \u6267\u884c\u4e0a\u4e0b\u6587\n\n        Returns:\n            \u4fee\u6539\u540e\u7684\u6d88\u606f\u5bf9\u8c61\uff08\u6216\u4fdd\u6301\u539f\u6837\uff09\n        \"\"\"\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E9%92%A9%E5%AD%90%EF%BC%88Hooks%EF%BC%89/#hookhook-chain","title":"Hook\u94fe\uff08Hook Chain\uff09","text":"<p>\u5728\u540c\u4e00\u4e2aHook\u70b9\uff0c\u53ef\u4ee5\u6ce8\u518c\u591a\u4e2aHook\uff0c\u5b83\u4eec\u4f1a\u6309\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\uff1a</p> <pre><code>\u6d88\u606f\u8f93\u5165\n   \u2193\n[Hook1\u6267\u884c] \u2192 \u53ef\u80fd\u4fee\u6539\u6d88\u606f\n   \u2193\n[Hook2\u6267\u884c] \u2192 \u53ef\u80fd\u8fdb\u4e00\u6b65\u4fee\u6539\u6d88\u606f\n   \u2193\n[Hook3\u6267\u884c] \u2192 \u53ef\u80fd\u518d\u6b21\u4fee\u6539\u6d88\u606f\n   \u2193\n\u6d88\u606f\u8f93\u51fa\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E9%92%A9%E5%AD%90%EF%BC%88Hooks%EF%BC%89/#hook_2","title":"Hook\u6ce8\u518c","text":"<p>Hook\u53ef\u4ee5\u81ea\u52a8\u6ce8\u518c\u5230<code>HookFactory</code>\uff1a</p> <pre><code>@HookFactory.register(name=\"PreLLMCallContextProcessHook\",\n                      desc=\"PreLLMCallContextProcessHook\")\nclass PreLLMCallContextProcessHook(PreLLMCallHook):\n    def name(self):\n        return convert_to_snake(\"PreLLMCallContextProcessHook\")\n\n    async def exec(self, message: Message, context: Context = None) -&gt; Message:\n        # and do something\n        pass\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E9%92%A9%E5%AD%90%EF%BC%88Hooks%EF%BC%89/#hook_3","title":"Hook\u6267\u884c","text":"<pre><code>async def run_hooks(self, message: Message, hook_point: str) -&gt; AsyncGenerator[Message, None]:\n    \"\"\"\u6267\u884c\u6307\u5b9ahook\u70b9\u7684\u6240\u6709Hook\"\"\"\n    if not self.hooks:\n        return\n\n    hooks = self.hooks.get(hook_point, [])\n    for hook in hooks:\n        try:\n            msg = await hook.exec(message)\n            if msg:\n                yield msg\n        except Exception as e:\n            logger.error(f\"Hook execution failed: {e}\")\n</code></pre>"},{"location":"docs_zh/%E6%99%BA%E8%83%BD%E4%BD%93/%E8%BF%90%E8%A1%8C%E6%97%B6/%E9%92%A9%E5%AD%90%EF%BC%88Hooks%EF%BC%89/#_1","title":"\u6700\u4f73\u5b9e\u8df5","text":"<pre><code>from aworld.runners.hook.hooks import StartHook, FinishedHook\n\nclass MonitoringStartHook(StartHook):\n    \"\"\"\u6e05\u6670\u7684\u540d\u79f0\u548c\u6ce8\u91ca\u3002\n\n    \u68c0\u6d4b\u5e76\u8bb0\u5f55\u542f\u52a8\u65f6\u7684\u4f7f\u7528\u3002\n    \"\"\"\n    async def exec(self, message, context):\n        task = context.get_task()\n        print(f\"\u2713 Task started: {task.id}\")\n        print(f\"  Input: {task.input}\")\n        return message\n\nclass MonitoringFinishedHook(FinishedHook):\n    \"\"\"\u5065\u58ee\u7684\u5904\u7406\u3002\n\n\n    \"\"\"\n    async def exec(self, message, context):\n        try:\n            task = context.get_task()\n            print(f\"\u2713 Task finished: {task.id}\")\n            print(f\"  Result: {message.payload}\")\n        except:\n            pass\n        return message\n\n# \u4f7f\u7528\ntask = Task(name=\"test\", input=\"What is AI?\", agent=agent)\nrunner = TaskEventRunner(task)\n\nrunner.hooks = {\n    HookPoint.START: [MonitoringStartHook()],\n    HookPoint.FINISHED: [MonitoringFinishedHook()]\n}\n\nresponse = await runner.run()\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E4%BD%BF%E7%94%A8/","title":"\u4f7f\u7528","text":""},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E4%BD%BF%E7%94%A8/#_1","title":"\u5b89\u88c5","text":"<p>Environment \u6a21\u5757\u5df2\u5305\u542b\u5728 AWorld \u6846\u67b6\u4e2d\uff0c\u65e0\u9700\u5355\u72ec\u5b89\u88c5\u3002</p> <pre><code>pip install aworld\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E4%BD%BF%E7%94%A8/#_2","title":"\u6700\u7b80\u5355\u7684\u793a\u4f8b","text":"<pre><code>import asyncio\nfrom aworld.sandbox import Sandbox\n\n# \u914d\u7f6e MCP \u670d\u52a1\u5668\nmcp_config = {\n    \"mcpServers\": {\n        \"gaia-mcp\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://mcp.example.com/mcp\",\n            \"headers\": {\n                \"Authorization\": \"Bearer YOUR_TOKEN\"\n            }\n        }\n    }\n}\n\nasync def main():\n    # \u521b\u5efa Environment \u5b9e\u4f8b\n    sandbox = Sandbox(mcp_config=mcp_config)\n\n    # \u5217\u51fa\u53ef\u7528\u5de5\u5177\n    tools = await sandbox.list_tools()\n    print(f\"\u53ef\u7528\u5de5\u5177\u6570\u91cf: {len(tools)}\")\n\n    # \u6e05\u7406\u8d44\u6e90\n    await sandbox.cleanup()\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E4%BD%BF%E7%94%A8/#_3","title":"\u590d\u6742\u73af\u5883\u7684\u5728\u7ebf\u8bbf\u95ee","text":"<p>\u4e30\u5bcc\u7684\u73af\u5883\u6784\u5efa\u5f88\u96be\uff0c\u5982\u5305\u51b2\u7a81\uff0cAPI\u9700\u8981\u5bc6\u94a5\uff0c\u5e76\u53d1\u6269\u5c55\u3002\u6211\u4eec\u901a\u8fc7\u4e09\u79cd\u8bbf\u95ee\u6a21\u5f0f\u4f7f\u5176\u53d8\u5f97\u7b80\u5355\uff1a 1.\u4f7f\u7528\u6211\u4eec\u7684\u9ed8\u8ba4\u6258\u7ba1\u8bbe\u7f6e\uff08\u5177\u6709\u4f7f\u7528\u6210\u672c\u7684\u5de5\u5177\u5305\u62ec\u6709\u9650\u7684\u514d\u8d39\uff09\u3002 2.\u643a\u5e26\u60a8\u81ea\u5df1\u7684API\u5bc6\u94a5\uff0c\u4ee5\u4fbf\u8fdb\u884c\u4e0d\u53d7\u9650\u5236\u7684\u8bbf\u95ee\uff08\u5373\u5c06\u63a8\u51fa\uff09\u3002 3.\u63d0\u53d6\u6211\u4eec\u7684Docker\u955c\u50cf\uff0c\u5e76\u5728\u60a8\u81ea\u5df1\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u8fd0\u884c\u6240\u6709\u5185\u5bb9\uff08\u5373\u5c06\u63a8\u51fa\uff09\u3002</p> <pre><code>import os\nimport asyncio\nfrom aworld.sandbox import Sandbox\n\nINVITATION_CODE = os.environ.get(\"INVITATION_CODE\", \"\")\n\nmcp_config = {\n    \"mcpServers\": {\n        \"gaia_server\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://playground.aworldagents.com/environments/mcp\",\n            \"timeout\": 600,\n            \"sse_read_timeout\": 600,\n            \"headers\": {\n                \"ENV_CODE\": \"gaia\",\n                \"Authorization\": f\"Bearer {INVITATION_CODE}\",\n            }\n        }\n    }\n}\n\nasync def _list_tools():\n    sand_box = Sandbox(mcp_config=mcp_config, mcp_servers=[\"gaia_server\"])\n    return await sand_box.mcpservers.list_tools()\n\nif __name__ == \"__main__\":\n    tools = asyncio.run(_list_tools())\n    print(tools)\n</code></pre> <p></p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E6%80%BB%E8%A7%88%EF%BC%88Overview%EF%BC%89/","title":"\u603b\u89c8\uff08Overview\uff09","text":""},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E6%80%BB%E8%A7%88%EF%BC%88Overview%EF%BC%89/#_1","title":"\u7b80\u4ecb","text":"<p>Environment\uff08\u73af\u5883\uff09\u662f AWorld \u6846\u67b6\u4e2d\u7684\u6838\u5fc3\u6982\u5ff5\uff0c\u4e3a\u667a\u80fd\u4f53\u63d0\u4f9b\u5b89\u5168\u3001\u9694\u79bb\u7684\u5de5\u5177\u6267\u884c\u73af\u5883\u3002Environment \u7edf\u4e00\u7ba1\u7406 MCP\uff08Model Context Protocol\uff09\u670d\u52a1\u5668\uff0c\u4f7f\u667a\u80fd\u4f53\u80fd\u591f\u65e0\u7f1d\u4f7f\u7528\u5404\u79cd\u5916\u90e8\u5de5\u5177\u548c\u670d\u52a1\u3002</p> <p>\u5728 AWorld \u6846\u67b6\u4e2d\uff0c<code>Sandbox</code> \u662f Environment \u7684\u4e00\u4e2a\u5ba2\u6237\u7aef\u5b9e\u73b0\uff0c\u63d0\u4f9b\u4e86 Environment \u63a5\u53e3\u7684\u5177\u4f53\u5b9e\u73b0\u3002\u901a\u8fc7 <code>Sandbox</code> \u7c7b\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u548c\u7ba1\u7406 Environment \u5b9e\u4f8b\u3002</p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E6%80%BB%E8%A7%88%EF%BC%88Overview%EF%BC%89/#_2","title":"\u4e3b\u8981\u7279\u6027","text":"<ul> <li>\u2705 MCP \u670d\u52a1\u5668\u7ba1\u7406\uff1a\u7edf\u4e00\u7ba1\u7406\u591a\u4e2a MCP \u670d\u52a1\u5668\u8fde\u63a5</li> <li>\u2705 \u5de5\u5177\u81ea\u52a8\u53d1\u73b0\uff1a\u81ea\u52a8\u53d1\u73b0\u5e76\u6ce8\u518c MCP \u5de5\u5177</li> <li>\u2705 \u8fde\u63a5\u6c60\u7ba1\u7406\uff1a\u667a\u80fd\u7f13\u5b58\u670d\u52a1\u5668\u8fde\u63a5\uff0c\u63d0\u5347\u6027\u80fd</li> <li>\u2705 \u6ce8\u518c\u4e2d\u5fc3\u96c6\u6210\uff1a\u652f\u6301\u672c\u5730\u548c\u8fdc\u7a0b\u5de5\u5177\u6ce8\u518c\u4e2d\u5fc3</li> <li>\u2705 \u6d41\u5f0f\u54cd\u5e94\uff1a\u652f\u6301\u5de5\u5177\u7ed3\u679c\u7684\u6d41\u5f0f\u8fd4\u56de\uff0c\u5305\u62ec\u8fdb\u5ea6\u56de\u8c03</li> <li>\u2705 \u73af\u5883\u4e0a\u4e0b\u6587\u80fd\u529b\uff1a\u81ea\u52a8\u6ce8\u5165\u7528\u6237\u5b9a\u4e49\u7684\u4e0a\u4e0b\u6587\u53c2\u6570\u5230\u5de5\u5177\u8c03\u7528</li> <li>\u2705 Agent \u8fd0\u884c\u652f\u6301\uff1a\u652f\u6301 Agent \u5728 Environment \u73af\u5883\u4e2d\u8fd0\u884c</li> </ul>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/","title":"\u73af\u5883\u5ba2\u6237\u7aef","text":"<p>\u672c\u6587\u6863\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528 Environment \u5ba2\u6237\u7aef\uff08Sandbox\uff09\u6765\u521b\u5efa\u548c\u7ba1\u7406 Environment \u5b9e\u4f8b\uff0c\u4ee5\u53ca\u8fdb\u884c\u57fa\u672c\u7684\u5de5\u5177\u64cd\u4f5c\u3002\u5982\u679c\u4f60\u8fd8\u4e0d\u4e86\u89e3 Environment \u7684\u57fa\u672c\u6982\u5ff5\uff0c\u5efa\u8bae\u5148\u9605\u8bfb\u300a\u603b\u89c8\u300b\u6587\u6863\u3002</p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#_1","title":"\u6838\u5fc3\u6982\u5ff5","text":""},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#environment","title":"Environment\uff08\u73af\u5883\uff09","text":"<p>Environment \u662f AWorld \u6846\u67b6\u4e2d\u7684\u6838\u5fc3\u6982\u5ff5\uff0c\u4ee3\u8868\u4e00\u4e2a\u5de5\u5177\u6267\u884c\u73af\u5883\u3002Environment \u63d0\u4f9b\u5de5\u5177\u6267\u884c\u7684\u57fa\u7840\u8bbe\u65bd\uff0c\u6bcf\u4e2a Environment \u5b9e\u4f8b\u7ba1\u7406\u4e00\u7ec4 MCP \u670d\u52a1\u5668\uff0c\u4e3a\u667a\u80fd\u4f53\u63d0\u4f9b\u7edf\u4e00\u7684\u5de5\u5177\u8bbf\u95ee\u63a5\u53e3\u3002</p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#sandboxenvironment","title":"Sandbox\uff08Environment \u7684\u5ba2\u6237\u7aef\u5b9e\u73b0\uff09","text":"<p><code>Sandbox</code> \u662f Environment \u7684\u4e00\u4e2a\u5ba2\u6237\u7aef\u5b9e\u73b0\u7c7b\u3002\u5728\u4ee3\u7801\u4e2d\uff0c\u4f60\u901a\u8fc7 <code>Sandbox</code> \u7c7b\u6765\u521b\u5efa\u548c\u4f7f\u7528 Environment \u5b9e\u4f8b\uff1a</p> <pre><code>from aworld.sandbox import Sandbox\n\n# Sandbox \u662f Environment \u7684\u5ba2\u6237\u7aef\u5b9e\u73b0\nsandbox = Sandbox(mcp_config={...})\n</code></pre> <p>\u867d\u7136\u4ee3\u7801\u4e2d\u4f7f\u7528\u7684\u662f <code>Sandbox</code> \u7c7b\uff0c\u4f46\u4ece\u6982\u5ff5\u4e0a\u8bb2\uff0c\u4f60\u521b\u5efa\u7684\u662f\u4e00\u4e2a Environment \u5b9e\u4f8b\u3002<code>Sandbox</code> \u63d0\u4f9b\u4e86 Environment \u63a5\u53e3\u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u5305\u62ec\uff1a</p> <ul> <li>MCP \u670d\u52a1\u5668\u8fde\u63a5\u7ba1\u7406</li> <li>\u5de5\u5177\u53d1\u73b0\u548c\u8c03\u7528</li> <li>\u8d44\u6e90\u6e05\u7406\u7b49\u529f\u80fd</li> </ul>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#mcp","title":"MCP \u670d\u52a1\u5668","text":"<p>MCP\uff08Model Context Protocol\uff09\u670d\u52a1\u5668\u63d0\u4f9b\u5de5\u5177\u670d\u52a1\u3002\u652f\u6301\u4ee5\u4e0b\u7c7b\u578b\uff1a</p> <ul> <li>stdio\uff1a\u6807\u51c6\u8f93\u5165\u8f93\u51fa\uff08\u672c\u5730\u8fdb\u7a0b\uff09</li> <li>sse\uff1aServer-Sent Events\uff08HTTP SSE\uff09</li> <li>streamable-http\uff1a\u6d41\u5f0f HTTP\uff08\u652f\u6301\u8fdb\u5ea6\u56de\u8c03\uff09</li> <li>api\uff1aRESTful API\uff08\u7b80\u5355 HTTP \u8c03\u7528\uff09</li> <li>function_tool\uff1aPython \u51fd\u6570\u5de5\u5177</li> </ul>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#_2","title":"\u5de5\u5177","text":"<p>\u5de5\u5177\u662f MCP \u670d\u52a1\u5668\u63d0\u4f9b\u7684\u53ef\u6267\u884c\u529f\u80fd\u3002\u5de5\u5177\u547d\u540d\u683c\u5f0f\uff1a<code>server_name__tool_name</code></p> <p>\u4f8b\u5982\uff1a<code>gaia-mcp__doc_txt__list_supported_formats_for_txt</code></p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#_3","title":"\u57fa\u672c\u64cd\u4f5c","text":""},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#environment_1","title":"\u521b\u5efa Environment","text":"<p>\u5728 AWorld \u4e2d\uff0c\u4f60\u901a\u8fc7 <code>Sandbox</code> \u7c7b\uff08Environment \u7684\u5ba2\u6237\u7aef\u5b9e\u73b0\uff09\u6765\u521b\u5efa Environment \u5b9e\u4f8b\u3002\u63a8\u8350\u4f7f\u7528 Builder \u6a21\u5f0f\uff1a</p> <pre><code>from aworld.sandbox import Sandbox\n\n# \u65b9\u5f0f 1\uff1a\u4f7f\u7528 mcp_config\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config({\n    \"mcpServers\": {\n        \"server1\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://...\",\n            \"headers\": {...}\n        }\n    }\n}).build()\n\n# \u65b9\u5f0f 2\uff1a\u6307\u5b9a\u670d\u52a1\u5668\u540d\u79f0\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_servers([\"server1\", \"server2\"]).mcp_config({\n    \"mcpServers\": {\n        \"server1\": {...},\n        \"server2\": {...}\n    }\n}).build()\n\n# \u65b9\u5f0f 3\uff1a\u4f7f\u7528\u5de5\u5177\u540d\u79f0\uff08\u4ece\u6ce8\u518c\u4e2d\u5fc3\u67e5\u627e\uff0cBuilder \u6a21\u5f0f\uff09\nsandbox = Sandbox().tools([\"tool1\", \"tool2\"]).registry_url(\"https://registry.example.com\").build()\n\n# \u65b9\u5f0f 4\uff1a\u6307\u5b9a sandbox_id\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().sandbox_id(\"my-sandbox-id\").mcp_config({\n    \"mcpServers\": {\n        \"server_name\": {...}\n    }\n}).build()\n\n# \u65b9\u5f0f 5\uff1a\u94fe\u5f0f\u914d\u7f6e\u591a\u4e2a\u9009\u9879\uff08Builder \u6a21\u5f0f\uff09\nsandbox = (Sandbox()\n    .mcp_config({...})\n    .streaming(True)  # \u542f\u7528\u6d41\u5f0f\u54cd\u5e94\uff0c\u8be6\u89c1\u300a\u9ad8\u7ea7\u80fd\u529b\u300b\n    .env_content({\"user_id\": \"user123\"})  # \u914d\u7f6e\u73af\u5883\u4e0a\u4e0b\u6587\uff0c\u8be6\u89c1\u300a\u9ad8\u7ea7\u80fd\u529b\u300b\n    .agents({\"my_agent\": \"/path/to/agents\"})  # \u914d\u7f6e Agent\uff0c\u8be6\u89c1\u300a\u9ad8\u7ea7\u80fd\u529b\u300b\n    .build()\n)\n\n# \u6ce8\u610f\uff1a\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6784\u9020\u51fd\u6570\uff08\u5411\u540e\u517c\u5bb9\uff09\nsandbox = Sandbox(mcp_config={...})\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#_4","title":"\u5217\u51fa\u5de5\u5177","text":"<pre><code># \u83b7\u53d6\u6240\u6709\u53ef\u7528\u5de5\u5177\ntools = await sandbox.list_tools()\n\n# \u5de5\u5177\u683c\u5f0f\u793a\u4f8b\n[\n    {\n        \"type\": \"function\",\n        \"function\": {\n            \"name\": \"server_name__tool_name\",\n            \"description\": \"\u5de5\u5177\u63cf\u8ff0\",\n            \"parameters\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"param1\": {\n                        \"type\": \"string\",\n                        \"description\": \"\u53c2\u6570\u63cf\u8ff0\"\n                    }\n                },\n                \"required\": [\"param1\"]\n            }\n        }\n    }\n]\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#_5","title":"\u8c03\u7528\u5de5\u5177","text":"<pre><code># \u5355\u4e2a\u5de5\u5177\u8c03\u7528\nresult = await sandbox.call_tool(action_list=[{\n    \"tool_name\": \"server_name\",\n    \"action_name\": \"tool_name\",\n    \"params\": {\n        \"param1\": \"value1\"\n    }\n}])\n\n# \u591a\u4e2a\u5de5\u5177\u8c03\u7528\uff08\u5e76\u884c\uff09\nresults = await sandbox.call_tool(action_list=[\n    {\n        \"tool_name\": \"server1\",\n        \"action_name\": \"tool1\",\n        \"params\": {}\n    },\n    {\n        \"tool_name\": \"server2\",\n        \"action_name\": \"tool2\",\n        \"params\": {}\n    }\n])\n\n# \u7ed3\u679c\u683c\u5f0f\n[\n    ActionResult(\n        tool_name=\"server_name\",\n        action_name=\"tool_name\",\n        content=\"\u6267\u884c\u7ed3\u679c\",\n        success=True,\n        metadata={...}\n    )\n]\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#environment_2","title":"\u83b7\u53d6 Environment \u4fe1\u606f","text":"<pre><code>info = sandbox.get_info()\n# {\n#     \"sandbox_id\": \"...\",\n#     \"status\": \"Running\",\n#     \"metadata\": {...}\n# }\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#_6","title":"\u6e05\u7406\u8d44\u6e90","text":"<pre><code># \u624b\u52a8\u6e05\u7406\nawait sandbox.cleanup()\n\n# \u81ea\u52a8\u6e05\u7406\uff08\u5bf9\u8c61\u9500\u6bc1\u65f6\uff09\n# Environment \u4f1a\u5728 __del__ \u65f6\u81ea\u52a8\u6e05\u7406\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#_7","title":"\u5e38\u89c1\u95ee\u9898","text":""},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#q1-environment","title":"Q1: \u5982\u4f55\u67e5\u770b Environment \u652f\u6301\u7684\u6240\u6709\u5de5\u5177\uff1f","text":"<pre><code>tools = await sandbox.list_tools()\nfor tool in tools:\n    print(tool[\"function\"][\"name\"])\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#q2","title":"Q2: \u5de5\u5177\u8c03\u7528\u5931\u8d25\u600e\u4e48\u529e\uff1f","text":"<pre><code># \u68c0\u67e5\u5de5\u5177\u8c03\u7528\u7ed3\u679c\nresult = await sandbox.call_tool(action_list=[{\n    \"tool_name\": \"server_name\",\n    \"action_name\": \"tool_name\",\n    \"params\": {}\n}])\nfor r in result:\n    if not r.success:\n        print(f\"\u5de5\u5177 {r.tool_name} \u8c03\u7528\u5931\u8d25: {r.content}\")\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#q3","title":"Q3: \u5982\u4f55\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\uff1f","text":"<pre><code># Builder \u6a21\u5f0f\nsandbox = Sandbox().timeout(10000).mcp_config({\n    \"mcpServers\": {\n        \"server_name\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://...\",\n            \"timeout\": 6000,  # 6 \u79d2\n            \"sse_read_timeout\": 6000\n        }\n    }\n}).build()\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#q4","title":"Q4: \u5982\u4f55\u7981\u7528\u67d0\u4e2a\u670d\u52a1\u5668\uff1f","text":"<pre><code>mcp_config = {\n    \"mcpServers\": {\n        \"server_name\": {\n            \"disabled\": True,  # \u7981\u7528\u6b64\u670d\u52a1\u5668\n            ...\n        }\n    }\n}\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#q5","title":"Q5: \u5982\u4f55\u4ece\u6ce8\u518c\u4e2d\u5fc3\u67e5\u627e\u5de5\u5177\uff1f","text":"<pre><code># \u65b9\u5f0f 1\uff1a\u6309\u5de5\u5177\u540d\u67e5\u627e\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().tools([\"tool1\", \"tool2\"]).registry_url(\"https://registry.example.com\").build()\n\n# \u65b9\u5f0f 2\uff1a\u6309\u670d\u52a1\u5668\u540d\u67e5\u627e\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_servers([\"server1\", \"server2\"]).registry_url(\"https://registry.example.com\").build()\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#q6","title":"Q6: \u5982\u4f55\u4f7f\u7528\u73af\u5883\u4e0a\u4e0b\u6587\u529f\u80fd\uff1f","text":"<p>\u8be6\u89c1\u300a\u9ad8\u7ea7\u80fd\u529b\u300b\u6587\u6863\u4e2d\u7684\"\u73af\u5883\u4e0a\u4e0b\u6587\u80fd\u529b\"\u7ae0\u8282\u3002</p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#q7-agent-environment","title":"Q7: \u5982\u4f55\u914d\u7f6e Agent \u5728 Environment \u4e2d\u8fd0\u884c\uff1f","text":"<p>\u8be6\u89c1\u300a\u9ad8\u7ea7\u80fd\u529b\u300b\u6587\u6863\u4e2d\u7684\"Agent \u8fd0\u884c\u652f\u6301\"\u7ae0\u8282\u3002</p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#_8","title":"\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#1-environment","title":"1. \u91cd\u7528 Environment \u5b9e\u4f8b","text":"<pre><code># \u2705 \u63a8\u8350\uff1a\u521b\u5efa\u4e00\u6b21\uff0c\u591a\u6b21\u4f7f\u7528\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config(mcp_config).build()\ntools = await sandbox.list_tools()\nresult = await sandbox.call_tool(action_list=[{\n    \"tool_name\": \"server_name\",\n    \"action_name\": \"tool_name\",\n    \"params\": {}\n}])\nanother_result = await sandbox.call_tool(action_list=[{\n    \"tool_name\": \"server_name\",\n    \"action_name\": \"another_tool\",\n    \"params\": {}\n}])\nawait sandbox.cleanup()\n\n# \u274c \u4e0d\u63a8\u8350\uff1a\u9891\u7e41\u521b\u5efa\u548c\u9500\u6bc1\nfor i in range(10):\n    # \u6bcf\u6b21\u5faa\u73af\u90fd\u521b\u5efa\u65b0\u7684 Environment \u5b9e\u4f8b\uff0c\u6548\u7387\u4f4e\n    sandbox = Sandbox().mcp_config(mcp_config).build()\n    result = await sandbox.call_tool(action_list=[{\n        \"tool_name\": \"server_name\",\n        \"action_name\": \"tool_name\",\n        \"params\": {}\n    }])\n    await sandbox.cleanup()\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#2","title":"2. \u4f7f\u7528\u8fde\u63a5\u6c60","text":"<p>Environment \u81ea\u52a8\u7ba1\u7406\u670d\u52a1\u5668\u8fde\u63a5\u6c60\uff0c\u65e0\u9700\u624b\u52a8\u7ba1\u7406\u8fde\u63a5\u3002</p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#3","title":"3. \u5408\u7406\u8bbe\u7f6e\u8d85\u65f6","text":"<pre><code># \u6839\u636e\u5de5\u5177\u6267\u884c\u65f6\u95f4\u8bbe\u7f6e\u5408\u9002\u7684\u8d85\u65f6\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().timeout(30000).mcp_config({\n    \"mcpServers\": {\n        \"server_name\": {\n            \"type\": \"streamable-http\",\n            \"url\": \"https://...\",\n            \"timeout\": 60000,  # 60 \u79d2\n            \"sse_read_timeout\": 120000  # 120 \u79d2\n        }\n    }\n}).build()\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#4","title":"4. \u4f7f\u7528\u6ce8\u518c\u4e2d\u5fc3\u7ba1\u7406\u5de5\u5177","text":"<pre><code># \u63a8\u8350\u4f7f\u7528\u6ce8\u518c\u4e2d\u5fc3\u7edf\u4e00\u7ba1\u7406\u5de5\u5177\u914d\u7f6e\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().tools([\"tool1\", \"tool2\"]).registry_url(\"https://registry.example.com\").build()\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#5","title":"5. \u9519\u8bef\u5904\u7406","text":"<pre><code>try:\n    result = await sandbox.call_tool(action_list=[{\n        \"tool_name\": \"server_name\",\n        \"action_name\": \"tool_name\",\n        \"params\": {}\n    }])\n    for r in result:\n        if not r.success:\n            logger.error(f\"\u5de5\u5177\u8c03\u7528\u5931\u8d25: {r.content}\")\nexcept Exception as e:\n    logger.error(f\"Environment \u64cd\u4f5c\u5931\u8d25: {e}\")\nfinally:\n    await sandbox.cleanup()\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#_9","title":"\u793a\u4f8b\u4ee3\u7801","text":""},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#gaia","title":"\u5b8c\u6574\u793a\u4f8b\uff1a\u4f7f\u7528 GAIA \u73af\u5883","text":"<pre><code>import asyncio\nimport json\nfrom aworld.sandbox import Sandbox\n\n# GAIA MCP \u914d\u7f6e\nURL = \"https://mcp.aworldagents.com/vpc-pre/mcp\"\nTOKEN = \"YOUR_TOKEN\"\nIMAGE_VERSION = \"gaia-20251125152015\"\n\ngaia_mcp_config = {\n    \"mcpServers\": {\n        \"gaia-mcp\": {\n            \"type\": \"streamable-http\",\n            \"url\": URL,\n            \"headers\": {\n                \"env_name\": \"gaia\",\n                \"Authorization\": f\"Bearer {TOKEN}\",\n                \"MCP_SERVERS\": (\n                    \"googlesearch,readweb-server,media-audio,media-image,\"\n                    \"media-video,intell-code,intell-guard,doc-csv,doc-xlsx,\"\n                    \"doc-docx,doc-pptx,doc-txt,doc-pdf,download,parxiv-server,\"\n                    \"terminal-server,wayback-server,wiki-server\"\n                ),\n                \"IMAGE_VERSION\": IMAGE_VERSION,\n            },\n            \"timeout\": 6000,\n            \"sse_read_timeout\": 6000,\n            \"client_session_timeout_seconds\": 6000,\n        }\n    }\n}\n\nasync def main():\n    # \u901a\u8fc7 Sandbox\uff08Environment \u7684\u5ba2\u6237\u7aef\uff09\u521b\u5efa Environment \u5b9e\u4f8b\uff08Builder \u6a21\u5f0f\uff09\n    sandbox = Sandbox().mcp_config(gaia_mcp_config).build()\n\n    # \u5217\u51fa\u5de5\u5177\n    tools = await sandbox.list_tools()\n    print(f\"\u53ef\u7528\u5de5\u5177\u6570\u91cf: {len(tools)}\")\n\n    # \u8c03\u7528\u5de5\u5177\u793a\u4f8b\n    result = await sandbox.call_tool(action_list=[{\n        \"tool_name\": \"gaia-mcp\",\n        \"action_name\": \"doc_txt__list_supported_formats_for_txt\",\n        \"params\": {}\n    }])\n\n    print(f\"\u5de5\u5177\u6267\u884c\u7ed3\u679c: {json.dumps(result, ensure_ascii=False, indent=2)}\")\n\n    # \u6e05\u7406\n    await sandbox.cleanup()\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E7%8E%AF%E5%A2%83%E5%AE%A2%E6%88%B7%E7%AB%AF/#agent","title":"\u793a\u4f8b\uff1a\u4e0e Agent \u96c6\u6210","text":"<pre><code>from aworld.agents.llm_agent import Agent\nfrom aworld.runner import Runners\n\n# \u901a\u8fc7 Sandbox\uff08Environment \u7684\u5ba2\u6237\u7aef\uff09\u521b\u5efa Environment \u5b9e\u4f8b\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config({...}).build()\n\n# \u521b\u5efa Agent\uff08\u81ea\u52a8\u4f7f\u7528 Environment\uff09\nagent = Agent(\n    name=\"MyAgent\",\n    system_prompt=\"\u4f60\u662f\u4e00\u4e2a\u52a9\u624b\",\n    sandbox=sandbox  # \u4f20\u5165 Environment \u5b9e\u4f8b\n)\n\n# \u8fd0\u884c Agent\uff08\u81ea\u52a8\u4f7f\u7528 Environment \u4e2d\u7684\u5de5\u5177\uff09\nresult = await Runners.run(\n    input=\"\u4f7f\u7528\u5de5\u5177\u6267\u884c\u4efb\u52a1\",\n    agent=agent\n)\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/","title":"\u9ad8\u7ea7\u80fd\u529b","text":""},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_1","title":"\u7b80\u4ecb","text":"<p>\u672c\u6587\u6863\u4ecb\u7ecd Environment \u7684\u9ad8\u7ea7\u80fd\u529b\uff0c\u5305\u62ec\u6ce8\u518c\u4e2d\u5fc3\u96c6\u6210\u3001\u6d41\u5f0f\u54cd\u5e94\u3001\u73af\u5883\u4e0a\u4e0b\u6587\u3001Agent \u8fd0\u884c\u652f\u6301\u3001\u5de5\u5177\u7ba1\u7406\u7b49\u529f\u80fd\u3002\u8fd9\u4e9b\u529f\u80fd\u53ef\u4ee5\u5e2e\u52a9\u4f60\u66f4\u597d\u5730\u7ba1\u7406\u548c\u6269\u5c55 Environment \u7684\u80fd\u529b\u3002</p> <p>\u5982\u679c\u4f60\u521a\u5f00\u59cb\u4f7f\u7528 Environment\uff0c\u5efa\u8bae\u5148\u9605\u8bfb\u300a\u73af\u5883\u5ba2\u6237\u7aef\u300b\u6587\u6863\u4e86\u89e3\u57fa\u7840\u4f7f\u7528\u65b9\u6cd5\u3002</p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_2","title":"\u6ce8\u518c\u4e2d\u5fc3\u96c6\u6210","text":""},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_3","title":"\u672c\u5730\u6ce8\u518c\u4e2d\u5fc3","text":"<pre><code># \u4f7f\u7528\u672c\u5730 JSON \u6587\u4ef6\u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().tools([\"tool1\", \"tool2\"]).registry_url(\"~/workspace/registry.json\").build()\n\n# \u6ce8\u518c\u4e2d\u5fc3\u6587\u4ef6\u683c\u5f0f\n{\n    \"tool:server_name\": {\n        \"entity_type\": \"tool\",\n        \"name\": \"server_name\",\n        \"description\": \"\u670d\u52a1\u5668\u63cf\u8ff0\",\n        \"tools\": [\n            {\n                \"name\": \"tool_name\",\n                \"description\": \"\u5de5\u5177\u63cf\u8ff0\"\n            }\n        ],\n        \"data\": { \n            \"type\": \"streamable-http\",\n            \"url\": \"https://...\",\n            \"headers\": {...}\n        }\n    }\n}\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_4","title":"\u8fdc\u7a0b\u6ce8\u518c\u4e2d\u5fc3","text":"<pre><code># \u4f7f\u7528\u8fdc\u7a0b\u6ce8\u518c\u4e2d\u5fc3\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().tools([\"tool1\", \"tool2\"]).registry_url(\"https://registry.example.com\").build()\n\n# \u6ce8\u518c\u4e2d\u5fc3 API\n# POST /api/v1/registry/search\n{\n    \"entity_type\": \"tool\",\n    \"status\": \"active\",\n    \"tools\": [\"tool1\", \"tool2\"]  # \u53ef\u9009\n}\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_5","title":"\u6d41\u5f0f\u54cd\u5e94","text":"<p>\u6d41\u5f0f\u54cd\u5e94\u529f\u80fd\u652f\u6301\u5de5\u5177\u7ed3\u679c\u7684\u5b9e\u65f6\u8fd4\u56de\uff0c\u5305\u62ec\u8fdb\u5ea6\u56de\u8c03\u3002\u8fd9\u5bf9\u4e8e\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u5de5\u5177\u975e\u5e38\u6709\u7528\u3002</p> <pre><code># \u542f\u7528\u6d41\u5f0f\u54cd\u5e94\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config({...}).streaming(True).build()\n\n# \u5de5\u5177\u8c03\u7528\u65f6\uff0c\u8fdb\u5ea6\u6d88\u606f\u4f1a\u81ea\u52a8\u53d1\u9001\u5230\u4e8b\u4ef6\u603b\u7ebf\nresult = await sandbox.call_tool(action_list=[{\n    \"tool_name\": \"server_name\",\n    \"action_name\": \"long_running_tool\",\n    \"params\": {}\n}])\n\n# \u8fdb\u5ea6\u6d88\u606f\u683c\u5f0f\n# Message(\n#     category=Constants.OUTPUT,\n#     payload=Output(data=\"\u8fdb\u5ea6\u4fe1\u606f\"),\n#     sender=\"server_name__tool_name\"\n# )\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_6","title":"\u73af\u5883\u4e0a\u4e0b\u6587\u80fd\u529b","text":"<p>\u73af\u5883\u4e0a\u4e0b\u6587\u529f\u80fd\u5141\u8bb8\u4f60\u5b9a\u4e49\u4e0a\u4e0b\u6587\u53c2\u6570\uff0c\u8fd9\u4e9b\u53c2\u6570\u4f1a\u81ea\u52a8\u6ce8\u5165\u5230\u5de5\u5177\u8c03\u7528\u4e2d\u3002\u8fd9\u5bf9\u4e8e\u4f20\u9012\u7528\u6237\u4fe1\u606f\u3001\u73af\u5883\u914d\u7f6e\u7b49\u975e\u5e38\u6709\u7528\u3002</p> <pre><code># \u8bbe\u7f6e\u73af\u5883\u4e0a\u4e0b\u6587\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config({...}).env_content({\n    \"user_id\": \"user123\",\n    \"workspace\": \"/path/to/workspace\",\n    \"custom_config\": {\"key\": \"value\"}\n}).env_content_name(\"env_content\").build()  # env_content_name \u53ef\u9009\uff0c\u9ed8\u8ba4\u4e3a \"env_content\"\n\n# \u5de5\u5177\u8c03\u7528\u65f6\uff0cenv_content \u53c2\u6570\u4f1a\u81ea\u52a8\u6ce8\u5165\n# \u540c\u65f6\u8fd8\u4f1a\u81ea\u52a8\u6dfb\u52a0 task_id\u3001session_id\u3001agent_id \u7b49\u52a8\u6001\u4e0a\u4e0b\u6587\nresult = await sandbox.call_tool(\n    action_list=[{\n        \"tool_name\": \"server_name\",\n        \"action_name\": \"tool_name\",\n        \"params\": {\n            # env_content \u4f1a\u81ea\u52a8\u6ce8\u5165\uff0c\u65e0\u9700\u624b\u52a8\u4f20\u9012\n            # \u6700\u7ec8\u53c2\u6570\u4f1a\u5305\u542b\uff1a\n            # {\n            #     \"user_id\": \"user123\",\n            #     \"workspace\": \"/path/to/workspace\",\n            #     \"custom_config\": {\"key\": \"value\"},\n            #     \"task_id\": \"...\",  # \u4ece context \u81ea\u52a8\u6dfb\u52a0\n            #     \"session_id\": \"...\",  # \u4ece context \u81ea\u52a8\u6dfb\u52a0\n            #     \"agent_id\": \"...\"  # \u4ece event_message \u81ea\u52a8\u6dfb\u52a0\n            # }\n        }\n    }],\n    context=context  # \u4f20\u5165 context \u4ee5\u81ea\u52a8\u6dfb\u52a0 task_id \u548c session_id\n)\n</code></pre> <p>\u5de5\u4f5c\u539f\u7406\uff1a 1. \u73af\u5883\u4e0a\u4e0b\u6587\u53c2\u6570\u5728\u5de5\u5177 schema \u4e2d\u4f1a\u88ab\u9690\u85cf\uff08LLM \u770b\u4e0d\u5230\uff09 2. \u5de5\u5177\u8c03\u7528\u65f6\u81ea\u52a8\u6ce8\u5165\u7528\u6237\u5b9a\u4e49\u7684\u503c 3. \u52a8\u6001\u6dfb\u52a0 <code>task_id</code>\u3001<code>session_id</code>\u3001<code>agent_id</code> \u7b49\u4e0a\u4e0b\u6587\u4fe1\u606f 4. \u5982\u679c\u7528\u6237\u624b\u52a8\u63d0\u4f9b\u4e86\u53c2\u6570\u503c\uff0c\u7528\u6237\u503c\u4f18\u5148</p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#agent","title":"Agent \u8fd0\u884c\u652f\u6301","text":"<p>\u652f\u6301\u5c06 Agent \u914d\u7f6e\u5728 Environment \u73af\u5883\u4e2d\u8fd0\u884c\uff0c\u4f7f Agent \u53ef\u4ee5\u4f5c\u4e3a\u5de5\u5177\u88ab\u5176\u4ed6 Agent \u8c03\u7528\u3002</p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#agent_1","title":"\u672c\u5730 Agent","text":"<pre><code># \u7b80\u5355\u683c\u5f0f\uff1a\u76f4\u63a5\u6307\u5b9a Agent \u76ee\u5f55\u8def\u5f84\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config({...}).agents({\n    \"local_agent\": \"/path/to/agents\"  # Agent \u76ee\u5f55\u8def\u5f84\n}).build()\n\n# \u6269\u5c55\u683c\u5f0f\uff1a\u63d0\u4f9b\u66f4\u591a\u914d\u7f6e\u9009\u9879\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config({...}).agents({\n    \"advanced_agent\": {\n        \"location\": \"/path/to/agents\",\n        \"run_mode\": \"local\",  # \u53ef\u9009\uff1a\"local\" \u6216 \"remote\"\uff0c\u9ed8\u8ba4 \"local\"\n        \"env\": {\"KEY\": \"value\"},  # \u53ef\u9009\uff1a\u73af\u5883\u53d8\u91cf\n        \"cwd\": \"/path/to/workdir\",  # \u53ef\u9009\uff1a\u5de5\u4f5c\u76ee\u5f55\n        \"headers\": {\n            \"SANDBOX_ENV\": '{\"key\": \"value\"}'  # \u53ef\u9009\uff1a\u901a\u8fc7 headers \u4f20\u9012\u73af\u5883\u53d8\u91cf\uff08JSON \u5b57\u7b26\u4e32\uff09\n        }\n    }\n}).build()\n\n# \u4f7f\u7528\u94fe\u5f0f Builder API \u914d\u7f6e Agent\nsandbox = (Sandbox()\n    .mcp_config({...})\n    .agents()\n    .advanced_agent()\n    .location(\"/path/to/agents\")\n    .run_mode(\"local\")\n    .env({\"KEY\": \"value\"})\n    .build()\n)\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#agent_2","title":"\u8fdc\u7a0b Agent","text":"<pre><code>import os\n\n# \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff08\u8fdc\u7a0b Agent \u5fc5\u9700\uff09\nos.environ[\"CUSTOM_ENV_URL\"] = \"https://custom.example.com\"\nos.environ[\"CUSTOM_ENV_TOKEN\"] = \"your_token\"\nos.environ[\"CUSTOM_ENV_IMAGE_VERSION\"] = \"v1.0.0\"\n\n# \u7b80\u5355\u683c\u5f0f\uff1a\u76f4\u63a5\u6307\u5b9a\u8fdc\u7a0b URL\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config({...}).agents({\n    \"remote_agent\": \"https://github.com/user/repo.git\"  # Git \u4ed3\u5e93 URL\n}).build()\n\n# \u6269\u5c55\u683c\u5f0f\uff1a\u63d0\u4f9b\u66f4\u591a\u914d\u7f6e\u9009\u9879\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config({...}).agents({\n    \"remote_agent\": {\n        \"location\": \"https://github.com/user/repo.git\",\n        \"run_mode\": \"remote\",  # \u660e\u786e\u6307\u5b9a\u4e3a\u8fdc\u7a0b\u6a21\u5f0f\n        \"repo_url\": \"https://github.com/user/repo.git\",  # \u53ef\u9009\uff1a\u5982\u679c location \u4e0d\u662f URL\n        \"project_path\": \"subdir\",  # \u53ef\u9009\uff1a\u9879\u76ee\u5b50\u76ee\u5f55\n        \"env\": {\"KEY\": \"value\"},  # \u53ef\u9009\uff1a\u73af\u5883\u53d8\u91cf\n        \"headers\": {\"Custom-Header\": \"value\"}  # \u53ef\u9009\uff1a\u81ea\u5b9a\u4e49 HTTP \u5934\u90e8\n    }\n}).build()\n</code></pre> <p>\u6ce8\u610f\u4e8b\u9879\uff1a - \u672c\u5730 Agent \u4f7f\u7528 <code>aworld-cli serve --mcp --agent-dir</code> \u547d\u4ee4\u542f\u52a8 - \u8fdc\u7a0b Agent \u9700\u8981\u8bbe\u7f6e <code>CUSTOM_ENV_URL</code>\u3001<code>CUSTOM_ENV_TOKEN</code>\u3001<code>CUSTOM_ENV_IMAGE_VERSION</code> \u73af\u5883\u53d8\u91cf - Agent \u914d\u7f6e\u4f1a\u81ea\u52a8\u8f6c\u6362\u4e3a MCP \u670d\u52a1\u5668\u914d\u7f6e\u5e76\u5408\u5e76\u5230 <code>mcp_config</code> \u4e2d</p>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_7","title":"\u81ea\u5b9a\u4e49\u73af\u5883\u5de5\u5177","text":"<pre><code>import os\n\n# \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\nos.environ[\"CUSTOM_ENV_URL\"] = \"https://custom.example.com\"\nos.environ[\"CUSTOM_ENV_TOKEN\"] = \"your_token\"\nos.environ[\"CUSTOM_ENV_IMAGE_VERSION\"] = \"v1.0.0\"\n\n# \u4f7f\u7528\u81ea\u5b9a\u4e49\u73af\u5883\u5de5\u5177\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().custom_env_tools({\n    \"custom_server\": {\n        \"type\": \"streamable-http\",\n        \"url\": \"...\",\n        \"headers\": {...}\n    }\n}).build()\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_8","title":"\u9ed1\u540d\u5355\u5de5\u5177","text":"<pre><code># \u7981\u7528\u7279\u5b9a\u5de5\u5177\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config({\n    \"mcpServers\": {\n        \"server_name\": {...}\n    }\n}).black_tool_actions({\n    \"server_name\": [\"tool1\", \"tool2\"]  # \u7981\u7528\u8fd9\u4e9b\u5de5\u5177\n}).build()\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_9","title":"\u6280\u80fd\u914d\u7f6e","text":"<pre><code># \u914d\u7f6e\u6280\u80fd\u7cfb\u7edf\uff08Builder \u6a21\u5f0f\uff09\nsandbox = Sandbox().mcp_config({\n    \"mcpServers\": {\n        \"server_name\": {...}\n    }\n}).skill_configs({\n    \"skill1\": {\n        \"tools\": [\"tool1\", \"tool2\"],\n        \"description\": \"\u6280\u80fd\u63cf\u8ff0\"\n    }\n}).build()\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_10","title":"\u5de5\u5177\u6ce8\u518c","text":""},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_11","title":"\u6ce8\u518c\u5230\u8fdc\u7a0b\u6ce8\u518c\u4e2d\u5fc3","text":"<pre><code>from aworld.sandbox import Sandbox\n\nresult = await Sandbox.register(\n    registry_url=\"https://registry.example.com\",\n    name=\"my-server\",\n    version=\"1.0.0\",\n    description=\"\u6211\u7684\u670d\u52a1\u5668\u63cf\u8ff0\",\n    data={\n        \"type\": \"streamable-http\",\n        \"url\": \"https://...\",\n        \"headers\": {...}\n    },\n    tools=[\n        {\n            \"name\": \"tool_name\",\n            \"description\": \"\u5de5\u5177\u63cf\u8ff0\"\n        }\n    ],\n    token=\"your_registry_token\"\n)\n\n# \u8fd4\u56de\u7ed3\u679c\n# {\n#     \"success\": True,\n#     \"entity_id\": \"...\",\n#     \"message\": \"Successfully registered my-server\"\n# }\n</code></pre>"},{"location":"docs_zh/%E7%8E%AF%E5%A2%83/%E9%AB%98%E7%BA%A7%E8%83%BD%E5%8A%9B/#_12","title":"\u6ce8\u518c\u5230\u672c\u5730\u6587\u4ef6","text":"<pre><code>result = await Sandbox.register(\n    registry_url=\"~/workspace/registry.json\",\n    servers={\n        \"mcpServers\": {\n            \"server_name\": {\n                \"type\": \"streamable-http\",\n                \"url\": \"https://...\",\n                \"headers\": {...}\n            }\n        }\n    }\n)\n\n# \u8fd4\u56de\u7ed3\u679c\n# {\n#     \"success\": True,\n#     \"file_path\": \"/path/to/registry.json\",\n#     \"message\": \"Successfully registered 1 server(s) to local file\",\n#     \"registered_count\": 1\n# }\n</code></pre>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/","title":"\u8bad\u7ec3\u5668\uff08Trainer\uff09","text":"<p><code>AgentTrainer</code> \u662f AWorld \u6846\u67b6\u7684\u7edf\u4e00\u8bad\u7ec3 API \u5165\u53e3\uff0c\u4e3a Agent \u7684\u8bad\u7ec3\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ad8\u5ea6\u62bd\u8c61\u548c\u7075\u6d3b\u7684\u63a5\u53e3\u3002\u5b83\u652f\u6301\u591a\u79cd\u540e\u7aef\u8bad\u7ec3\u6846\u67b6\uff08\u5982 VeRL\uff09\uff0c\u5e76\u7edf\u4e00\u7ba1\u7406 Agent\u3001\u6570\u636e\u96c6\u3001\u5956\u52b1\u51fd\u6570\u548c\u8bad\u7ec3\u914d\u7f6e\u56db\u5927\u6838\u5fc3\u6a21\u5757\u3002</p>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_1","title":"\u4e3b\u8981\u7279\u6027","text":"<ul> <li>\u2705 \u7edf\u4e00 API \u5165\u53e3\uff1a\u4e3a\u4e0d\u540c\u7684\u8bad\u7ec3\u6846\u67b6\u63d0\u4f9b\u4e00\u81f4\u7684\u63a5\u53e3</li> <li>\u2705 \u6a21\u5757\u5316\u8bbe\u8ba1\uff1aAgent\u3001Dataset\u3001Reward\u3001Config \u56db\u5927\u6a21\u5757\u72ec\u7acb\u7ba1\u7406</li> <li>\u2705 \u7075\u6d3b\u6269\u5c55\uff1a\u652f\u6301\u6ce8\u518c\u81ea\u5b9a\u4e49\u7684\u8bad\u7ec3\u5f15\u64ce</li> <li>\u2705 \u5b8c\u6574\u9a8c\u8bc1\uff1a\u5728\u521d\u59cb\u5316\u65f6\u5bf9\u6240\u6709\u6a21\u5757\u8fdb\u884c\u9a8c\u8bc1</li> <li>\u2705 \u9519\u8bef\u5904\u7406\uff1a\u6e05\u6670\u7684\u9519\u8bef\u63d0\u793a\u548c\u65e5\u5fd7\u8bb0\u5f55</li> </ul>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_2","title":"\u67b6\u6784\u8bbe\u8ba1","text":""},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_3","title":"\u6574\u4f53\u67b6\u6784\u56fe","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    AgentTrainer                 \u2502\n\u2502              (\u7edf\u4e00\u8bad\u7ec3 API \u5165\u53e3)                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502           \u2502           \u2502\n      \u521d\u59cb\u5316\u9a8c\u8bc1    \u6a21\u5757\u7ba1\u7406    \u6846\u67b6\u9009\u62e9\n         \u2502           \u2502           \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502                         \u2502\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502   Trainer    \u2502         \u2502   Trainer    \u2502\n   \u2502  (VeRL)      \u2502  ...... \u2502  (Swift)     \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502                       \u2502\n    \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u250c\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510\n    \u2502          \u2502          \u2502          \u2502\n  Agent    Dataset     Reward    Config\n</code></pre>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_4","title":"\u6a21\u5757\u4ea4\u4e92\u6d41\u7a0b","text":"<pre><code>\u7528\u6237\u521b\u5efa AgentTrainer\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  1. \u53c2\u6570\u9a8c\u8bc1                        \u2502\n\u2502     - \u786e\u4fdd agent \u975e\u7a7a               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  2. \u83b7\u53d6\u8bad\u7ec3\u5f15\u64ce\u7c7b                  \u2502\n\u2502     - \u4ece TRAIN_PROCESSOR \u5b57\u5178\u67e5\u8be2   \u2502\n\u2502     - \u9ed8\u8ba4\u4f7f\u7528 'verl'               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  3. \u5b9e\u4f8b\u5316\u8bad\u7ec3\u5f15\u64ce                  \u2502\n\u2502     - \u521b\u5efa TrainerProcessor \u5b50\u7c7b    \u2502\n\u2502     - \u4f20\u5165 run_path                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  4. \u6a21\u5757\u9a8c\u8bc1 (\u91cd\u8981!)                \u2502\n\u2502     \u251c\u2500 check_agent()                \u2502\n\u2502     \u251c\u2500 check_dataset()              \u2502\n\u2502     \u251c\u2500 check_reward()               \u2502\n\u2502     \u2514\u2500 check_config()               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  5. \u6807\u8bb0\u521d\u59cb\u5316\u5b8c\u6210                  \u2502\n\u2502     - mark_initialized()            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  6. \u5f00\u59cb\u8bad\u7ec3                        \u2502\n\u2502     - train_processor.train()       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_5","title":"\u6838\u5fc3\u6a21\u5757","text":""},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#agenttrainer","title":"AgentTrainer","text":"<p>Agent\u8bad\u7ec3\u5668\uff0c\u8d1f\u8d23\u7edf\u4e00\u7ba1\u7406\u548c\u534f\u8c03\u6240\u6709\u8bad\u7ec3\u76f8\u5173\u6a21\u5757\u3002</p>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_6","title":"\u5c5e\u6027","text":"\u5c5e\u6027 \u7c7b\u578b \u8bf4\u660e <code>agent</code> <code>Union[str, Agent]</code> Agent \u6a21\u5757\u6216\u914d\u7f6e\u6587\u4ef6\u8def\u5f84 <code>train_dataset</code> <code>Union[str, Dataset]</code> \u8bad\u7ec3\u6570\u636e\u96c6\u6216\u8def\u5f84 <code>test_dataset</code> <code>Union[str, Dataset]</code> \u6d4b\u8bd5\u6570\u636e\u96c6\u6216\u8def\u5f84 <code>reward_func</code> <code>Union[str, Callable]</code> \u5956\u52b1\u51fd\u6570\u6216\u8def\u5f84 <code>config</code> <code>Union[str, Config]</code> \u8bad\u7ec3\u914d\u7f6e <code>train_engine_name</code> <code>str</code> \u8bad\u7ec3\u6846\u67b6\u540d\u79f0\uff08\u9ed8\u8ba4: 'verl'\uff09 <code>run_path</code> <code>str</code> \u8fd0\u884c\u8f93\u51fa\u8def\u5f84\uff08\u9ed8\u8ba4: 'runs'\uff09 <code>train_processor</code> <code>TrainerProcessor</code> \u5b9e\u9645\u7684\u8bad\u7ec3\u5904\u7406\u5668\u5b9e\u4f8b <p>\u521d\u59cb\u5316</p> <pre><code>trainer = AgentTrainer(\n    agent='path/to/agent_config.yaml',\n    train_dataset='path/to/train_dataset.csv',\n    test_dataset='path/to/test_dataset.csv',\n    reward_func=my_reward_function,\n    config=training_config,\n    run_path='./outputs',\n    train_engine_name='verl'\n)\n</code></pre> <p>\u542f\u52a8\u8bad\u7ec3\u8fc7\u7a0b</p> <pre><code>def train(self) -&gt; None:\n</code></pre> <ul> <li>\u68c0\u67e5\u8bad\u7ec3\u5904\u7406\u5668\u662f\u5426\u5df2\u521d\u59cb\u5316</li> <li>\u8c03\u7528\u8bad\u7ec3\u5904\u7406\u5668\u7684 <code>train()</code> \u65b9\u6cd5</li> <li>\u5982\u679c\u5904\u7406\u5668\u672a\u521d\u59cb\u5316\uff0c\u629b\u51fa ValueError</li> </ul> <p>\u6ce8\u518c\u81ea\u5b9a\u4e49\u8bad\u7ec3\u5f15\u64ce</p> <pre><code>AgentTrainer.register_processor(train_engine_name='custom', CustomTrainer)\n</code></pre> <ul> <li><code>train_engine_name</code>: \u8bad\u7ec3\u6846\u67b6\u7684\u540d\u79f0\uff08\u552f\u4e00\u6807\u8bc6\u7b26\uff09</li> <li><code>train_type</code>: TrainerProcessor \u7684\u5b50\u7c7b</li> </ul> <p>\u6ce8\u9500\u5df2\u6ce8\u518c\u7684\u8bad\u7ec3\u5f15\u64ce</p> <pre><code>AgentTrainer.unregister_processor(train_engine_name='custom')\n</code></pre> <ul> <li><code>train_engine_name</code>: \u8bad\u7ec3\u6846\u67b6\u7684\u540d\u79f0\uff08\u552f\u4e00\u6807\u8bc6\u7b26\uff09</li> </ul>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#trainerprocessor","title":"TrainerProcessor","text":"<p>\u5b9a\u4e49\u8bad\u7ec3\u5904\u7406\u5668\u7684\u63a5\u53e3\u89c4\u8303\u3002\u6240\u6709\u5177\u4f53\u7684\u8bad\u7ec3\u6846\u67b6\u7ee7\u627f\u8fd9\u4e2a\u57fa\u7c7b\u3002</p>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_7","title":"\u8bad\u7ec3\u65b9\u6cd5","text":"<pre><code>@abc.abstractmethod\ndef train(self) -&gt; None\n</code></pre> <p>\u804c\u8d23\uff1a </p> <ul> <li>\u5177\u4f53\u7684\u8bad\u7ec3\u903b\u8f91</li> <li>\u6570\u636e\u52a0\u8f7d</li> <li>\u6a21\u578b\u521d\u59cb\u5316</li> <li>\u8bad\u7ec3\u5faa\u73af\u7b49</li> </ul>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_8","title":"\u9a8c\u8bc1\u548c\u5904\u7406\u6570\u636e\u96c6","text":"<pre><code>@abc.abstractmethod\ndef check_dataset(self, \n                 dataset: Union[str, Dataset] = None,\n                 test_dataset: Union[str, Dataset] = None) -&gt; None\n</code></pre> <p>\u804c\u8d23\uff1a</p> <ul> <li>\u9a8c\u8bc1\u6570\u636e\u96c6\u683c\u5f0f\u662f\u5426\u7b26\u5408\u6846\u67b6\u8981\u6c42</li> <li>\u5c06\u6570\u636e\u96c6\u8f6c\u6362\u4e3a\u6846\u67b6\u652f\u6301\u7684\u683c\u5f0f</li> <li>\u5904\u7406\u6570\u636e\u96c6\u8def\u5f84\uff08\u5982\u679c\u662f\u5b57\u7b26\u4e32\uff09</li> <li>\u9a8c\u8bc1\u8bad\u7ec3\u96c6\u548c\u6d4b\u8bd5\u96c6\u7684\u5b8c\u6574\u6027</li> </ul>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#agent","title":"\u9a8c\u8bc1\u548c\u5904\u7406 Agent","text":"<pre><code>@abc.abstractmethod\ndef check_agent(self, agent: Union[str, Agent]) -&gt; None\n</code></pre> <p>\u804c\u8d23\uff1a</p> <ul> <li>\u9a8c\u8bc1 Agent \u6216\u5176\u914d\u7f6e</li> <li>\u5c06 AWorld Agent \u8f6c\u6362\u4e3a\u7279\u5b9a\u6846\u67b6\u652f\u6301\u7684\u5f62\u5f0f</li> <li>\u5904\u7406 Agent \u914d\u7f6e\u6587\u4ef6\uff08\u5982\u679c\u662f\u5b57\u7b26\u4e32\uff09</li> <li>\u786e\u4fdd Agent \u6a21\u578b\u548c\u53c2\u6570\u7684\u6709\u6548\u6027</li> </ul>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_9","title":"\u9a8c\u8bc1\u548c\u5904\u7406\u5956\u52b1\u51fd\u6570(\u6709\u76d1\u7763\u6807\u6ce8)","text":"<pre><code>@abc.abstractmethod\ndef check_reward(self, \n                reward_func: Union[str, Callable[..., Any]] = None) -&gt; None\n</code></pre> <p>\u804c\u8d23\uff1a</p> <ul> <li>\u9a8c\u8bc1\u5956\u52b1\u51fd\u6570\u7684\u7b7e\u540d\u548c\u8fd4\u56de\u7c7b\u578b</li> <li>\u5c06\u5956\u52b1\u51fd\u6570\u914d\u7f6e\u8f6c\u6362\u4e3a\u6846\u67b6\u652f\u6301\u7684\u683c\u5f0f</li> <li>\u5904\u7406\u5956\u52b1\u51fd\u6570\u4ee3\u7801\u6587\u4ef6\uff08\u5982\u679c\u662f\u5b57\u7b26\u4e32\uff09</li> <li>\u9a8c\u8bc1\u5956\u52b1\u51fd\u6570\u7684\u53ef\u8c03\u7528\u6027</li> </ul>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_10","title":"\u9a8c\u8bc1\u548c\u6539\u8fdb\u8bad\u7ec3\u914d\u7f6e","text":"<pre><code>@abc.abstractmethod\ndef check_config(self, \n                config: Union[str, Any] = None) -&gt; Any\n</code></pre> <p>\u804c\u8d23\uff1a</p> <ul> <li>\u9a8c\u8bc1\u8bad\u7ec3\u914d\u7f6e\u662f\u5426\u6ee1\u8db3\u6846\u67b6\u8981\u6c42</li> <li>\u8865\u5145\u548c\u6539\u8fdb\u914d\u7f6e\uff08\u6dfb\u52a0\u9ed8\u8ba4\u503c\u7b49\uff09</li> <li>\u5904\u7406\u914d\u7f6e\u6587\u4ef6\uff08\u5982\u679c\u662f\u5b57\u7b26\u4e32\uff09</li> <li>\u8fd4\u56de\u6539\u8fdb\u540e\u7684\u914d\u7f6e</li> </ul>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#_11","title":"\u81ea\u5b9a\u4e49\u8bad\u7ec3\u5904\u7406\u5668","text":"<p>AWorld\u6ca1\u6709\u9650\u5236\u8bad\u7ec3\u6a21\u5f0f\u548c\u7b56\u7565\uff0c\u80fd\u591f\u81ea\u5b9a\u4e49\u4f7f\u7528\u591a\u79cd\u8bad\u7ec3\u6a21\u5f0f\u548c\u7b56\u7565\uff0c\u5982\uff1a</p> <ul> <li>\u76d1\u7763\u5b66\u4e60\u3002\u4f7f\u7528\u9884\u6536\u96c6\u7684\u6570\u636e\u96c6\u8fdb\u884c\u76d1\u7763\u5b66\u4e60\uff0c\u9002\u7528\u4e8e\u6709\u6807\u6ce8\u6570\u636e\u7684\u573a\u666f\u3002</li> <li>\u5f3a\u5316\u5b66\u4e60\u3002\u901a\u8fc7\u4e0e\u73af\u5883\u7684\u4ea4\u4e92\u5b66\u4e60\u6700\u4f18\u7b56\u7565\uff0c\u9002\u7528\u4e8e\u51b3\u7b56\u4f18\u5316\u573a\u666f\u3002</li> <li>\u8fc1\u79fb\u5b66\u4e60\u3002\u5229\u7528\u9884\u8bad\u7ec3\u6a21\u578b\u8fdb\u884c\u8fc1\u79fb\u5b66\u4e60\uff0c\u52a0\u901f\u65b0\u4efb\u52a1\u7684\u8bad\u7ec3\u8fc7\u7a0b\u3002</li> <li>\u5728\u7ebf\u5b66\u4e60\u3002\u5728\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u6301\u7eed\u5b66\u4e60\uff0c\u5b9e\u65f6\u66f4\u65b0\u6a21\u578b\u53c2\u6570\u3002</li> </ul> <p>\u6a21\u5757\u901a\u5e38\u9700\u8981\u5305\u542b\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ul> <li>\u6a21\u578b\u53c2\u6570\u7ba1\u7406</li> <li>\u7ecf\u9a8c\u6570\u636e\u6536\u96c6</li> <li>\u8bad\u7ec3\u7b56\u7565\u6267\u884c</li> <li>\u6a21\u578b\u66f4\u65b0\u673a\u5236</li> </ul> <p>\u4e3a AWorld \u6dfb\u52a0\u65b0\u7684\u8bad\u7ec3\u6846\u67b6\u652f\u6301\uff0c\u9700\u8981\uff1a</p>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#1-trainerprocessor","title":"\u6b65\u9aa4 1: \u7ee7\u627f TrainerProcessor","text":"<pre><code># train/adapter/your_framework/my_trainer.py\n\nfrom train.trainer.trainer_processor import TrainerProcessor\nfrom typing import Union, Callable, Any\nfrom datasets import Dataset\nfrom aworld.agents.llm_agent import Agent\nfrom aworld.logs.util import logger\n\nclass MyFrameworkTrainer(TrainerProcessor):\n    \"\"\"My custom training framework adapter.\"\"\"\n\n    def __init__(self, run_path: str):\n        super().__init__(run_path)\n        # \u521d\u59cb\u5316\u6846\u67b6\u7279\u5b9a\u7684\u5c5e\u6027\n        self.framework_config = None\n\n    def train(self):\n        \"\"\"\u5b9e\u73b0\u5177\u4f53\u7684\u8bad\u7ec3\u903b\u8f91\"\"\"\n        logger.info(\"Starting training with MyFramework...\")\n\n        # \u4f60\u7684\u8bad\u7ec3\u4ee3\u7801\n        # - \u52a0\u8f7d\u6570\u636e\n        # - \u521d\u59cb\u5316\u6a21\u578b\n        # - \u8bad\u7ec3\u5faa\u73af\n        # - \u4fdd\u5b58\u68c0\u67e5\u70b9\n\n        logger.info(\"Training completed!\")\n\n    def check_agent(self, agent: Union[str, Agent]):\n        \"\"\"\u9a8c\u8bc1\u548c\u8f6c\u6362 Agent\"\"\"\n        if isinstance(agent, str):\n            # \u4ece\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d Agent\n            logger.info(f\"Loading agent from {agent}\")\n            # ... \u52a0\u8f7d\u903b\u8f91\n        else:\n            # \u9a8c\u8bc1 Agent \u5bf9\u8c61\n            logger.info(\"Validating Agent object\")\n            # ... \u9a8c\u8bc1\u903b\u8f91\n\n    def check_dataset(self, \n                     dataset: Union[str, Dataset] = None, \n                     test_dataset: Union[str, Dataset] = None):\n        \"\"\"\u9a8c\u8bc1\u548c\u8f6c\u6362\u6570\u636e\u96c6\"\"\"\n        if dataset:\n            if isinstance(dataset, str):\n                # \u52a0\u8f7d\u6570\u636e\u96c6\n                logger.info(f\"Loading dataset from {dataset}\")\n                # ... \u52a0\u8f7d\u903b\u8f91\n            else:\n                # \u9a8c\u8bc1\u6570\u636e\u96c6\u683c\u5f0f\n                logger.info(\"Validating dataset format\")\n                # ... \u9a8c\u8bc1\u903b\u8f91\n\n        if test_dataset:\n            # \u7c7b\u4f3c\u5904\u7406\u6d4b\u8bd5\u96c6\n            pass\n\n    def check_reward(self, reward_func: Union[str, Callable[..., Any]] = None):\n        \"\"\"\u9a8c\u8bc1\u5956\u52b1\u51fd\u6570\"\"\"\n        if reward_func:\n            if isinstance(reward_func, str):\n                # \u4ece\u6587\u4ef6\u52a0\u8f7d\u5956\u52b1\u51fd\u6570\n                logger.info(f\"Loading reward function from {reward_func}\")\n                # ... \u52a0\u8f7d\u903b\u8f91\n            elif callable(reward_func):\n                # \u9a8c\u8bc1\u53ef\u8c03\u7528\u6027\n                logger.info(\"Validating reward function\")\n                # ... \u9a8c\u8bc1\u903b\u8f91\n            else:\n                raise ValueError(\"Reward func must be callable or file path\")\n\n    def check_config(self, config: Union[str, Any] = None):\n        \"\"\"\u9a8c\u8bc1\u548c\u6539\u8fdb\u914d\u7f6e\"\"\"\n        if config is None:\n            # \u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n            config = self.get_default_config()\n        elif isinstance(config, str):\n            # \u4ece\u6587\u4ef6\u52a0\u8f7d\u914d\u7f6e\n            logger.info(f\"Loading config from {config}\")\n            # ... \u52a0\u8f7d\u903b\u8f91\n\n        # \u9a8c\u8bc1\u548c\u6539\u8fdb\u914d\u7f6e\n        self.framework_config = config\n        return config\n\n    @staticmethod\n    def get_default_config():\n        \"\"\"\u8fd4\u56de\u9ed8\u8ba4\u914d\u7f6e\"\"\"\n        return {\n            'learning_rate': 1e-4,\n            'batch_size': 32,\n            'epochs': 10,\n            'warmup_steps': 1000,\n        }\n</code></pre>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#2","title":"\u6b65\u9aa4 2: \u6ce8\u518c\u8bad\u7ec3\u6846\u67b6","text":"<pre><code># train/adapter/your_framework/__init__.py\n\nfrom .my_trainer import MyFrameworkTrainer\n\n__all__ = ['MyFrameworkTrainer']\n</code></pre>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AE%AD%E7%BB%83%E5%99%A8%EF%BC%88Trainer%EF%BC%89/#3-agenttrainer","title":"\u6b65\u9aa4 3: \u5728 AgentTrainer \u4e2d\u6ce8\u518c","text":"<p>\u9009\u9879 A: \u5728\u4ee3\u7801\u4e2d\u52a8\u6001\u6ce8\u518c</p> <pre><code>from train.integration.my_framework import MyFrameworkTrainer\nfrom train.trainer.agent_trainer import AgentTrainer\n\n# \u6ce8\u518c\u6846\u67b6\nAgentTrainer.register_processor('my_framework', MyFrameworkTrainer)\n\n# \u4f7f\u7528\u6846\u67b6\ntrainer = AgentTrainer(\n    agent=my_agent,\n    train_engine_name='my_framework'\n)\n</code></pre> <p>\u9009\u9879 B: \u5728\u521d\u59cb\u5316\u65f6\u6ce8\u518c\uff08\u63a8\u8350\u7528\u4e8e\u5e93\uff09</p> <pre><code># train/trainer/__init__.py\n\nfrom .agent_trainer import AgentTrainer\nfrom train.integration.my_framework import MyFrameworkTrainer\n\n# \u5728\u6a21\u5757\u5bfc\u5165\u65f6\u81ea\u52a8\u6ce8\u518c\nAgentTrainer.register_processor('my_framework', MyFrameworkTrainer)\n</code></pre>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AF%84%E4%BC%B0%EF%BC%88Evaluation%EF%BC%89/","title":"\u8bc4\u4f30\uff08Evaluation\uff09","text":"<p>AWorld\u7684\u8bc4\u4f30\u7cfb\u7edf\u63d0\u4f9b\u4e86\u4e00\u5957\u5b8c\u6574\u3001\u7075\u6d3b\u7684\u8bc4\u4f30\u6846\u67b6\uff0c\u652f\u6301\u591a\u79cd\u8bc4\u4f30\u573a\u666f\u548c\u8bc4\u4f30\u76ee\u6807\uff08\u5982\u591a\u667a\u80fd\u4f53\u7cfb\u7edf\u3001\u5de5\u5177\u8c03\u7528\u3001\u4efb\u52a1\u5b8c\u6210\u8d28\u91cf\uff09\u3002\u57fa\u4e8e\u6a21\u5757\u5316\u8bbe\u8ba1\uff0c\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u6269\u5c55\u8bc4\u4f30\u529f\u80fd\uff0c\u6ee1\u8db3\u7279\u5b9a\u7684\u8bc4\u4f30\u9700\u6c42\u3002\u8bc4\u4f30\u6846\u67b6\u4e3aAgent\u7684\u6301\u7eed\u6539\u8fdb\u63d0\u4f9b\u4e86\u91cd\u8981\u652f\u6491\u3002</p>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AF%84%E4%BC%B0%EF%BC%88Evaluation%EF%BC%89/#_1","title":"\u6838\u5fc3\u7ec4\u4ef6","text":"<ul> <li>\u8bc4\u4f30\u76ee\u6807\uff08EvalTarget\uff09\u3002\u8bc4\u4f30\u76ee\u6807\u662f\u8bc4\u4f30\u7cfb\u7edf\u7684\u6838\u5fc3\u6982\u5ff5\uff0c\u5b9a\u4e49\u4e86\u8bc4\u4f30\u7684\u5bf9\u8c61\u548c\u65b9\u6cd5\u3002<ul> <li>AWorld\u6846\u67b6\u5185\u7f6e\u4e86\u4e24\u79cd\u7c7b\u578b\u7684\u8bc4\u4f30\u76ee\u6807\uff1a<ul> <li>AworldAgentEvalTarget\uff1a\u7528\u4e8e\u8bc4\u4f30AWorld\u667a\u80fd\u4f53\u7684\u6027\u80fd</li> <li>AworldTaskEvalTarget\uff1a\u7528\u4e8e\u8bc4\u4f30AWorld\u4efb\u52a1\u7684\u5b8c\u6210\u60c5\u51b5</li> </ul> </li> <li>\u7528\u6237\u81ea\u5b9a\u4e49\u8bc4\u4f30\u76ee\u6807\uff1a\u7528\u6237\u53ef\u4ee5\u6839\u636e\u9700\u8981\u5b9e\u73b0\u81ea\u5df1\u7684\u8bc4\u4f30\u76ee\u6807\u3002\u8bc4\u4f30\u76ee\u6807\u901a\u8fc7<code>predict</code>\u65b9\u6cd5\u6267\u884c\u5177\u4f53\u7684\u8bc4\u4f30\u903b\u8f91\uff0c\u8fd4\u56de\u8bc4\u4f30\u7ed3\u679c\u3002</li> </ul> </li> <li>\u8bc4\u4f30\u6307\u6807\uff08Scorer\uff09<ul> <li>\u529f\u80fd\u6027\u6307\u6807\uff1a\u8bc4\u4f30\u4efb\u52a1\u5b8c\u6210\u7684\u51c6\u786e\u6027</li> <li>\u6027\u80fd\u6307\u6807\uff1a\u8bc4\u4f30\u6267\u884c\u6548\u7387\u548c\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5</li> <li>\u8d28\u91cf\u6307\u6807\uff1a\u8bc4\u4f30\u8f93\u51fa\u5185\u5bb9\u7684\u8d28\u91cf\u548c\u591a\u6837\u6027</li> </ul> </li> <li>\u8bc4\u4f30\u6570\u636e\u96c6\uff08EvalDataset\uff09<ul> <li>\u8bc4\u4f30\u6570\u636e\u96c6\u7528\u4e8e\u5b58\u50a8\u8bc4\u4f30\u6240\u9700\u7684\u6570\u636e\uff0c\u652f\u6301\u591a\u79cd\u6570\u636e\u683c\u5f0f\u548c\u52a0\u8f7d\u65b9\u5f0f\u3002\u6570\u636e\u96c6\u5305\u542b\u8f93\u5165\u6570\u636e\u548c\u671f\u671b\u8f93\u51fa\uff0c\u7528\u4e8e\u5bf9\u6bd4\u5b9e\u9645\u8f93\u51fa\u4e0e\u671f\u671b\u8f93\u51fa\u7684\u5dee\u5f02\u3002</li> </ul> </li> <li>\u8bc4\u4f30\u8fd0\u884c\u5668\uff08EvaluateRunner\uff09<ul> <li>\u8bc4\u4f30\u8fd0\u884c\u5668\u8d1f\u8d23\u534f\u8c03\u6574\u4e2a\u8bc4\u4f30\u8fc7\u7a0b\uff0c\u5305\u62ec\u6570\u636e\u96c6\u52a0\u8f7d\u3001\u8bc4\u4f30\u6267\u884c\u3001\u7ed3\u679c\u6536\u96c6\u548c\u62a5\u544a\u751f\u6210\u3002</li> </ul> </li> </ul>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AF%84%E4%BC%B0%EF%BC%88Evaluation%EF%BC%89/#_2","title":"\u8bc4\u4f30\u6d41\u7a0b","text":"<ul> <li>\u8bc4\u4f30\u914d\u7f6e\u3002\u8bc4\u4f30\u5f00\u59cb\u524d\u9700\u8981\u914d\u7f6e\u7684\u76f8\u5173\u53c2\u6570\uff1a<ul> <li>\u8bc4\u4f30\u76ee\u6807\u7c7b\u578b</li> <li>\u8bc4\u4f30\u6570\u636e\u96c6\u8def\u5f84</li> <li>\u8bc4\u4f30\u6307\u6807\u9009\u62e9</li> <li>\u8bc4\u4f30\u7b56\u7565\u8bbe\u7f6e</li> <li>\u8f93\u51fa\u76ee\u5f55</li> </ul> </li> <li>\u6570\u636e\u52a0\u8f7d\u3002\u8bc4\u4f30\u7cfb\u7edf\u4ece\u6307\u5b9a\u7684\u6570\u636e\u96c6\u52a0\u8f7d\u8bc4\u4f30\u6570\u636e\uff0c\u5305\u62ec\u8f93\u5165\u6570\u636e\u548c\u671f\u671b\u8f93\u51fa\u3002\u6570\u636e\u96c6\u652f\u6301\u591a\u79cd\u683c\u5f0f\uff0c\u5982JSON\u3001CSV\u7b49\u3002</li> <li>\u8bc4\u4f30\u6267\u884c\u3002\u904d\u5386\u6570\u636e\u96c6\u4e2d\u7684\u6bcf\u4e2a\u6570\u636e\u9879\uff0c\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a<ul> <li>\u8f93\u5165\u6570\u636e\u63d0\u4f9b\u7ed9\u8bc4\u4f30\u76ee\u6807</li> <li>\u6267\u884c\u76ee\u6807\u7684<code>predict</code></li> <li>\u6536\u96c6\u6267\u884c\u7ed3\u679c</li> <li>\u8ba1\u7b97\u8bc4\u4f30\u6307\u6807</li> <li>\u8bb0\u5f55\u8bc4\u4f30\u8fc7\u7a0b</li> </ul> </li> <li>\u7ed3\u679c\u5206\u6790\u3002\u8bc4\u4f30\u5b8c\u6210\u540e\uff0c\u6846\u67b6\u4f1a\u63d0\u4f9b\u4ee5\u4e0b\u5185\u5bb9\uff1a<ul> <li>\u8be6\u7ec6\u7ed3\u679c\u3002\u6c47\u603b\u6240\u6709\u8bc4\u4f30\u9879\u7684\u7ed3\u679c</li> <li>\u6267\u884c\u6458\u8981\u3002\u8ba1\u7b97\u6574\u4f53\u8bc4\u4f30\u6307\u6807\uff0c\u8fd0\u884c\u65f6\u95f4\uff0c\u6210\u529f\u7387\u7b49</li> <li>\u8bc4\u4f30\u62a5\u544a\u3002\u751f\u6210\u8bc4\u4f30\u62a5\u544a\uff0c\u53ef\u80fd\u6d89\u53ca\u95ee\u9898\uff0c\u6027\u80fd\u5206\u6790\uff0c\u5206\u5e03\u53ef\u89c6\u5316\u7b49\u4fe1\u606f</li> <li>\u7ed3\u679c\u8bb0\u5f55\u3002\u4fdd\u5b58\u8bc4\u4f30\u7ed3\u679c\u5230\u8bbe\u7f6e\u7684\u76ee\u5f55</li> </ul> </li> <li>\u6267\u884c\u6458\u8981\uff1a\u603b\u6267\u884c\u65f6\u95f4\u3001\u6210\u529f\u7387\u3001\u5e73\u5747\u6307\u6807\u7b49</li> </ul> <pre><code>from aworld.evaluations.base import Evaluator, EvalTarget, EvalDataCase\nfrom aworld.core.task import Task\nfrom aworld.runner import Runners\n\nclass MyEvalTarget(EvalTarget):\n    async def predict(self, index: int, input: EvalDataCase[dict]) -&gt; dict:\n        # \u6267\u884c\u8bc4\u4f30\u903b\u8f91\n        task_input = input.case_data[\"input\"]\n        expected_output = input.case_data[\"expected\"]\n\n        # \u6267\u884c\u4efb\u52a1\n        result = await Runners.run_task(\n            task=Task(input=task_input, agent=my_agent)\n        )\n\n        # \u6bd4\u8f83\u7ed3\u679c\u5e76\u8fd4\u56de\u8bc4\u4f30\u6307\u6807\n        return {\n            \"success\": result.answer == expected_output,\n            \"accuracy\": calculate_accuracy(result.answer, expected_output),\n            \"time_cost\": result.time_cost\n        }\n\n# \u521b\u5efa\u8bc4\u4f30\u5668\nevaluator = Evaluator(\n    eval_target=MyEvalTarget(),\n    dataset=my_dataset\n)\n\n# \u6267\u884c\u8bc4\u4f30\nresults = await evaluator.evaluate()\n</code></pre>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AF%84%E4%BC%B0%EF%BC%88Evaluation%EF%BC%89/#_3","title":"\u6700\u4f73\u5b9e\u8df5","text":"<p>\u8bc4\u4f30\u7684\u6a21\u5757\u5316\u3001\u53ef\u6269\u5c55\u8bbe\u8ba1\u786e\u4fdd\u4e86AWorld\u7684\u8bc4\u4f30\u6846\u67b6\u53ef\u9002\u5e94\u5148\u8fdb\u7684\u7814\u7a76\u6216\u751f\u4ea7\u8981\u6c42\u3002\u5e38\u7528\u4e8e\u56db\u7c7b\u8bc4\u4f30\uff1a</p> <ol> <li>\u5355\u9879\u8bc4\u4f30\u3002\u5bf9\u5355\u4e2a\u6570\u636e\u9879\u8fdb\u884c\u8bc4\u4f30\uff0c\u9002\u7528\u4e8e\u7cbe\u786e\u7684\u6027\u80fd\u6d4b\u8bd5\u3002</li> <li>\u6279\u91cf\u8bc4\u4f30\u3002\u5bf9\u6574\u4e2a\u6570\u636e\u96c6\u8fdb\u884c\u6279\u91cf\u8bc4\u4f30\uff0c\u9002\u7528\u4e8e\u6574\u4f53\u6027\u80fd\u5206\u6790\u3002</li> <li>\u5bf9\u6bd4\u8bc4\u4f30\u3002\u5bf9\u591a\u4e2a\u6a21\u578b\u6216\u7b97\u6cd5\u8fdb\u884c\u5bf9\u6bd4\u8bc4\u4f30\uff0c\u9002\u7528\u4e8e\u6027\u80fd\u6bd4\u8f83\u3002</li> <li>\u6e10\u8fdb\u8bc4\u4f30\u3002\u9010\u6b65\u589e\u52a0\u8bc4\u4f30\u590d\u6742\u5ea6\uff0c\u9002\u7528\u4e8e\u80fd\u529b\u8fb9\u754c\u6d4b\u8bd5\u3002</li> </ol>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AF%84%E4%BC%B0%EF%BC%88Evaluation%EF%BC%89/#_4","title":"\u81ea\u5b9a\u4e49\u8bc4\u4f30\u6307\u6807","text":"<p>\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0<code>Scorer</code>\u63a5\u53e3\u6765\u5b9a\u4e49\u81ea\u5b9a\u4e49\u7684\u8bc4\u4f30\u6307\u6807\uff1a</p> <pre><code>from aworld.evaluations.base import Scorer, EvalDataCase\n\nclass CustomScore(Scorer):\n    async def score(self, index: int, input: EvalDataCase[EvalCaseDataType], output: dict) -&gt; ScorerResult:\n        # \u5b9e\u73b0\u81ea\u5b9a\u4e49\u8bc4\u4f30\u903b\u8f91\n        return custom_score\n</code></pre>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%AF%84%E4%BC%B0%EF%BC%88Evaluation%EF%BC%89/#_5","title":"\u81ea\u5b9a\u4e49\u8bc4\u4f30\u7b56\u7565","text":"<p>\u901a\u8fc7\u7ee7\u627f<code>EvalTarget</code>\u7c7b\uff0c\u53ef\u4ee5\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u8bc4\u4f30\u7b56\u7565\uff1a</p> <pre><code>from aworld.evaluations.base import EvalDataCase, EvalTarget\n\nclass CustomEvalTarget(EvalTarget):\n    async def predict(self, index: int, input: EvalDataCase[dict]) -&gt; dict:\n        # \u5b9e\u73b0\u81ea\u5b9a\u4e49\u8bc4\u4f30\u903b\u8f91\n        pass\n</code></pre>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%BD%A8%E8%BF%B9%20%28Trajectory%29/","title":"\u8f68\u8ff9 (Trajectory)","text":"<p>AWorld\u8fd0\u884c\u65f6\u6355\u83b7\u79bb\u7ebf\u548c\u5728\u7ebf\u8fd0\u884c\u7684\u6bcf\u4e00\u6b65\u3002\u6bcf\u4e2a\u4efb\u52a1\u90fd\u4f1a\u4ea7\u751f\u4e00\u4e2a\u5b8c\u6574\u7684\u8f68\u8ff9\u2014\u2014\u6bcf\u4e2aLLM\u8c03\u7528\u3001\u64cd\u4f5c\u548c\u5956\u52b1\u2014\u2014\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u5408\u6210\u8bad\u7ec3\u6837\u672c\u3001\u8bc4\u4f30\u6027\u80fd\uff0c\u5e76\u8fed\u4ee3\u4f18\u5316\u3002</p>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%BD%A8%E8%BF%B9%20%28Trajectory%29/#_1","title":"\u4efb\u52a1\u5b8c\u6574\u8f68\u8ff9","text":"<p>\u4efb\u52a1\u6709\u591a\u6b21LLM\u6216\u5de5\u5177\u8c03\u7528\uff0c\u6216\u591a\u4e2aAgent\u4e4b\u95f4\u7684\u4ea4\u4e92\u3002AWorld\u4f1a\u8bb0\u5f55\u6bcf\u4e00\u6b65\uff0c\u4e3a\u60a8\u63d0\u4f9b\u5b8c\u6574\u7684\u8f68\u8ff9\u3002</p> <pre><code>import asyncio\nfrom aworld.runner import Runners\nfrom aworld.core.task import Task\nfrom aworld.logs.util import logger\nimport json\n\n# \u5b9a\u4e49\u4ee3\u7406\nsearcher = Agent(...)\n\nif __name__ == \"__main__\":\n    async def test_complete_trajectory():\n        task = Task(\n            input=\"Use google search tool to answer the question: the news about AI today.\",\n            agent=searcher\n        )\n\n        responses = await Runners.run_task(task)\n        resp = responses[task.id]\n        logger.info(f\"task answer: {resp.answer}\")\n        logger.info(f\"task trajectory: {json.dumps(resp.trajectory, ensure_ascii=False)}\")\n    asyncio.run(test_complete_trajectory())\n</code></pre>"},{"location":"docs_zh/%E8%AE%AD%E7%BB%83/%E8%BD%A8%E8%BF%B9%20%28Trajectory%29/#_2","title":"\u5355\u6b65\u4ea4\u4e92","text":"<p>\u9700\u8981\u66f4\u7cbe\u7ec6\u7684\u63a7\u5236\u5417\uff1f\u8c03\u7528<code>step\uff08\uff09</code>\u4e00\u6b21\u68c0\u67e5\u4e00\u4e2a\u52a8\u4f5c/\u54cd\u5e94\u5bf9\u3002\u8fd9\u4f7f\u60a8\u53ef\u4ee5\u5728\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u6ce8\u5165\u4e2d\u95f4\u5956\u52b1\uff0c\u4ece\u800c\u83b7\u5f97\u66f4\u4e30\u5bcc\u3001\u66f4\u7075\u6d3b\u7684\u5b66\u4e60\u4fe1\u53f7\u3002</p> <pre><code>import os\nimport asyncio\nfrom aworld.runner import Runners\nfrom aworld.core.task import Task\nfrom aworld.logs.util import logger\nimport json\nfrom aworld.config import TaskConfig, TaskRunMode\n\n# refer the section above for agent constrution \nsearcher = Agent(...)\n\nif __name__ == \"__main__\":\n    async def test_single_step_introspection():\n        task = Task(\n            input=\"Use google search tool to answer the question: the news about AI today.\",\n            agent=searcher,\n            conf=TaskConfig(\n                resp_carry_context=True,\n                run_mode=TaskRunMode.INTERACTIVE\n            )\n        )\n\n        trajectory_log = os.path.join(os.path.dirname(__file__), \"trajectory_log.txt\")\n        is_finished = False\n        step = 1\n        while not is_finished:\n            with open(trajectory_log, \"a\", encoding=\"utf-8\") as traj_file:\n                is_finished, observation, response = await Runners.step(task)\n                traj_file.write(f\"Step {step}\\n\")\n                traj_file.write(json.dumps(response.trajectory, ensure_ascii=False, indent=2))\n                traj_file.write(\"\\n\\n\")\n                step += 1\n    asyncio.run(test_single_step_introspection())\n</code></pre>"}]}